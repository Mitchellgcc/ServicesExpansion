function Hn(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const jr={"metabolic-weight":{id:"metabolic-weight",title:"Metabolic & Weight Management",headline:"Finally Lose Weight & Keep It Off",subheadline:"Break free from yo-yo dieting with medical support that actually works.",description:"Ready for lasting results? Get proven weight loss support with expert medical guidance.",colorScheme:{primary:"from-orange-600 to-red-600",secondary:"from-orange-500/20 to-red-500/20",accent:"bg-orange-500",hero:"from-orange-900 via-red-900 to-slate-900"},specificBenefits:["Lose 10-30 pounds safely without crash dieting or hunger","Get your energy back and stop afternoon crashes","Keep the weight off for good with proven medical support"],uniqueProcess:["Complete health assessment to find what's been holding you back","Personalized plan with medication support if needed","Weekly check-ins until you reach and maintain your goal"],callToAction:"Ready to break the cycle? Start your weight loss journey the right way.",socialProof:"Over 300 successful weight loss transformations",urgency:"New patient spots filling fast",targetAudience:"Adults wanting sustainable weight loss with medical support",icon:"âš–ï¸",featured:!0},"womens-health":{id:"womens-health",title:"Women's Health Services",headline:"Feel Like Yourself Again",subheadline:"End sleepless nights and hot flashes with expert menopause care",description:"Menopause doesn't have to be this hard. Get personalized support that actually works.",colorScheme:{primary:"from-pink-600 to-purple-600",secondary:"from-pink-500/20 to-purple-500/20",accent:"bg-pink-500",hero:"from-pink-900 via-purple-900 to-slate-900"},specificBenefits:["Sleep through the night without hot flashes waking you up","Feel balanced and energetic instead of exhausted and moody",`Get real solutions that work - not just "it's normal" advice`],uniqueProcess:["Private 20-minute consultation to understand your symptoms","Personalized treatment plan (HRT, natural alternatives, or both)","Ongoing support with adjustments until you feel right again"],callToAction:"Ready to feel like yourself again? Book your confidential consultation.",socialProof:"Helping 200+ women reclaim their energy and confidence",urgency:"Limited consultation slots this week",targetAudience:"Women aged 45-65 experiencing menopause symptoms",icon:"ðŸŒº",featured:!0},"health-screening":{id:"health-screening",title:"Health Screening & Monitoring",headline:"Catch Problems Before They Start",subheadline:"Find out what's really going on inside your body",description:"Take control of your health. Get instant answers and peace of mind with comprehensive screening.",colorScheme:{primary:"from-blue-600 to-cyan-600",secondary:"from-blue-500/20 to-cyan-500/20",accent:"bg-blue-500",hero:"from-blue-900 via-cyan-900 to-slate-900"},specificBenefits:["Catch diabetes, heart disease, and stroke risk before symptoms appear","Get instant results with clear explanations - no medical jargon","Walk out with a personalized plan to improve your numbers"],uniqueProcess:["Choose your screening level based on your concerns","Quick 15-minute tests with results explained immediately","Personalized action plan to keep you healthy long-term"],callToAction:"Don't wait for warning signs. Know your health status today.",socialProof:"Trusted by 1,000+ health-conscious individuals",urgency:"Same-day screening available",targetAudience:"Health-conscious adults 40+ wanting proactive health monitoring",icon:"ðŸ©º",featured:!0},vaccinations:{id:"vaccinations",title:"Core Vaccinations",headline:"Keep Your Family Safe",subheadline:"Protect against serious illness with convenient vaccination services",description:"Keep your family healthy and protected with convenient same-day vaccinations.",colorScheme:{primary:"from-green-600 to-emerald-600",secondary:"from-green-500/20 to-emerald-500/20",accent:"bg-green-500",hero:"from-green-900 via-emerald-900 to-slate-900"},specificBenefits:["Avoid weeks of illness from flu, COVID, or pneumonia","Same-day service - no GP wait times or hassle","Family packages available with special pricing"],uniqueProcess:["Quick health check to recommend the right vaccines","Professional vaccination with comfortable, experienced staff","Digital certificate ready for travel or work requirements"],callToAction:"Protect your family now. Walk-ins welcome today.",socialProof:"Protecting 2,000+ families this year",urgency:"Flu season starting - book before it's too late",targetAudience:"Individuals and families wanting protection against preventable diseases",icon:"ðŸ’‰",featured:!0},"nhs-services":{id:"nhs-services",title:"NHS Clinical Services",headline:"Feel Better Today",subheadline:"Get NHS treatment now - no GP appointment needed",description:"Feeling unwell? Get free NHS treatment and medicine without the wait.",colorScheme:{primary:"from-indigo-600 to-blue-700",secondary:"from-indigo-500/20 to-blue-500/20",accent:"bg-indigo-500",hero:"from-indigo-900 via-blue-900 to-slate-900"},specificBenefits:["Get rid of UTIs, sore throats, and infections today","No waiting for GP appointments when you're feeling awful","Walk out with your medicine - completely free on NHS"],uniqueProcess:["Walk in when you're unwell - no appointment booking stress","Professional assessment by NHS pharmacist in minutes","Get treated immediately or referred quickly if needed"],callToAction:"Ready to feel better? Get the help you need now.",socialProof:"Helping 500+ patients get better faster each month",urgency:"Open now - no appointment needed",targetAudience:"Anyone needing quick NHS healthcare for minor illnesses",icon:"ðŸ¥",featured:!0},"mens-health":{id:"mens-health",title:"Men's Health & Performance",headline:"Get Your Edge Back",subheadline:"Reclaim your energy, strength, and confidence",description:"Ready to feel energized and strong again? Reclaim the vitality you had in your twenties.",colorScheme:{primary:"from-slate-600 to-gray-800",secondary:"from-slate-500/20 to-gray-500/20",accent:"bg-slate-600",hero:"from-slate-800 via-gray-900 to-black"},specificBenefits:["Wake up energized instead of exhausted every morning","Build muscle and strength like you did when you were younger","Regain confidence in the bedroom with proven treatments"],uniqueProcess:["Private consultation about your energy and performance goals","Comprehensive testing to find what's really causing the problem","Personalized treatment plan to get you back to your best"],callToAction:"Ready to feel like your best self again? Take control today.",socialProof:"Helping 150+ men reclaim their prime",urgency:"Confidential consultations available this week",targetAudience:"Men 35-65 wanting to optimize health, energy, and performance",icon:"ðŸ”‹",featured:!0},"travel-health":{id:"travel-health",title:"Travel Health Services",headline:"Travel Without Worry",subheadline:"Protect yourself from diseases that could ruin your trip",description:"Enjoy your dream holiday with confidence. Get the right protection for any destination.",colorScheme:{primary:"from-sky-600 to-blue-600",secondary:"from-sky-500/20 to-blue-500/20",accent:"bg-sky-500",hero:"from-sky-900 via-blue-900 to-slate-900"},specificBenefits:["Avoid malaria, typhoid, and serious travel diseases","Get expert advice for your exact destination and activities","Fast-track service for last-minute travel plans"],uniqueProcess:["Tell us where you're going and we'll recommend what you need","Professional vaccinations and travel health advice in one visit","All certificates and documentation sorted for your trip"],callToAction:"Ready for worry-free travel? Get protected today.",socialProof:"Protecting 800+ travelers every year",urgency:"Last-minute appointments available",targetAudience:"Travelers needing destination-specific health protection and advice",icon:"âœˆï¸",featured:!0},"gut-health":{id:"gut-health",title:"Gut Health & Digestive Wellness",headline:"Eat Without Fear Again",subheadline:"Stop bloating, pain, and bathroom emergencies for good",description:"Ready to enjoy food again without discomfort? Get your digestion working properly.",colorScheme:{primary:"from-green-500 to-lime-600",secondary:"from-green-400/20 to-lime-400/20",accent:"bg-green-500",hero:"from-green-900 via-lime-900 to-slate-900"},specificBenefits:["Stop embarrassing bloating and gas that ruins your day","Find out exactly which foods are causing your problems","Enjoy meals without worrying about pain or bathroom trips"],uniqueProcess:["Complete digestive assessment to find your specific triggers","Personalized healing plan with natural solutions that work","Ongoing support until you can eat normally again"],callToAction:"Ready to enjoy eating again? Let's fix your gut health today.",socialProof:"Helping 250+ people enjoy food again",urgency:"Limited gut health consultations this month",targetAudience:"Adults with IBS, bloating, food intolerances, or digestive discomfort",icon:"ðŸŒ±",featured:!0},"family-health":{id:"family-health",title:"Family Health Hub",headline:"Keep Your Family Healthy",subheadline:"One-stop healthcare for the whole family",description:"Convenient healthcare for every family member, from children to grandparents.",colorScheme:{primary:"from-amber-500 to-orange-600",secondary:"from-amber-400/20 to-orange-400/20",accent:"bg-amber-500",hero:"from-amber-900 via-orange-900 to-slate-900"},specificBenefits:["Healthcare for all ages in one convenient location","Family health plans with special pricing","Child-friendly environment with experienced staff"],uniqueProcess:["Family health assessment for all members","Coordinated care plans for ongoing health needs","Emergency support when your family needs it most"],callToAction:"Ready to simplify your family's healthcare? Start today.",socialProof:"Caring for 400+ families in our community",urgency:"Family consultation packages available now",targetAudience:"Families wanting coordinated healthcare for all members",icon:"ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦",featured:!0},"mental-health":{id:"mental-health",title:"Mental Health & Wellbeing",headline:"Feel Like Yourself Again",subheadline:"Professional support for anxiety, depression, and stress",description:"Struggling with your mental health? Get professional support in a safe, understanding environment.",colorScheme:{primary:"from-purple-600 to-indigo-700",secondary:"from-purple-500/20 to-indigo-500/20",accent:"bg-purple-600",hero:"from-purple-900 via-indigo-900 to-slate-900"},specificBenefits:["Professional counseling without long NHS waiting lists","Medication reviews and mental health assessments","Confidential support in a comfortable, private setting"],uniqueProcess:["Initial mental health assessment in a safe space","Personalized treatment plan including therapy options","Ongoing support with regular check-ins and adjustments"],callToAction:"Ready to prioritize your mental health? Take the first step today.",socialProof:"Supporting 200+ individuals on their mental health journey",urgency:"Confidential appointments available this week",targetAudience:"Adults seeking professional mental health support and counseling",icon:"ðŸ§ ",featured:!0}},zn=()=>Object.values(jr),Y=n=>jr[n]||null,Vn="modulepreload",Wn=function(n){return"/"+n},ur={},ke=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(t.map(a=>{if(a=Wn(a),a in ur)return;ur[a]=!0;const u=a.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${c}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":Vn,u||(d.as="script"),d.crossOrigin="",d.href=a,l&&d.setAttribute("nonce",l),document.head.appendChild(d),u)return new Promise((h,f)=>{d.addEventListener("load",h),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${a}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},Kn=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ke(async()=>{const{default:r}=await Promise.resolve().then(()=>xe);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Nt extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Jn extends Nt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Gn extends Nt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Qn extends Nt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Et;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Et||(Et={}));var Yn=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};class Xn{constructor(e,{headers:t={},customFetch:r,region:s=Et.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=Kn(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Yn(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=t;let l={},{region:a}=t;a||(a=this.region),a&&a!=="any"&&(l["x-region"]=a);let u;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const c=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:u}).catch(g=>{throw new Jn(g)}),d=c.headers.get("x-relay-error");if(d&&d==="true")throw new Gn(c);if(!c.ok)throw new Qn(c);let h=((r=c.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),f;return h==="application/json"?f=yield c.json():h==="application/octet-stream"?f=yield c.blob():h==="text/event-stream"?f=c:h==="multipart/form-data"?f=yield c.formData():f=yield c.text(),{data:f,error:null}}catch(s){return{data:null,error:s}}})}}var F=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zn(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var D={},Ft={},Qe={},Me={},Ye={},Xe={},es=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ve=es();const ts=ve.fetch,Mr=ve.fetch.bind(ve),Dr=ve.Headers,rs=ve.Request,ns=ve.Response,xe=Object.freeze(Object.defineProperty({__proto__:null,Headers:Dr,Request:rs,Response:ns,default:Mr,fetch:ts},Symbol.toStringTag,{value:"Module"})),ss=Zn(xe);var Ze={};Object.defineProperty(Ze,"__esModule",{value:!0});let is=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Ze.default=is;var Ur=F&&F.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Xe,"__esModule",{value:!0});const os=Ur(ss),as=Ur(Ze);let ls=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=os.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,a;let u=null,c=null,d=null,h=i.status,f=i.statusText;if(i.ok){if(this.method!=="HEAD"){const p=await i.text();p===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=p:c=JSON.parse(p))}const m=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),b=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");m&&b&&b.length>1&&(d=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,d=null,h=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const m=await i.text();try{u=JSON.parse(m),Array.isArray(u)&&i.status===404&&(c=[],u=null,h=200,f="OK")}catch{i.status===404&&m===""?(h=204,f="No Content"):u={message:m}}if(u&&this.isMaybeSingle&&(!((a=u==null?void 0:u.details)===null||a===void 0)&&a.includes("0 rows"))&&(u=null,h=200,f="OK"),u&&this.shouldThrowOnError)throw new as.default(u)}return{error:u,data:c,count:d,status:h,statusText:f}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,l,a;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(a=i==null?void 0:i.code)!==null&&a!==void 0?a:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}};Xe.default=ls;var cs=F&&F.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ye,"__esModule",{value:!0});const us=cs(Xe);let ds=class extends us.default{select(e){let t=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var l;const a=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${a};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Ye.default=ds;var hs=F&&F.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Me,"__esModule",{value:!0});const fs=hs(Ye);let gs=class extends fs.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};Me.default=gs;var ms=F&&F.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Qe,"__esModule",{value:!0});const Ce=ms(Me);let ps=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=t,this.schema=r,this.fetch=s}select(e,{head:t=!1,count:r}={}){const s=t?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new Ce.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((l,a)=>l.concat(Object.keys(a)),[]);if(o.length>0){const l=[...new Set(o)].map(a=>`"${a}"`);this.url.searchParams.set("columns",l.join(","))}}return new Ce.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const a=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(a.length>0){const u=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Ce.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new Ce.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Ce.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Qe.default=ps;var et={},tt={};Object.defineProperty(tt,"__esModule",{value:!0});tt.version=void 0;tt.version="0.0.0-automated";Object.defineProperty(et,"__esModule",{value:!0});et.DEFAULT_HEADERS=void 0;const vs=tt;et.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${vs.version}`};var Nr=F&&F.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ft,"__esModule",{value:!0});const ys=Nr(Qe),bs=Nr(Me),ws=et;let _s=class Fr{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},ws.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=s}from(e){const t=new URL(`${this.url}/${e}`);return new ys.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Fr(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:s=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let a;r||s?(o=r?"HEAD":"GET",Object.entries(t).filter(([c,d])=>d!==void 0).map(([c,d])=>[c,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([c,d])=>{l.searchParams.append(c,d)})):(o="POST",a=t);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new bs.default({method:o,url:l,headers:u,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}};Ft.default=_s;var Se=F&&F.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(D,"__esModule",{value:!0});D.PostgrestError=D.PostgrestBuilder=D.PostgrestTransformBuilder=D.PostgrestFilterBuilder=D.PostgrestQueryBuilder=D.PostgrestClient=void 0;const qr=Se(Ft);D.PostgrestClient=qr.default;const Hr=Se(Qe);D.PostgrestQueryBuilder=Hr.default;const zr=Se(Me);D.PostgrestFilterBuilder=zr.default;const Vr=Se(Ye);D.PostgrestTransformBuilder=Vr.default;const Wr=Se(Xe);D.PostgrestBuilder=Wr.default;const Kr=Se(Ze);D.PostgrestError=Kr.default;var ks=D.default={PostgrestClient:qr.default,PostgrestQueryBuilder:Hr.default,PostgrestFilterBuilder:zr.default,PostgrestTransformBuilder:Vr.default,PostgrestBuilder:Wr.default,PostgrestError:Kr.default};const{PostgrestClient:xs,PostgrestQueryBuilder:ja,PostgrestFilterBuilder:Ma,PostgrestTransformBuilder:Da,PostgrestBuilder:Ua,PostgrestError:Na}=ks;let Tt;typeof window>"u"?Tt=require("ws"):Tt=window.WebSocket;const Ss="2.11.9",Es={"X-Client-Info":`realtime-js/${Ss}`},Ts="1.0.0",Jr=1e4,Ps=1e3;var pe;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(pe||(pe={}));var B;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(B||(B={}));var q;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(q||(q={}));var Pt;(function(n){n.websocket="websocket"})(Pt||(Pt={}));var ae;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(ae||(ae={}));class Cs{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+s));o=o+s;const a=r.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:a,payload:u}}}class Gr{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var C;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(C||(C={}));const dr=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=As(o,n,e,s),i),{})},As=(n,e,t,r)=>{const s=e.find(l=>l.name===n),i=s==null?void 0:s.type,o=t[n];return i&&!r.includes(i)?Qr(i,o):Ct(o)},Qr=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Os(e,t)}switch(n){case C.bool:return Is(e);case C.float4:case C.float8:case C.int2:case C.int4:case C.int8:case C.numeric:case C.oid:return $s(e);case C.json:case C.jsonb:return Rs(e);case C.timestamp:return Ls(e);case C.abstime:case C.date:case C.daterange:case C.int4range:case C.int8range:case C.money:case C.reltime:case C.text:case C.time:case C.timestamptz:case C.timetz:case C.tsrange:case C.tstzrange:return Ct(e);default:return Ct(e)}},Ct=n=>n,Is=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},$s=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Rs=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Os=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Qr(e,l))}return n},Ls=n=>typeof n=="string"?n.replace(" ","T"):n,Yr=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class ft{constructor(e,t,r={},s=Jr){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var hr;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(hr||(hr={}));class Ie{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ie.syncState(this.state,s,i,o),this.pendingDiffs.forEach(a=>{this.state=Ie.syncDiff(this.state,a,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ie.syncDiff(this.state,s,i,o),l())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),o=this.transformState(t),l={},a={};return this.map(i,(u,c)=>{o[u]||(a[u]=c)}),this.map(o,(u,c)=>{const d=i[u];if(d){const h=c.map(b=>b.presence_ref),f=d.map(b=>b.presence_ref),g=c.filter(b=>f.indexOf(b.presence_ref)<0),m=d.filter(b=>h.indexOf(b.presence_ref)<0);g.length>0&&(l[u]=g),m.length>0&&(a[u]=m)}else l[u]=c}),this.syncDiff(i,{joins:l,leaves:a},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(l,a)=>{var u;const c=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(a),c.length>0){const d=e[l].map(f=>f.presence_ref),h=c.filter(f=>d.indexOf(f.presence_ref)<0);e[l].unshift(...h)}r(l,c,a)}),this.map(o,(l,a)=>{let u=e[l];if(!u)return;const c=a.map(d=>d.presence_ref);u=u.filter(d=>c.indexOf(d.presence_ref)<0),e[l]=u,s(l,u,a),u.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var fr;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(fr||(fr={}));var gr;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(gr||(gr={}));var J;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(J||(J={}));class qt{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=B.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ft(this,q.join,this.params,this.timeout),this.rejoinTimer=new Gr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=B.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=B.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=B.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=B.errored,this.rejoinTimer.scheduleTimeout())}),this._on(q.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Ie(this),this.broadcastEndpointURL=Yr(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o,private:l}}=this.params;this._onError(c=>e==null?void 0:e(J.CHANNEL_ERROR,c)),this._onClose(()=>e==null?void 0:e(J.CLOSED));const a={},u={broadcast:i,presence:o,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&s!==void 0?s:[],private:l};this.socket.accessTokenValue&&(a.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},a)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:c})=>{var d;if(this.socket.setAuth(),c===void 0){e==null||e(J.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,f=(d=h==null?void 0:h.length)!==null&&d!==void 0?d:0,g=[];for(let m=0;m<f;m++){const b=h[m],{filter:{event:p,schema:y,table:v,filter:w}}=b,k=c&&c[m];if(k&&k.event===p&&k.schema===y&&k.table===v&&k.filter===w)g.push(Object.assign(Object.assign({},b),{id:k.id}));else{this.unsubscribe(),this.state=B.errored,e==null||e(J.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(J.SUBSCRIBED);return}}).receive("error",c=>{this.state=B.errored,e==null||e(J.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(J.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,a;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((a=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||a===void 0)&&a.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=B.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(q.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(r=>{const s=new ft(this,q.leave,{},e);s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new ft(this,e,t,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const o=e.toLocaleLowerCase(),{close:l,error:a,leave:u,join:c}=q;if(r&&[l,a,u,c].indexOf(o)>=0&&r!==this._joinRef())return;let h=this._onMessage(o,t,r);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var g,m,b;return((g=f.filter)===null||g===void 0?void 0:g.event)==="*"||((b=(m=f.filter)===null||m===void 0?void 0:m.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===o}).map(f=>f.callback(h,r)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var g,m,b,p,y,v;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const w=f.id,k=(g=f.filter)===null||g===void 0?void 0:g.event;return w&&((m=t.ids)===null||m===void 0?void 0:m.includes(w))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((b=t.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const w=(y=(p=f==null?void 0:f.filter)===null||p===void 0?void 0:p.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return w==="*"||w===((v=t==null?void 0:t.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:m,table:b,commit_timestamp:p,type:y,errors:v}=g;h=Object.assign(Object.assign({},{schema:m,table:b,commit_timestamp:p,eventType:y,new:{},old:{},errors:v}),this._getPayloadRecords(g))}f.callback(h,r)})}_isClosed(){return this.state===B.closed}_isJoined(){return this.state===B.joined}_isJoining(){return this.state===B.joining}_isLeaving(){return this.state===B.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&qt.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(q.close,{},e)}_onError(e){this._on(q.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=B.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=dr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=dr(e.columns,e.old_record)),t}}const mr=()=>{},Bs=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class js{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=Es,this.params={},this.timeout=Jr,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=mr,this.ref=0,this.logger=mr,this.conn=null,this.sendBuffer=[],this.serializer=new Cs,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...l)=>ke(async()=>{const{default:a}=await Promise.resolve().then(()=>xe);return{default:a}},void 0).then(({default:a})=>a(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${Pt.websocket}`,this.httpEndpoint=Yr(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,o)=>o(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Gr(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Tt),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new Ms(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ts}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels=this.channels.filter(r=>r._joinRef!==e._joinRef),this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case pe.connecting:return ae.Connecting;case pe.open:return ae.Open;case pe.closing:return ae.Closing;default:return ae.Closed}}isConnected(){return this.connectionState()===ae.Open}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new qt(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:r,payload:s,ref:i}=e,o=()=>{this.encode(e,l=>{var a;(a=this.conn)===null||a===void 0||a.send(l)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{t&&r.updateJoinPayload({access_token:t,version:this.headers&&this.headers["X-Client-Info"]}),r.joinedOnce&&r._isJoined()&&r._push(q.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Ps,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:o}=t;r==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(l=>l._isMember(r)).forEach(l=>l._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(t))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(q.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([Bs],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class Ms{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=pe.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class Ht extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function R(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Ds extends Ht{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class At extends Ht{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Us=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};const Xr=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ke(async()=>{const{default:r}=await Promise.resolve().then(()=>xe);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Ns=()=>Us(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ke(()=>Promise.resolve().then(()=>xe),void 0)).Response:Response}),It=n=>{if(Array.isArray(n))return n.map(t=>It(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=It(r)}),e};var ue=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};const gt=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Fs=(n,e,t)=>ue(void 0,void 0,void 0,function*(){const r=yield Ns();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(s=>{e(new Ds(gt(s),n.status||500))}).catch(s=>{e(new At(gt(s),s))}):e(new At(gt(n),n))}),qs=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),t))};function De(n,e,t,r,s,i){return ue(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,qs(e,r,s,i)).then(a=>{if(!a.ok)throw a;return r!=null&&r.noResolveJson?a:a.json()}).then(a=>o(a)).catch(a=>Fs(a,l,r))})})}function We(n,e,t,r){return ue(this,void 0,void 0,function*(){return De(n,"GET",e,t,r)})}function ee(n,e,t,r,s){return ue(this,void 0,void 0,function*(){return De(n,"POST",e,r,s,t)})}function Hs(n,e,t,r,s){return ue(this,void 0,void 0,function*(){return De(n,"PUT",e,r,s,t)})}function zs(n,e,t,r){return ue(this,void 0,void 0,function*(){return De(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function Zr(n,e,t,r,s){return ue(this,void 0,void 0,function*(){return De(n,"DELETE",e,r,s,t)})}var j=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};const Vs={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},pr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ws{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Xr(s)}uploadOrUpdate(e,t,r,s){return j(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},pr),s);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const a=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),a&&i.append("metadata",this.encodeMetadata(a)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),a&&i.append("metadata",this.encodeMetadata(a))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,a&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const u=this._removeEmptyFolders(t),c=this._getFinalPath(u),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),h=yield d.json();return d.ok?{data:{path:u,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(i){if(R(i))return{data:null,error:i};throw i}})}upload(e,t,r){return j(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return j(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let a;const u=Object.assign({upsert:pr.upsert},s),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",u.cacheControl),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",u.cacheControl)):(a=r,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const d=yield this.fetch(l.toString(),{method:"PUT",body:a,headers:c}),h=yield d.json();return d.ok?{data:{path:i,fullPath:h.Key},error:null}:{data:null,error:h}}catch(a){if(R(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e,t){return j(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=yield ee(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new Ht("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(R(r))return{data:null,error:r};throw r}})}update(e,t,r){return j(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return j(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(R(s))return{data:null,error:s};throw s}})}copy(e,t,r){return j(this,void 0,void 0,function*(){try{return{data:{path:(yield ee(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(R(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return j(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield ee(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(R(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return j(this,void 0,void 0,function*(){try{const s=yield ee(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(R(s))return{data:null,error:s};throw s}})}download(e,t){return j(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield We(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(R(l))return{data:null,error:l};throw l}})}info(e){return j(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield We(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:It(r),error:null}}catch(r){if(R(r))return{data:null,error:r};throw r}})}exists(e){return j(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield zs(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(R(r)&&r instanceof At){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});a!==""&&s.push(a);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}remove(e){return j(this,void 0,void 0,function*(){try{return{data:yield Zr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(R(t))return{data:null,error:t};throw t}})}list(e,t,r){return j(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Vs),t),{prefix:e||""});return{data:yield ee(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(R(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Ks="2.7.1",Js={"X-Client-Info":`storage-js/${Ks}`};var he=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};class Gs{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},Js),t),this.fetch=Xr(r)}listBuckets(){return he(this,void 0,void 0,function*(){try{return{data:yield We(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(R(e))return{data:null,error:e};throw e}})}getBucket(e){return he(this,void 0,void 0,function*(){try{return{data:yield We(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(R(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return he(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(R(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return he(this,void 0,void 0,function*(){try{return{data:yield Hs(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(R(r))return{data:null,error:r};throw r}})}emptyBucket(e){return he(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(R(t))return{data:null,error:t};throw t}})}deleteBucket(e){return he(this,void 0,void 0,function*(){try{return{data:yield Zr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(R(t))return{data:null,error:t};throw t}})}}class Qs extends Gs{constructor(e,t={},r){super(e,t,r)}from(e){return new Ws(this.url,this.headers,e,this.fetch)}}const Ys="2.49.9";let Ae="";typeof Deno<"u"?Ae="deno":typeof document<"u"?Ae="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ae="react-native":Ae="node";const Xs={"X-Client-Info":`supabase-js-${Ae}/${Ys}`},Zs={headers:Xs},ei={schema:"public"},ti={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ri={};var ni=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};const si=n=>{let e;return n?e=n:typeof fetch>"u"?e=Mr:e=fetch,(...t)=>e(...t)},ii=()=>typeof Headers>"u"?Dr:Headers,oi=(n,e,t)=>{const r=si(t),s=ii();return(i,o)=>ni(void 0,void 0,void 0,function*(){var l;const a=(l=yield e())!==null&&l!==void 0?l:n;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",n),u.has("Authorization")||u.set("Authorization",`Bearer ${a}`),r(i,Object.assign(Object.assign({},o),{headers:u}))})};var ai=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};function li(n){return n.endsWith("/")?n:n+"/"}function ci(n,e){var t,r;const{db:s,auth:i,realtime:o,global:l}=n,{db:a,auth:u,realtime:c,global:d}=e,h={db:Object.assign(Object.assign({},a),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},c),o),global:Object.assign(Object.assign(Object.assign({},d),l),{headers:Object.assign(Object.assign({},(t=d==null?void 0:d.headers)!==null&&t!==void 0?t:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>ai(this,void 0,void 0,function*(){return""})};return n.accessToken?h.accessToken=n.accessToken:delete h.accessToken,h}const en="2.69.1",me=30*1e3,$t=3,mt=$t*me,ui="http://localhost:9999",di="supabase.auth.token",hi={"X-Client-Info":`gotrue-js/${en}`},Rt="X-Supabase-Api-Version",tn={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},fi=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,gi=6e5;class zt extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function S(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class mi extends zt{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function pi(n){return S(n)&&n.name==="AuthApiError"}class rn extends zt{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ne extends zt{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class X extends ne{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function vi(n){return S(n)&&n.name==="AuthSessionMissingError"}class pt extends ne{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ne extends ne{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Fe extends ne{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function yi(n){return S(n)&&n.name==="AuthImplicitGrantRedirectError"}class vr extends ne{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ot extends ne{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function vt(n){return S(n)&&n.name==="AuthRetryableFetchError"}class yr extends ne{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class $e extends ne{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const br="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),wr=` 	
\r=`.split(""),bi=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<wr.length;e+=1)n[wr[e].charCodeAt(0)]=-2;for(let e=0;e<br.length;e+=1)n[br[e].charCodeAt(0)]=e;return n})();function nn(n,e,t){const r=bi[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function _r(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{ki(o,r,t)};for(let o=0;o<n.length;o+=1)nn(n.charCodeAt(o),s,i);return e.join("")}function wi(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function _i(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}wi(r,e)}}function ki(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if(!(n>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function xi(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)nn(n.charCodeAt(s),t,r);return new Uint8Array(e)}function Si(n){const e=[];return _i(n,t=>e.push(t)),new Uint8Array(e)}function Ei(n){return Math.round(Date.now()/1e3)+n}function Ti(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const z=()=>typeof window<"u"&&typeof document<"u",ie={tested:!1,writable:!1},Re=()=>{if(!z())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ie.tested)return ie.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),ie.tested=!0,ie.writable=!0}catch{ie.tested=!0,ie.writable=!1}return ie.writable};function Pi(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const sn=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ke(async()=>{const{default:r}=await Promise.resolve().then(()=>xe);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Ci=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",on=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},qe=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},He=async(n,e)=>{await n.removeItem(e)};class rt{constructor(){this.promise=new rt.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}rt.promiseConstructor=Promise;function yt(n){const e=n.split(".");if(e.length!==3)throw new $e("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!fi.test(e[r]))throw new $e("JWT not in base64url format");return{header:JSON.parse(_r(e[0])),payload:JSON.parse(_r(e[1])),signature:xi(e[2]),raw:{header:e[0],payload:e[1]}}}async function Ai(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Ii(n,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await n(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function $i(n){return("0"+n.toString(16)).substr(-2)}function Ri(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,$i).join("")}async function Oi(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function Li(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Oi(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function fe(n,e,t=!1){const r=Ri();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await on(n,`${e}-code-verifier`,s);const i=await Li(r);return[i,r===i?"plain":"s256"]}const Bi=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ji(n){const e=n.headers.get(Rt);if(!e||!e.match(Bi))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Mi(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function Di(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var Ui=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const oe=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Ni=[502,503,504];async function kr(n){var e;if(!Ci(n))throw new Ot(oe(n),0);if(Ni.includes(n.status))throw new Ot(oe(n),n.status);let t;try{t=await n.json()}catch(i){throw new rn(oe(i),i)}let r;const s=ji(n);if(s&&s.getTime()>=tn["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new yr(oe(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new X}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new yr(oe(t),n.status,t.weak_password.reasons);throw new mi(oe(t),n.status||500,r)}const Fi=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function E(n,e,t,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[Rt]||(i[Rt]=tn["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",a=await qi(n,e,t+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(a):{data:Object.assign({},a),error:null}}async function qi(n,e,t,r,s,i){const o=Fi(e,r,s,i);let l;try{l=await n(t,Object.assign({},o))}catch(a){throw console.error(a),new Ot(oe(a),0)}if(l.ok||await kr(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(a){await kr(a)}}function Z(n){var e;let t=null;Wi(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=Ei(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function xr(n){const e=Z(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function te(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Hi(n){return{data:n,error:null}}function zi(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i}=n,o=Ui(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i},a=Object.assign({},o);return{data:{properties:l,user:a},error:null}}function Vi(n){return n}function Wi(n){return n.access_token&&n.refresh_token&&n.expires_in}var Ki=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class Ji{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=sn(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await E(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(S(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await E(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:te})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Ki(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await E(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:zi,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(S(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await E(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:te})}catch(t){if(S(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,o,l,a;try{const u={nextPage:null,lastPage:0,total:0},c=await E(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Vi});if(c.error)throw c.error;const d=await c.json(),h=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(a=(l=c.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return f.length>0&&(f.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(g.split(";")[1].split("=")[1]);u[`${b}Page`]=m}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(S(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await E(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:te})}catch(t){if(S(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await E(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:te})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await E(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:te})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await E(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(S(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await E(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(S(t))return{data:null,error:t};throw t}}}const Gi={getItem:n=>Re()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{Re()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{Re()&&globalThis.localStorage.removeItem(n)}};function Sr(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function Qi(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ge={debug:!!(globalThis&&Re()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class an extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Yi extends an{}async function Xi(n,e,t){ge.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),ge.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){ge.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{ge.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw ge.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Yi(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(ge.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Qi();const Zi={url:ui,storageKey:di,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:hi,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Er(n,e,t){return await t()}class Be{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Be.nextInstanceID,Be.nextInstanceID+=1,this.instanceID>0&&z()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Zi),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Ji({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=sn(s.fetch),this.lock=s.lock||Er,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:z()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Xi:this.lock=Er,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Re()?this.storage=Gi:(this.memoryStorage={},this.storage=Sr(this.memoryStorage)):(this.memoryStorage={},this.storage=Sr(this.memoryStorage)),z()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${en}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Pi(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),z()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),yi(i)){const a=(e=i.details)===null||e===void 0?void 0:e.code;if(a==="identity_already_exists"||a==="identity_not_found"||a==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return S(t)?{error:t}:{error:new rn("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const i=await E(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Z}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(i){if(S(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,s;try{let i;if("email"in e){const{email:c,password:d,options:h}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await fe(this.storage,this.storageKey)),i=await E(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:c,password:d,data:(t=h==null?void 0:h.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:g},xform:Z})}else if("phone"in e){const{phone:c,password:d,options:h}=e;i=await E(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Z})}else throw new Ne("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(i){if(S(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:l}=e;t=await E(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:xr})}else if("phone"in e){const{phone:i,password:o,options:l}=e;t=await E(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:xr})}else throw new Ne("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new pt}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await qe(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:i,error:o}=await E(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Z});if(await He(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new pt}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(S(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:i,nonce:o}=e,l=await E(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Z}),{data:a,error:u}=l;return u?{data:{user:null,session:null},error:u}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new pt}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:u})}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,i,o;try{if("email"in e){const{email:l,options:a}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await fe(this.storage,this.storageKey));const{error:d}=await E(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=a==null?void 0:a.data)!==null&&t!==void 0?t:{},create_user:(r=a==null?void 0:a.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:l,options:a}=e,{data:u,error:c}=await E(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=a==null?void 0:a.data)!==null&&s!==void 0?s:{},create_user:(i=a==null?void 0:a.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(o=a==null?void 0:a.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new Ne("You must provide either an email or phone number.")}catch(l){if(S(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,r;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await E(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Z});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const a=o.session,u=o.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(S(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await fe(this.storage,this.storageKey)),await E(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Hi})}catch(i){if(S(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new X;const{error:s}=await E(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(S(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:o}=await E(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:o,error:l}=await E(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Ne("You must provide either an email or phone number and a type")}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await qe(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<mt:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(a,u,c)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(a,u,c))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await E(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:te}):await this._useSession(async t=>{var r,s,i;const{data:o,error:l}=t;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new X}:await E(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:te})})}catch(t){if(S(t))return vi(t)&&(await this._removeSession(),await He(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new X;const o=s.session;let l=null,a=null;this.flowType==="pkce"&&e.email!=null&&([l,a]=await fe(this.storage,this.storageKey));const{data:u,error:c}=await E(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:a}),jwt:o.access_token,xform:te});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new X;const t=Date.now()/1e3;let r=t,s=!0,i=null;const{payload:o}=yt(e.access_token);if(o.exp&&(r=o.exp,s=r<=t),s){const{session:l,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return{data:{user:null,session:null},error:a};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:a}=await this._getUser(e.access_token);if(a)throw a;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(S(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new X;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!z())throw new Fe("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Fe(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new vr("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Fe("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new vr("No code detected.");const{data:y,error:v}=await this._exchangeCodeForSession(e.code);if(v)throw v;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:l,expires_at:a,token_type:u}=e;if(!i||!l||!o||!u)throw new Fe("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(l);let h=c+d;a&&(h=parseInt(a));const f=h-c;f*1e3<=me&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${d}s`);const g=h-d;c-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,c):c-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,c);const{data:m,error:b}=await this._getUser(i);if(b)throw b;const p={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:d,expires_at:h,refresh_token:o,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:p,redirectType:e.type},error:null}}catch(r){if(S(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await qe(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{error:i};const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(pi(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await He(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Ti(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:i},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await fe(this.storage,this.storageKey,!0));try{return await E(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(S(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(S(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:s}=await this._useSession(async i=>{var o,l,a,u,c;const{data:d,error:h}=i;if(h)throw h;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await E(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(s)throw s;return z()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(S(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)throw o;return await E(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(S(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Ii(async s=>(s>0&&await Ai(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await E(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Z})),(s,i)=>{const o=200*Math.pow(2,s);return i&&vt(i)&&Date.now()+o-r<me})}catch(r){if(this._debug(t,"error",r),S(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),z()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await qe(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const s=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<mt;if(this._debug(t,`session has${s?"":" not"} expired with margin of ${mt}s`),s){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),vt(i)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new X;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new rt;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new X;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),S(i)){const o={session:null,error:i};return vt(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(a){i.push(a)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await on(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await He(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&z()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),me);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/me);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${me}ms, refresh threshold is ${$t} ticks`),s<=$t&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof an)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!z()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await fe(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await E(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(S(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:a,error:u}=await E(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((s=a==null?void 0:a.totp)===null||s===void 0)&&s.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(t){if(S(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:l}=await E(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(t){if(S(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await E(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(S(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],s=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=yt(s.access_token);let l=null;o.aal&&(l=o.aal);let a=l;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(a="aal2");const c=o.amr||[];return{data:{currentLevel:l,nextLevel:a,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(o=>o.kid===e);if(r||(r=this.jwks.keys.find(o=>o.kid===e),r&&this.jwks_cached_at+gi>Date.now()))return r;const{data:s,error:i}=await E(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new $e("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),r=s.keys.find(o=>o.kid===e),!r)throw new $e("No matching signing key found in JWKS");return r}async getClaims(e,t={keys:[]}){try{let r=e;if(!r){const{data:f,error:g}=await this.getSession();if(g||!f.session)return{data:null,error:g};r=f.session.access_token}const{header:s,payload:i,signature:o,raw:{header:l,payload:a}}=yt(r);if(Mi(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:f}=await this.getUser(r);if(f)throw f;return{data:{claims:i,header:s,signature:o},error:null}}const u=Di(s.alg),c=await this.fetchJwk(s.kid,t),d=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,d,o,Si(`${l}.${a}`)))throw new $e("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(r){if(S(r))return{data:null,error:r};throw r}}}Be.nextInstanceID=0;const eo=Be;class to extends eo{constructor(e){super(e)}}var ro=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};class no{constructor(e,t,r){var s,i,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const l=li(e),a=new URL(l);this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const u=`sb-${a.hostname.split(".")[0]}-auth-token`,c={db:ei,realtime:ri,auth:Object.assign(Object.assign({},ti),{storageKey:u}),global:Zs},d=ci(r??{},c);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=oi(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new xs(new URL("rest/v1",a).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new Xn(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Qs(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return ro(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:i,flowType:o,lock:l,debug:a},u,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new to({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:o,lock:l,debug:a,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new js(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const so=(n,e,t)=>new no(n,e,t),io="https://sssanglcqfnciyipjngx.supabase.co",oo="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNzc2FuZ2xjcWZuY2l5aXBqbmd4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg1ODgyNjIsImV4cCI6MjA2NDE2NDI2Mn0.L97-7NcxKWpMoMxVKTeOSL7VRt-U7cq2uk3MgjF1sz0",le=so(io,oo),Tr={"metabolic-weight":"Metabolic & Weight Management","womens-health":"Women's Health Services","health-screening":"Health Screening & Monitoring",vaccinations:"Core Vaccinations","nhs-services":"NHS Clinical Services","mens-health":"Men's Health & Performance","travel-health":"Travel Health Services","gut-health":"Gut Health & Digestive Wellness"},Pr={"Morning (9am-12pm)":"morning","Afternoon (12pm-5pm)":"afternoon","Evening (5pm-7pm)":"evening"};class ao{constructor(){this.baseURL="https://cornwells-services.netlify.app",this.bitlyToken=null,this.branches={wx:"Weeping Cross",gw:"Great Wyrley",hc:"Holmcroft",wol:"Wolstanton",bc:"Beaconside",nc:"Newcastle",sv:"Silverdale",st4:"Stoke City Centre",ch:"Chadsmoor",ah:"Abbey Hulton"},this.services={"health-screening":"Health Screening & Monitoring","mens-health":"Men's Health Services","womens-health":"Women's Health Services","metabolic-weight":"Metabolic & Weight Management","travel-health":"Travel Health Services","nhs-services":"Enhanced NHS Services",vaccinations:"Core Vaccinations","gut-health":"Gut Health & Digestive Wellness","family-health":"Family Health Hub","mental-health":"Mental Health & Wellbeing"},this.materials={poster:"A4 Poster",flyer:"A5 Flyer",counter:"Counter Card",window:"Window Cling",bag:"Prescription Bag Belt",shelf:"Shelf Wobbler",partner:"Partner Material"}}generateTrackingURL(e,t,r,s="a",i=null){const o=new URLSearchParams({utm_source:r,utm_medium:t,utm_campaign:e,utm_term:s,utm_content:i||"qr"});return`${this.baseURL}/${e}?${o.toString()}`}async generateShortURL(e,t=null){if(!this.bitlyToken)return console.warn("Bitly token not configured, returning long URL"),e;try{return(await(await fetch("https://api-ssl.bitly.com/v4/shorten",{method:"POST",headers:{Authorization:`Bearer ${this.bitlyToken}`,"Content-Type":"application/json"},body:JSON.stringify({long_url:e,custom_bitlinks:t?[`bit.ly/cornwells-${t}`]:void 0})})).json()).link||e}catch(r){return console.error("Bitly shortening failed:",r),e}}async generateQRWithTracking(e,t,r,s="a"){const i=this.generateTrackingURL(e,t,r,s),o=await this.generateShortURL(i,`${e}-${t}-${s}`);return{qrCode:await(await ke(()=>Promise.resolve().then(()=>ta),void 0)).toDataURL(o,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"}),trackingURL:i,shortURL:o,metadata:{service:this.services[e],branch:this.branches[t],material:this.materials[r],version:s}}}async generateServiceQRBatch(e){const t=[];for(const[r,s]of Object.entries(this.branches))for(const[i,o]of Object.entries(this.materials))for(const l of["a","b","c"]){const a=await this.generateQRWithTracking(e,r,i,l);t.push({id:`${e}-${r}-${i}-${l}`,...a})}return t}captureUTMParameters(){const e=new URLSearchParams(window.location.search),t={};return["utm_source","utm_medium","utm_campaign","utm_term","utm_content"].forEach(r=>{e.has(r)&&(t[r]=e.get(r))}),Object.keys(t).length>0&&sessionStorage.setItem("cornwells_utm",JSON.stringify(t)),t}getStoredUTMData(){const e=sessionStorage.getItem("cornwells_utm");return e?JSON.parse(e):{}}trackEvent(e,t={}){typeof gtag<"u"&&gtag("event",e,{event_category:"mvp_services",...t,...this.getStoredUTMData()})}trackPageView(e=null){this.captureUTMParameters(),typeof gtag<"u"&&gtag("config","GA_MEASUREMENT_ID",{page_title:e?`${e} - Cornwells Services`:"Cornwells Services",page_location:window.location.href,custom_map:{custom_parameter_1:"utm_source",custom_parameter_2:"utm_medium",custom_parameter_3:"utm_campaign"}})}trackBookingConversion(e,t){this.trackEvent("consultation_booking",{event_category:"conversion",event_label:e,value:1,service_name:this.services[e],booking_method:"online_form"})}generateDashboardData(){return{totalServices:Object.keys(this.services).length,totalBranches:Object.keys(this.branches).length,totalMaterials:Object.keys(this.materials).length,totalQRCodes:Object.keys(this.services).length*Object.keys(this.branches).length*Object.keys(this.materials).length*3,trackingURLFormat:"utm_source={material}&utm_medium={branch}&utm_campaign={service}&utm_term={version}&utm_content=qr"}}}const $=new ao;typeof window<"u"&&$.captureUTMParameters();class lo{constructor(){this.initializePersonalization(),this.initializeVoiceInput()}getSmartTimeDefault(){const e=new Date,t=e.getHours(),r=e.getDay();return r===0||r===6?"next-week":t<9?"today-morning":t<17?"today":t<20?"tomorrow":"next-available"}getOptimalTimeSlots(){const e=new Date,t=[];return e.getHours()<17&&t.push({value:"today",label:"Today",sublabel:"Next available",priority:1,available:!0}),t.push({value:"tomorrow",label:"Tomorrow",sublabel:"Morning preferred",priority:2,available:!0}),t.push({value:"this-week",label:"This Week",sublabel:"When convenient",priority:3,available:!0}),t}initializeVoiceInput(){("webkitSpeechRecognition"in window||"SpeechRecognition"in window)&&(this.speechRecognition=new(window.SpeechRecognition||window.webkitSpeechRecognition),this.speechRecognition.continuous=!1,this.speechRecognition.interimResults=!1,this.speechRecognition.lang="en-GB")}startVoiceInput(e){if(!this.speechRecognition){e({error:"Voice input not supported"});return}this.speechRecognition.onresult=t=>{const r=t.results[0][0].transcript,s=this.extractPhoneFromSpeech(r);e({success:!0,phoneNumber:s})},this.speechRecognition.onerror=t=>{e({error:t.error})},this.speechRecognition.start()}extractPhoneFromSpeech(e){const t=e.replace(/\D/g,"");if(t.length>=10){const r=t.substring(0,11);return`07${r.substring(r.startsWith("07")?2:1,10)}`}return e}async getScarcityIndicators(e){try{const t=new Date().toISOString().split("T")[0],{data:r,error:s}=await le.from("service_consultations").select("id").eq("service_type",e).gte("created_at",`${t}T00:00:00`).lt("created_at",`${t}T23:59:59`);if(s)throw s;const i=(r==null?void 0:r.length)||0,l=Math.max(0,8-i);return{slotsRemaining:l,todayBookings:i,showScarcity:l<=3&&l>0,message:l<=3?`Only ${l} slots left today`:null}}catch(t){return console.error("Error getting scarcity data:",t),{slotsRemaining:5,showScarcity:!1}}}async getSocialProof(e){try{const t=new Date;t.setDate(t.getDate()-7);const{data:r,error:s}=await le.from("service_consultations").select("id").eq("service_type",e).gte("created_at",t.toISOString());if(s)throw s;const i=(r==null?void 0:r.length)||0;return{weeklyBookings:i,message:i>0?`${i} people booked this week`:"Be the first to book this week"}}catch(t){return console.error("Error getting social proof:",t),{weeklyBookings:12,message:"12 people booked this week"}}}getProgressAnchoring(e,t){const r=Math.round(e/t*100);return{percentage:r,message:{33:"You're 1/3 of the way there! ðŸš€",66:"Almost done! Just one more step ðŸ’ª",100:"Perfect! Ready to book ðŸŽ‰"}[r]||`${r}% complete`}}getLossAversionMessage(){const e=new Date().getHours();return e>=16&&e<17?"â° Last chance for today's availability!":e>=17?"ðŸ“… Tomorrow's slots filling up fast":null}initializePersonalization(){this.userProfile=this.loadUserProfile()}loadUserProfile(){const e=localStorage.getItem("cornwells_user_profile");return e?JSON.parse(e):{previousBookings:[],preferredTimes:[],lastVisit:null,phoneNumber:null}}saveUserProfile(e){this.userProfile={...this.userProfile,...e},localStorage.setItem("cornwells_user_profile",JSON.stringify(this.userProfile))}getPersonalizedDefaults(){return{phoneNumber:this.userProfile.phoneNumber||"",preferredTime:this.userProfile.preferredTimes[0]||this.getSmartTimeDefault(),isReturningUser:this.userProfile.previousBookings.length>0}}getPersonalizedRecommendations(e){const t=[];if(this.userProfile.previousBookings.length>0){const s=this.userProfile.previousBookings[0];s.serviceId!==e&&t.push({type:"previous_service",message:`Book ${s.serviceName} again?`,serviceId:s.serviceId})}const r=new Date().getMonth();return r>=8&&r<=10&&t.push({type:"seasonal",message:"Flu season is here - add flu vaccination?",serviceId:"flu-vaccination"}),t}async getRealTimeAvailability(e,t=null){const r=t||new Date().toISOString().split("T")[0];try{const{data:s,error:i}=await le.from("service_consultations").select("preferred_time_slot, created_at").eq("service_type",e).gte("created_at",`${r}T00:00:00`).lt("created_at",`${r}T23:59:59`);if(i)throw i;const o=[{time:"09:00",available:!0,price:50},{time:"10:00",available:!0,price:50},{time:"11:00",available:!1,price:50},{time:"14:00",available:!0,price:60},{time:"15:00",available:!0,price:60},{time:"16:00",available:!0,price:50}],l=(s==null?void 0:s.map(a=>a.preferred_time_slot))||[];return o.map(a=>({...a,available:a.available&&!l.includes(a.time)}))}catch(s){return console.error("Error getting availability:",s),[]}}getDynamicPricing(e,t,r="normal"){const s=parseInt(t.split(":")[0]);let i=1;return s>=12&&s<=14&&(i=1.2),r==="high"&&(i*=1.1),r==="low"&&(i*=.9),Math.round(e*i)}async sendSMSConfirmation(e,t){return console.log("SMS would be sent:",{to:e,message:`Thanks for booking ${t.serviceName}. We'll call you at ${t.time}. Ref: ${t.reference}`}),{success:!0,channel:"sms"}}async sendWhatsAppMessage(e,t){return console.log("WhatsApp would be sent:",{to:e,message:`ðŸ¥ Cornwells Pharmacy

Booking confirmed!
ðŸ“… ${t.serviceName}
â° ${t.time}
ðŸ“ž We'll call you soon

Ref: ${t.reference}`}),{success:!0,channel:"whatsapp"}}async sendEmailConfirmation(e,t){const r=this.generateCalendarInvite(t);return console.log("Email would be sent:",{to:e,subject:`Booking Confirmed - ${t.serviceName}`,html:this.generateEmailTemplate(t),attachments:[r]}),{success:!0,channel:"email"}}generateCalendarInvite(e){const t=new Date(e.date),r=new Date(t.getTime()+30*6e4);return{filename:"appointment.ics",content:`BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
DTSTART:${t.toISOString().replace(/[-:]/g,"").split(".")[0]}Z
DTEND:${r.toISOString().replace(/[-:]/g,"").split(".")[0]}Z
SUMMARY:${e.serviceName} - Cornwells Pharmacy
DESCRIPTION:Consultation for ${e.serviceName}
LOCATION:Cornwells Pharmacy
END:VEVENT
END:VCALENDAR`}}generateEmailTemplate(e){return`
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
        <h2>ðŸ¥ Booking Confirmed</h2>
        <p>Thank you for booking with Cornwells Pharmacy!</p>
        
        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
          <h3>${e.serviceName}</h3>
          <p><strong>Date:</strong> ${e.date}</p>
          <p><strong>Time:</strong> ${e.time}</p>
          <p><strong>Reference:</strong> ${e.reference}</p>
        </div>
        
        <p>We'll call you at the scheduled time. Please keep your phone nearby.</p>
        
        <p>Need to reschedule? Call us at 01234 567890</p>
        
        <p>Best regards,<br>Cornwells Pharmacy Team</p>
      </div>
    `}async requestNotificationPermission(){return"Notification"in window&&"serviceWorker"in navigator?await Notification.requestPermission()==="granted":!1}async sendPushNotification(e,t,r={}){if("serviceWorker"in navigator&&"Notification"in window){const s=await navigator.serviceWorker.ready;s.showNotification&&s.showNotification(e,{body:t,icon:"/icon-192x192.png",badge:"/badge-72x72.png",data:r,actions:[{action:"view",title:"View Details"},{action:"call",title:"Call Pharmacy"}]})}}trackConversionFunnel(e,t={}){const r={step:e,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,...t};window.gtag&&window.gtag("event","booking_funnel",r),console.log("Funnel tracking:",r)}getVariant(e){const t=this.getUserId();return this.simpleHash(t+e)%2===0?"A":"B"}getUserId(){let e=localStorage.getItem("cornwells_user_id");return e||(e="user_"+Math.random().toString(36).substr(2,9),localStorage.setItem("cornwells_user_id",e)),e}simpleHash(e){let t=0;for(let r=0;r<e.length;r++){const s=e.charCodeAt(r);t=(t<<5)-t+s,t=t&t}return Math.abs(t)}}const M=new lo;var ce={},co=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},ln={},U={};let Vt;const uo=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];U.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};U.getSymbolTotalCodewords=function(e){return uo[e]};U.getBCHDigit=function(n){let e=0;for(;n!==0;)e++,n>>>=1;return e};U.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');Vt=e};U.isKanjiModeEnabled=function(){return typeof Vt<"u"};U.toSJIS=function(e){return Vt(e)};var nt={};(function(n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2};function e(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+t)}}n.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},n.from=function(r,s){if(n.isValid(r))return r;try{return e(r)}catch{return s}}})(nt);function cn(){this.buffer=[],this.length=0}cn.prototype={get:function(n){const e=Math.floor(n/8);return(this.buffer[e]>>>7-n%8&1)===1},put:function(n,e){for(let t=0;t<e;t++)this.putBit((n>>>e-t-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),n&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var ho=cn;function Ue(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}Ue.prototype.set=function(n,e,t,r){const s=n*this.size+e;this.data[s]=t,r&&(this.reservedBit[s]=!0)};Ue.prototype.get=function(n,e){return this.data[n*this.size+e]};Ue.prototype.xor=function(n,e,t){this.data[n*this.size+e]^=t};Ue.prototype.isReserved=function(n,e){return this.reservedBit[n*this.size+e]};var fo=Ue,un={};(function(n){const e=U.getSymbolSize;n.getRowColCoords=function(r){if(r===1)return[];const s=Math.floor(r/7)+2,i=e(r),o=i===145?26:Math.ceil((i-13)/(2*s-2))*2,l=[i-7];for(let a=1;a<s-1;a++)l[a]=l[a-1]-o;return l.push(6),l.reverse()},n.getPositions=function(r){const s=[],i=n.getRowColCoords(r),o=i.length;for(let l=0;l<o;l++)for(let a=0;a<o;a++)l===0&&a===0||l===0&&a===o-1||l===o-1&&a===0||s.push([i[l],i[a]]);return s}})(un);var dn={};const go=U.getSymbolSize,Cr=7;dn.getPositions=function(e){const t=go(e);return[[0,0],[t-Cr,0],[0,t-Cr]]};var hn={};(function(n){n.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};n.isValid=function(s){return s!=null&&s!==""&&!isNaN(s)&&s>=0&&s<=7},n.from=function(s){return n.isValid(s)?parseInt(s,10):void 0},n.getPenaltyN1=function(s){const i=s.size;let o=0,l=0,a=0,u=null,c=null;for(let d=0;d<i;d++){l=a=0,u=c=null;for(let h=0;h<i;h++){let f=s.get(d,h);f===u?l++:(l>=5&&(o+=e.N1+(l-5)),u=f,l=1),f=s.get(h,d),f===c?a++:(a>=5&&(o+=e.N1+(a-5)),c=f,a=1)}l>=5&&(o+=e.N1+(l-5)),a>=5&&(o+=e.N1+(a-5))}return o},n.getPenaltyN2=function(s){const i=s.size;let o=0;for(let l=0;l<i-1;l++)for(let a=0;a<i-1;a++){const u=s.get(l,a)+s.get(l,a+1)+s.get(l+1,a)+s.get(l+1,a+1);(u===4||u===0)&&o++}return o*e.N2},n.getPenaltyN3=function(s){const i=s.size;let o=0,l=0,a=0;for(let u=0;u<i;u++){l=a=0;for(let c=0;c<i;c++)l=l<<1&2047|s.get(u,c),c>=10&&(l===1488||l===93)&&o++,a=a<<1&2047|s.get(c,u),c>=10&&(a===1488||a===93)&&o++}return o*e.N3},n.getPenaltyN4=function(s){let i=0;const o=s.data.length;for(let a=0;a<o;a++)i+=s.data[a];return Math.abs(Math.ceil(i*100/o/5)-10)*e.N4};function t(r,s,i){switch(r){case n.Patterns.PATTERN000:return(s+i)%2===0;case n.Patterns.PATTERN001:return s%2===0;case n.Patterns.PATTERN010:return i%3===0;case n.Patterns.PATTERN011:return(s+i)%3===0;case n.Patterns.PATTERN100:return(Math.floor(s/2)+Math.floor(i/3))%2===0;case n.Patterns.PATTERN101:return s*i%2+s*i%3===0;case n.Patterns.PATTERN110:return(s*i%2+s*i%3)%2===0;case n.Patterns.PATTERN111:return(s*i%3+(s+i)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}n.applyMask=function(s,i){const o=i.size;for(let l=0;l<o;l++)for(let a=0;a<o;a++)i.isReserved(a,l)||i.xor(a,l,t(s,a,l))},n.getBestMask=function(s,i){const o=Object.keys(n.Patterns).length;let l=0,a=1/0;for(let u=0;u<o;u++){i(u),n.applyMask(u,s);const c=n.getPenaltyN1(s)+n.getPenaltyN2(s)+n.getPenaltyN3(s)+n.getPenaltyN4(s);n.applyMask(u,s),c<a&&(a=c,l=u)}return l}})(hn);var st={};const re=nt,ze=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Ve=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];st.getBlocksCount=function(e,t){switch(t){case re.L:return ze[(e-1)*4+0];case re.M:return ze[(e-1)*4+1];case re.Q:return ze[(e-1)*4+2];case re.H:return ze[(e-1)*4+3];default:return}};st.getTotalCodewordsCount=function(e,t){switch(t){case re.L:return Ve[(e-1)*4+0];case re.M:return Ve[(e-1)*4+1];case re.Q:return Ve[(e-1)*4+2];case re.H:return Ve[(e-1)*4+3];default:return}};var fn={},it={};const Oe=new Uint8Array(512),Ke=new Uint8Array(256);(function(){let e=1;for(let t=0;t<255;t++)Oe[t]=e,Ke[e]=t,e<<=1,e&256&&(e^=285);for(let t=255;t<512;t++)Oe[t]=Oe[t-255]})();it.log=function(e){if(e<1)throw new Error("log("+e+")");return Ke[e]};it.exp=function(e){return Oe[e]};it.mul=function(e,t){return e===0||t===0?0:Oe[Ke[e]+Ke[t]]};(function(n){const e=it;n.mul=function(r,s){const i=new Uint8Array(r.length+s.length-1);for(let o=0;o<r.length;o++)for(let l=0;l<s.length;l++)i[o+l]^=e.mul(r[o],s[l]);return i},n.mod=function(r,s){let i=new Uint8Array(r);for(;i.length-s.length>=0;){const o=i[0];for(let a=0;a<s.length;a++)i[a]^=e.mul(s[a],o);let l=0;for(;l<i.length&&i[l]===0;)l++;i=i.slice(l)}return i},n.generateECPolynomial=function(r){let s=new Uint8Array([1]);for(let i=0;i<r;i++)s=n.mul(s,new Uint8Array([1,e.exp(i)]));return s}})(fn);const gn=fn;function Wt(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}Wt.prototype.initialize=function(e){this.degree=e,this.genPoly=gn.generateECPolynomial(this.degree)};Wt.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const r=gn.mod(t,this.genPoly),s=this.degree-r.length;if(s>0){const i=new Uint8Array(this.degree);return i.set(r,s),i}return r};var mo=Wt,mn={},se={},Kt={};Kt.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var K={};const pn="[0-9]+",po="[A-Z $%*+\\-./:]+";let je="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";je=je.replace(/u/g,"\\u");const vo="(?:(?![A-Z0-9 $%*+\\-./:]|"+je+`)(?:.|[\r
]))+`;K.KANJI=new RegExp(je,"g");K.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");K.BYTE=new RegExp(vo,"g");K.NUMERIC=new RegExp(pn,"g");K.ALPHANUMERIC=new RegExp(po,"g");const yo=new RegExp("^"+je+"$"),bo=new RegExp("^"+pn+"$"),wo=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");K.testKanji=function(e){return yo.test(e)};K.testNumeric=function(e){return bo.test(e)};K.testAlphanumeric=function(e){return wo.test(e)};(function(n){const e=Kt,t=K;n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},n.getBestModeForData=function(i){return t.testNumeric(i)?n.NUMERIC:t.testAlphanumeric(i)?n.ALPHANUMERIC:t.testKanji(i)?n.KANJI:n.BYTE},n.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},n.isValid=function(i){return i&&i.bit&&i.ccBits};function r(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+s)}}n.from=function(i,o){if(n.isValid(i))return i;try{return r(i)}catch{return o}}})(se);(function(n){const e=U,t=st,r=nt,s=se,i=Kt,o=7973,l=e.getBCHDigit(o);function a(h,f,g){for(let m=1;m<=40;m++)if(f<=n.getCapacity(m,g,h))return m}function u(h,f){return s.getCharCountIndicator(h,f)+4}function c(h,f){let g=0;return h.forEach(function(m){const b=u(m.mode,f);g+=b+m.getBitsLength()}),g}function d(h,f){for(let g=1;g<=40;g++)if(c(h,g)<=n.getCapacity(g,f,s.MIXED))return g}n.from=function(f,g){return i.isValid(f)?parseInt(f,10):g},n.getCapacity=function(f,g,m){if(!i.isValid(f))throw new Error("Invalid QR Code version");typeof m>"u"&&(m=s.BYTE);const b=e.getSymbolTotalCodewords(f),p=t.getTotalCodewordsCount(f,g),y=(b-p)*8;if(m===s.MIXED)return y;const v=y-u(m,f);switch(m){case s.NUMERIC:return Math.floor(v/10*3);case s.ALPHANUMERIC:return Math.floor(v/11*2);case s.KANJI:return Math.floor(v/13);case s.BYTE:default:return Math.floor(v/8)}},n.getBestVersionForData=function(f,g){let m;const b=r.from(g,r.M);if(Array.isArray(f)){if(f.length>1)return d(f,b);if(f.length===0)return 1;m=f[0]}else m=f;return a(m.mode,m.getLength(),b)},n.getEncodedBits=function(f){if(!i.isValid(f)||f<7)throw new Error("Invalid QR Code version");let g=f<<12;for(;e.getBCHDigit(g)-l>=0;)g^=o<<e.getBCHDigit(g)-l;return f<<12|g}})(mn);var vn={};const Lt=U,yn=1335,_o=21522,Ar=Lt.getBCHDigit(yn);vn.getEncodedBits=function(e,t){const r=e.bit<<3|t;let s=r<<10;for(;Lt.getBCHDigit(s)-Ar>=0;)s^=yn<<Lt.getBCHDigit(s)-Ar;return(r<<10|s)^_o};var bn={};const ko=se;function ye(n){this.mode=ko.NUMERIC,this.data=n.toString()}ye.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};ye.prototype.getLength=function(){return this.data.length};ye.prototype.getBitsLength=function(){return ye.getBitsLength(this.data.length)};ye.prototype.write=function(e){let t,r,s;for(t=0;t+3<=this.data.length;t+=3)r=this.data.substr(t,3),s=parseInt(r,10),e.put(s,10);const i=this.data.length-t;i>0&&(r=this.data.substr(t),s=parseInt(r,10),e.put(s,i*3+1))};var xo=ye;const So=se,bt=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function be(n){this.mode=So.ALPHANUMERIC,this.data=n}be.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};be.prototype.getLength=function(){return this.data.length};be.prototype.getBitsLength=function(){return be.getBitsLength(this.data.length)};be.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let r=bt.indexOf(this.data[t])*45;r+=bt.indexOf(this.data[t+1]),e.put(r,11)}this.data.length%2&&e.put(bt.indexOf(this.data[t]),6)};var Eo=be;const To=se;function we(n){this.mode=To.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}we.getBitsLength=function(e){return e*8};we.prototype.getLength=function(){return this.data.length};we.prototype.getBitsLength=function(){return we.getBitsLength(this.data.length)};we.prototype.write=function(n){for(let e=0,t=this.data.length;e<t;e++)n.put(this.data[e],8)};var Po=we;const Co=se,Ao=U;function _e(n){this.mode=Co.KANJI,this.data=n}_e.getBitsLength=function(e){return e*13};_e.prototype.getLength=function(){return this.data.length};_e.prototype.getBitsLength=function(){return _e.getBitsLength(this.data.length)};_e.prototype.write=function(n){let e;for(e=0;e<this.data.length;e++){let t=Ao.toSJIS(this.data[e]);if(t>=33088&&t<=40956)t-=33088;else if(t>=57408&&t<=60351)t-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);t=(t>>>8&255)*192+(t&255),n.put(t,13)}};var Io=_e,wn={exports:{}};(function(n){var e={single_source_shortest_paths:function(t,r,s){var i={},o={};o[r]=0;var l=e.PriorityQueue.make();l.push(r,0);for(var a,u,c,d,h,f,g,m,b;!l.empty();){a=l.pop(),u=a.value,d=a.cost,h=t[u]||{};for(c in h)h.hasOwnProperty(c)&&(f=h[c],g=d+f,m=o[c],b=typeof o[c]>"u",(b||m>g)&&(o[c]=g,l.push(c,g),i[c]=u))}if(typeof s<"u"&&typeof o[s]>"u"){var p=["Could not find a path from ",r," to ",s,"."].join("");throw new Error(p)}return i},extract_shortest_path_from_predecessor_list:function(t,r){for(var s=[],i=r;i;)s.push(i),t[i],i=t[i];return s.reverse(),s},find_path:function(t,r,s){var i=e.single_source_shortest_paths(t,r,s);return e.extract_shortest_path_from_predecessor_list(i,s)},PriorityQueue:{make:function(t){var r=e.PriorityQueue,s={},i;t=t||{};for(i in r)r.hasOwnProperty(i)&&(s[i]=r[i]);return s.queue=[],s.sorter=t.sorter||r.default_sorter,s},default_sorter:function(t,r){return t.cost-r.cost},push:function(t,r){var s={value:t,cost:r};this.queue.push(s),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};n.exports=e})(wn);var $o=wn.exports;(function(n){const e=se,t=xo,r=Eo,s=Po,i=Io,o=K,l=U,a=$o;function u(p){return unescape(encodeURIComponent(p)).length}function c(p,y,v){const w=[];let k;for(;(k=p.exec(v))!==null;)w.push({data:k[0],index:k.index,mode:y,length:k[0].length});return w}function d(p){const y=c(o.NUMERIC,e.NUMERIC,p),v=c(o.ALPHANUMERIC,e.ALPHANUMERIC,p);let w,k;return l.isKanjiModeEnabled()?(w=c(o.BYTE,e.BYTE,p),k=c(o.KANJI,e.KANJI,p)):(w=c(o.BYTE_KANJI,e.BYTE,p),k=[]),y.concat(v,w,k).sort(function(P,O){return P.index-O.index}).map(function(P){return{data:P.data,mode:P.mode,length:P.length}})}function h(p,y){switch(y){case e.NUMERIC:return t.getBitsLength(p);case e.ALPHANUMERIC:return r.getBitsLength(p);case e.KANJI:return i.getBitsLength(p);case e.BYTE:return s.getBitsLength(p)}}function f(p){return p.reduce(function(y,v){const w=y.length-1>=0?y[y.length-1]:null;return w&&w.mode===v.mode?(y[y.length-1].data+=v.data,y):(y.push(v),y)},[])}function g(p){const y=[];for(let v=0;v<p.length;v++){const w=p[v];switch(w.mode){case e.NUMERIC:y.push([w,{data:w.data,mode:e.ALPHANUMERIC,length:w.length},{data:w.data,mode:e.BYTE,length:w.length}]);break;case e.ALPHANUMERIC:y.push([w,{data:w.data,mode:e.BYTE,length:w.length}]);break;case e.KANJI:y.push([w,{data:w.data,mode:e.BYTE,length:u(w.data)}]);break;case e.BYTE:y.push([{data:w.data,mode:e.BYTE,length:u(w.data)}])}}return y}function m(p,y){const v={},w={start:{}};let k=["start"];for(let x=0;x<p.length;x++){const P=p[x],O=[];for(let L=0;L<P.length;L++){const T=P[L],N=""+x+L;O.push(N),v[N]={node:T,lastCount:0},w[N]={};for(let Q=0;Q<k.length;Q++){const I=k[Q];v[I]&&v[I].node.mode===T.mode?(w[I][N]=h(v[I].lastCount+T.length,T.mode)-h(v[I].lastCount,T.mode),v[I].lastCount+=T.length):(v[I]&&(v[I].lastCount=T.length),w[I][N]=h(T.length,T.mode)+4+e.getCharCountIndicator(T.mode,y))}}k=O}for(let x=0;x<k.length;x++)w[k[x]].end=0;return{map:w,table:v}}function b(p,y){let v;const w=e.getBestModeForData(p);if(v=e.from(y,w),v!==e.BYTE&&v.bit<w.bit)throw new Error('"'+p+'" cannot be encoded with mode '+e.toString(v)+`.
 Suggested mode is: `+e.toString(w));switch(v===e.KANJI&&!l.isKanjiModeEnabled()&&(v=e.BYTE),v){case e.NUMERIC:return new t(p);case e.ALPHANUMERIC:return new r(p);case e.KANJI:return new i(p);case e.BYTE:return new s(p)}}n.fromArray=function(y){return y.reduce(function(v,w){return typeof w=="string"?v.push(b(w,null)):w.data&&v.push(b(w.data,w.mode)),v},[])},n.fromString=function(y,v){const w=d(y,l.isKanjiModeEnabled()),k=g(w),x=m(k,v),P=a.find_path(x.map,"start","end"),O=[];for(let L=1;L<P.length-1;L++)O.push(x.table[P[L]].node);return n.fromArray(f(O))},n.rawSplit=function(y){return n.fromArray(d(y,l.isKanjiModeEnabled()))}})(bn);const ot=U,wt=nt,Ro=ho,Oo=fo,Lo=un,Bo=dn,Bt=hn,jt=st,jo=mo,Je=mn,Mo=vn,Do=se,_t=bn;function Uo(n,e){const t=n.size,r=Bo.getPositions(e);for(let s=0;s<r.length;s++){const i=r[s][0],o=r[s][1];for(let l=-1;l<=7;l++)if(!(i+l<=-1||t<=i+l))for(let a=-1;a<=7;a++)o+a<=-1||t<=o+a||(l>=0&&l<=6&&(a===0||a===6)||a>=0&&a<=6&&(l===0||l===6)||l>=2&&l<=4&&a>=2&&a<=4?n.set(i+l,o+a,!0,!0):n.set(i+l,o+a,!1,!0))}}function No(n){const e=n.size;for(let t=8;t<e-8;t++){const r=t%2===0;n.set(t,6,r,!0),n.set(6,t,r,!0)}}function Fo(n,e){const t=Lo.getPositions(e);for(let r=0;r<t.length;r++){const s=t[r][0],i=t[r][1];for(let o=-2;o<=2;o++)for(let l=-2;l<=2;l++)o===-2||o===2||l===-2||l===2||o===0&&l===0?n.set(s+o,i+l,!0,!0):n.set(s+o,i+l,!1,!0)}}function qo(n,e){const t=n.size,r=Je.getEncodedBits(e);let s,i,o;for(let l=0;l<18;l++)s=Math.floor(l/3),i=l%3+t-8-3,o=(r>>l&1)===1,n.set(s,i,o,!0),n.set(i,s,o,!0)}function kt(n,e,t){const r=n.size,s=Mo.getEncodedBits(e,t);let i,o;for(i=0;i<15;i++)o=(s>>i&1)===1,i<6?n.set(i,8,o,!0):i<8?n.set(i+1,8,o,!0):n.set(r-15+i,8,o,!0),i<8?n.set(8,r-i-1,o,!0):i<9?n.set(8,15-i-1+1,o,!0):n.set(8,15-i-1,o,!0);n.set(r-8,8,1,!0)}function Ho(n,e){const t=n.size;let r=-1,s=t-1,i=7,o=0;for(let l=t-1;l>0;l-=2)for(l===6&&l--;;){for(let a=0;a<2;a++)if(!n.isReserved(s,l-a)){let u=!1;o<e.length&&(u=(e[o]>>>i&1)===1),n.set(s,l-a,u),i--,i===-1&&(o++,i=7)}if(s+=r,s<0||t<=s){s-=r,r=-r;break}}}function zo(n,e,t){const r=new Ro;t.forEach(function(a){r.put(a.mode.bit,4),r.put(a.getLength(),Do.getCharCountIndicator(a.mode,n)),a.write(r)});const s=ot.getSymbolTotalCodewords(n),i=jt.getTotalCodewordsCount(n,e),o=(s-i)*8;for(r.getLengthInBits()+4<=o&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);const l=(o-r.getLengthInBits())/8;for(let a=0;a<l;a++)r.put(a%2?17:236,8);return Vo(r,n,e)}function Vo(n,e,t){const r=ot.getSymbolTotalCodewords(e),s=jt.getTotalCodewordsCount(e,t),i=r-s,o=jt.getBlocksCount(e,t),l=r%o,a=o-l,u=Math.floor(r/o),c=Math.floor(i/o),d=c+1,h=u-c,f=new jo(h);let g=0;const m=new Array(o),b=new Array(o);let p=0;const y=new Uint8Array(n.buffer);for(let P=0;P<o;P++){const O=P<a?c:d;m[P]=y.slice(g,g+O),b[P]=f.encode(m[P]),g+=O,p=Math.max(p,O)}const v=new Uint8Array(r);let w=0,k,x;for(k=0;k<p;k++)for(x=0;x<o;x++)k<m[x].length&&(v[w++]=m[x][k]);for(k=0;k<h;k++)for(x=0;x<o;x++)v[w++]=b[x][k];return v}function Wo(n,e,t,r){let s;if(Array.isArray(n))s=_t.fromArray(n);else if(typeof n=="string"){let u=e;if(!u){const c=_t.rawSplit(n);u=Je.getBestVersionForData(c,t)}s=_t.fromString(n,u||40)}else throw new Error("Invalid data");const i=Je.getBestVersionForData(s,t);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=i;else if(e<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=zo(e,t,s),l=ot.getSymbolSize(e),a=new Oo(l);return Uo(a,e),No(a),Fo(a,e),kt(a,t,0),e>=7&&qo(a,e),Ho(a,o),isNaN(r)&&(r=Bt.getBestMask(a,kt.bind(null,a,t))),Bt.applyMask(r,a),kt(a,t,r),{modules:a,version:e,errorCorrectionLevel:t,maskPattern:r,segments:s}}ln.create=function(e,t){if(typeof e>"u"||e==="")throw new Error("No input text");let r=wt.M,s,i;return typeof t<"u"&&(r=wt.from(t.errorCorrectionLevel,wt.M),s=Je.from(t.version),i=Bt.from(t.maskPattern),t.toSJISFunc&&ot.setToSJISFunction(t.toSJISFunc)),Wo(e,s,r,i)};var _n={},Jt={};(function(n){function e(t){if(typeof t=="number"&&(t=t.toString()),typeof t!="string")throw new Error("Color should be defined as hex string");let r=t.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+t);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(i){return[i,i]}))),r.length===6&&r.push("F","F");const s=parseInt(r.join(""),16);return{r:s>>24&255,g:s>>16&255,b:s>>8&255,a:s&255,hex:"#"+r.slice(0,6).join("")}}n.getOptions=function(r){r||(r={}),r.color||(r.color={});const s=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,i=r.width&&r.width>=21?r.width:void 0,o=r.scale||4;return{width:i,scale:i?4:o,margin:s,color:{dark:e(r.color.dark||"#000000ff"),light:e(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},n.getScale=function(r,s){return s.width&&s.width>=r+s.margin*2?s.width/(r+s.margin*2):s.scale},n.getImageWidth=function(r,s){const i=n.getScale(r,s);return Math.floor((r+s.margin*2)*i)},n.qrToImageData=function(r,s,i){const o=s.modules.size,l=s.modules.data,a=n.getScale(o,i),u=Math.floor((o+i.margin*2)*a),c=i.margin*a,d=[i.color.light,i.color.dark];for(let h=0;h<u;h++)for(let f=0;f<u;f++){let g=(h*u+f)*4,m=i.color.light;if(h>=c&&f>=c&&h<u-c&&f<u-c){const b=Math.floor((h-c)/a),p=Math.floor((f-c)/a);m=d[l[b*o+p]?1:0]}r[g++]=m.r,r[g++]=m.g,r[g++]=m.b,r[g]=m.a}}})(Jt);(function(n){const e=Jt;function t(s,i,o){s.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}n.render=function(i,o,l){let a=l,u=o;typeof a>"u"&&(!o||!o.getContext)&&(a=o,o=void 0),o||(u=r()),a=e.getOptions(a);const c=e.getImageWidth(i.modules.size,a),d=u.getContext("2d"),h=d.createImageData(c,c);return e.qrToImageData(h.data,i,a),t(d,u,c),d.putImageData(h,0,0),u},n.renderToDataURL=function(i,o,l){let a=l;typeof a>"u"&&(!o||!o.getContext)&&(a=o,o=void 0),a||(a={});const u=n.render(i,o,a),c=a.type||"image/png",d=a.rendererOpts||{};return u.toDataURL(c,d.quality)}})(_n);var kn={};const Ko=Jt;function Ir(n,e){const t=n.a/255,r=e+'="'+n.hex+'"';return t<1?r+" "+e+'-opacity="'+t.toFixed(2).slice(1)+'"':r}function xt(n,e,t){let r=n+e;return typeof t<"u"&&(r+=" "+t),r}function Jo(n,e,t){let r="",s=0,i=!1,o=0;for(let l=0;l<n.length;l++){const a=Math.floor(l%e),u=Math.floor(l/e);!a&&!i&&(i=!0),n[l]?(o++,l>0&&a>0&&n[l-1]||(r+=i?xt("M",a+t,.5+u+t):xt("m",s,0),s=0,i=!1),a+1<e&&n[l+1]||(r+=xt("h",o),o=0)):s++}return r}kn.render=function(e,t,r){const s=Ko.getOptions(t),i=e.modules.size,o=e.modules.data,l=i+s.margin*2,a=s.color.light.a?"<path "+Ir(s.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",u="<path "+Ir(s.color.dark,"stroke")+' d="'+Jo(o,i,s.margin)+'"/>',c='viewBox="0 0 '+l+" "+l+'"',h='<svg xmlns="http://www.w3.org/2000/svg" '+(s.width?'width="'+s.width+'" height="'+s.width+'" ':"")+c+' shape-rendering="crispEdges">'+a+u+`</svg>
`;return typeof r=="function"&&r(null,h),h};const Go=co,Mt=ln,xn=_n,Qo=kn;function Gt(n,e,t,r,s){const i=[].slice.call(arguments,1),o=i.length,l=typeof i[o-1]=="function";if(!l&&!Go())throw new Error("Callback required as last argument");if(l){if(o<2)throw new Error("Too few arguments provided");o===2?(s=t,t=e,e=r=void 0):o===3&&(e.getContext&&typeof s>"u"?(s=r,r=void 0):(s=r,r=t,t=e,e=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(t=e,e=r=void 0):o===2&&!e.getContext&&(r=t,t=e,e=void 0),new Promise(function(a,u){try{const c=Mt.create(t,r);a(n(c,e,r))}catch(c){u(c)}})}try{const a=Mt.create(t,r);s(null,n(a,e,r))}catch(a){s(a)}}var Yo=ce.create=Mt.create,Xo=ce.toCanvas=Gt.bind(null,xn.render),Zo=ce.toDataURL=Gt.bind(null,xn.renderToDataURL),ea=ce.toString=Gt.bind(null,function(n,e,t){return Qo.render(n,t)});const ta=Hn({__proto__:null,create:Yo,default:ce,toCanvas:Xo,toDataURL:Zo,toString:ea},[ce]);var Sn={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},Qt={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},ra=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],Ge={CSS:{},springs:{}};function V(n,e,t){return Math.min(Math.max(n,e),t)}function Le(n,e){return n.indexOf(e)>-1}function St(n,e){return n.apply(null,e)}var _={arr:function(n){return Array.isArray(n)},obj:function(n){return Le(Object.prototype.toString.call(n),"Object")},pth:function(n){return _.obj(n)&&n.hasOwnProperty("totalLength")},svg:function(n){return n instanceof SVGElement},inp:function(n){return n instanceof HTMLInputElement},dom:function(n){return n.nodeType||_.svg(n)},str:function(n){return typeof n=="string"},fnc:function(n){return typeof n=="function"},und:function(n){return typeof n>"u"},nil:function(n){return _.und(n)||n===null},hex:function(n){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(n)},rgb:function(n){return/^rgb/.test(n)},hsl:function(n){return/^hsl/.test(n)},col:function(n){return _.hex(n)||_.rgb(n)||_.hsl(n)},key:function(n){return!Sn.hasOwnProperty(n)&&!Qt.hasOwnProperty(n)&&n!=="targets"&&n!=="keyframes"}};function En(n){var e=/\(([^)]+)\)/.exec(n);return e?e[1].split(",").map(function(t){return parseFloat(t)}):[]}function Tn(n,e){var t=En(n),r=V(_.und(t[0])?1:t[0],.1,100),s=V(_.und(t[1])?100:t[1],.1,100),i=V(_.und(t[2])?10:t[2],.1,100),o=V(_.und(t[3])?0:t[3],.1,100),l=Math.sqrt(s/r),a=i/(2*Math.sqrt(s*r)),u=a<1?l*Math.sqrt(1-a*a):0,c=1,d=a<1?(a*l+-o)/u:-o+l;function h(g){var m=e?e*g/1e3:g;return a<1?m=Math.exp(-m*a*l)*(c*Math.cos(u*m)+d*Math.sin(u*m)):m=(c+d*m)*Math.exp(-m*l),g===0||g===1?g:1-m}function f(){var g=Ge.springs[n];if(g)return g;for(var m=1/6,b=0,p=0;;)if(b+=m,h(b)===1){if(p++,p>=16)break}else p=0;var y=b*m*1e3;return Ge.springs[n]=y,y}return e?h:f}function na(n){return n===void 0&&(n=10),function(e){return Math.ceil(V(e,1e-6,1)*n)*(1/n)}}var sa=function(){var n=11,e=1/(n-1);function t(c,d){return 1-3*d+3*c}function r(c,d){return 3*d-6*c}function s(c){return 3*c}function i(c,d,h){return((t(d,h)*c+r(d,h))*c+s(d))*c}function o(c,d,h){return 3*t(d,h)*c*c+2*r(d,h)*c+s(d)}function l(c,d,h,f,g){var m,b,p=0;do b=d+(h-d)/2,m=i(b,f,g)-c,m>0?h=b:d=b;while(Math.abs(m)>1e-7&&++p<10);return b}function a(c,d,h,f){for(var g=0;g<4;++g){var m=o(d,h,f);if(m===0)return d;var b=i(d,h,f)-c;d-=b/m}return d}function u(c,d,h,f){if(!(0<=c&&c<=1&&0<=h&&h<=1))return;var g=new Float32Array(n);if(c!==d||h!==f)for(var m=0;m<n;++m)g[m]=i(m*e,c,h);function b(p){for(var y=0,v=1,w=n-1;v!==w&&g[v]<=p;++v)y+=e;--v;var k=(p-g[v])/(g[v+1]-g[v]),x=y+k*e,P=o(x,c,h);return P>=.001?a(p,x,c,h):P===0?x:l(p,y,y+e,c,h)}return function(p){return c===d&&h===f||p===0||p===1?p:i(b(p),d,f)}}return u}(),Pn=function(){var n={linear:function(){return function(r){return r}}},e={Sine:function(){return function(r){return 1-Math.cos(r*Math.PI/2)}},Expo:function(){return function(r){return r?Math.pow(2,10*r-10):0}},Circ:function(){return function(r){return 1-Math.sqrt(1-r*r)}},Back:function(){return function(r){return r*r*(3*r-2)}},Bounce:function(){return function(r){for(var s,i=4;r<((s=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((s*3-2)/22-r,2)}},Elastic:function(r,s){r===void 0&&(r=1),s===void 0&&(s=.5);var i=V(r,1,10),o=V(s,.1,2);return function(l){return l===0||l===1?l:-i*Math.pow(2,10*(l-1))*Math.sin((l-1-o/(Math.PI*2)*Math.asin(1/i))*(Math.PI*2)/o)}}},t=["Quad","Cubic","Quart","Quint"];return t.forEach(function(r,s){e[r]=function(){return function(i){return Math.pow(i,s+2)}}}),Object.keys(e).forEach(function(r){var s=e[r];n["easeIn"+r]=s,n["easeOut"+r]=function(i,o){return function(l){return 1-s(i,o)(1-l)}},n["easeInOut"+r]=function(i,o){return function(l){return l<.5?s(i,o)(l*2)/2:1-s(i,o)(l*-2+2)/2}},n["easeOutIn"+r]=function(i,o){return function(l){return l<.5?(1-s(i,o)(1-l*2))/2:(s(i,o)(l*2-1)+1)/2}}}),n}();function Yt(n,e){if(_.fnc(n))return n;var t=n.split("(")[0],r=Pn[t],s=En(n);switch(t){case"spring":return Tn(n,e);case"cubicBezier":return St(sa,s);case"steps":return St(na,s);default:return St(r,s)}}function Cn(n){try{var e=document.querySelectorAll(n);return e}catch{return}}function at(n,e){for(var t=n.length,r=arguments.length>=2?arguments[1]:void 0,s=[],i=0;i<t;i++)if(i in n){var o=n[i];e.call(r,o,i,n)&&s.push(o)}return s}function lt(n){return n.reduce(function(e,t){return e.concat(_.arr(t)?lt(t):t)},[])}function $r(n){return _.arr(n)?n:(_.str(n)&&(n=Cn(n)||n),n instanceof NodeList||n instanceof HTMLCollection?[].slice.call(n):[n])}function Xt(n,e){return n.some(function(t){return t===e})}function Zt(n){var e={};for(var t in n)e[t]=n[t];return e}function Dt(n,e){var t=Zt(n);for(var r in n)t[r]=e.hasOwnProperty(r)?e[r]:n[r];return t}function ct(n,e){var t=Zt(n);for(var r in e)t[r]=_.und(n[r])?e[r]:n[r];return t}function ia(n){var e=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(n);return e?"rgba("+e[1]+",1)":n}function oa(n){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,t=n.replace(e,function(l,a,u,c){return a+a+u+u+c+c}),r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),s=parseInt(r[1],16),i=parseInt(r[2],16),o=parseInt(r[3],16);return"rgba("+s+","+i+","+o+",1)"}function aa(n){var e=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(n)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(n),t=parseInt(e[1],10)/360,r=parseInt(e[2],10)/100,s=parseInt(e[3],10)/100,i=e[4]||1;function o(h,f,g){return g<0&&(g+=1),g>1&&(g-=1),g<1/6?h+(f-h)*6*g:g<1/2?f:g<2/3?h+(f-h)*(2/3-g)*6:h}var l,a,u;if(r==0)l=a=u=s;else{var c=s<.5?s*(1+r):s+r-s*r,d=2*s-c;l=o(d,c,t+1/3),a=o(d,c,t),u=o(d,c,t-1/3)}return"rgba("+l*255+","+a*255+","+u*255+","+i+")"}function la(n){if(_.rgb(n))return ia(n);if(_.hex(n))return oa(n);if(_.hsl(n))return aa(n)}function G(n){var e=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(n);if(e)return e[1]}function ca(n){if(Le(n,"translate")||n==="perspective")return"px";if(Le(n,"rotate")||Le(n,"skew"))return"deg"}function Ut(n,e){return _.fnc(n)?n(e.target,e.id,e.total):n}function W(n,e){return n.getAttribute(e)}function er(n,e,t){var r=G(e);if(Xt([t,"deg","rad","turn"],r))return e;var s=Ge.CSS[e+t];if(!_.und(s))return s;var i=100,o=document.createElement(n.tagName),l=n.parentNode&&n.parentNode!==document?n.parentNode:document.body;l.appendChild(o),o.style.position="absolute",o.style.width=i+t;var a=i/o.offsetWidth;l.removeChild(o);var u=a*parseFloat(e);return Ge.CSS[e+t]=u,u}function An(n,e,t){if(e in n.style){var r=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),s=n.style[e]||getComputedStyle(n).getPropertyValue(r)||"0";return t?er(n,s,t):s}}function tr(n,e){if(_.dom(n)&&!_.inp(n)&&(!_.nil(W(n,e))||_.svg(n)&&n[e]))return"attribute";if(_.dom(n)&&Xt(ra,e))return"transform";if(_.dom(n)&&e!=="transform"&&An(n,e))return"css";if(n[e]!=null)return"object"}function In(n){if(_.dom(n)){for(var e=n.style.transform||"",t=/(\w+)\(([^)]*)\)/g,r=new Map,s;s=t.exec(e);)r.set(s[1],s[2]);return r}}function ua(n,e,t,r){var s=Le(e,"scale")?1:0+ca(e),i=In(n).get(e)||s;return t&&(t.transforms.list.set(e,i),t.transforms.last=e),r?er(n,i,r):i}function rr(n,e,t,r){switch(tr(n,e)){case"transform":return ua(n,e,r,t);case"css":return An(n,e,t);case"attribute":return W(n,e);default:return n[e]||0}}function nr(n,e){var t=/^(\*=|\+=|-=)/.exec(n);if(!t)return n;var r=G(n)||0,s=parseFloat(e),i=parseFloat(n.replace(t[0],""));switch(t[0][0]){case"+":return s+i+r;case"-":return s-i+r;case"*":return s*i+r}}function $n(n,e){if(_.col(n))return la(n);if(/\s/g.test(n))return n;var t=G(n),r=t?n.substr(0,n.length-t.length):n;return e?r+e:r}function sr(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function da(n){return Math.PI*2*W(n,"r")}function ha(n){return W(n,"width")*2+W(n,"height")*2}function fa(n){return sr({x:W(n,"x1"),y:W(n,"y1")},{x:W(n,"x2"),y:W(n,"y2")})}function Rn(n){for(var e=n.points,t=0,r,s=0;s<e.numberOfItems;s++){var i=e.getItem(s);s>0&&(t+=sr(r,i)),r=i}return t}function ga(n){var e=n.points;return Rn(n)+sr(e.getItem(e.numberOfItems-1),e.getItem(0))}function On(n){if(n.getTotalLength)return n.getTotalLength();switch(n.tagName.toLowerCase()){case"circle":return da(n);case"rect":return ha(n);case"line":return fa(n);case"polyline":return Rn(n);case"polygon":return ga(n)}}function ma(n){var e=On(n);return n.setAttribute("stroke-dasharray",e),e}function pa(n){for(var e=n.parentNode;_.svg(e)&&_.svg(e.parentNode);)e=e.parentNode;return e}function Ln(n,e){var t=e||{},r=t.el||pa(n),s=r.getBoundingClientRect(),i=W(r,"viewBox"),o=s.width,l=s.height,a=t.viewBox||(i?i.split(" "):[0,0,o,l]);return{el:r,viewBox:a,x:a[0]/1,y:a[1]/1,w:o,h:l,vW:a[2],vH:a[3]}}function va(n,e){var t=_.str(n)?Cn(n)[0]:n,r=e||100;return function(s){return{property:s,el:t,svg:Ln(t),totalLength:On(t)*(r/100)}}}function ya(n,e,t){function r(c){c===void 0&&(c=0);var d=e+c>=1?e+c:0;return n.el.getPointAtLength(d)}var s=Ln(n.el,n.svg),i=r(),o=r(-1),l=r(1),a=t?1:s.w/s.vW,u=t?1:s.h/s.vH;switch(n.property){case"x":return(i.x-s.x)*a;case"y":return(i.y-s.y)*u;case"angle":return Math.atan2(l.y-o.y,l.x-o.x)*180/Math.PI}}function Rr(n,e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,r=$n(_.pth(n)?n.totalLength:n,e)+"";return{original:r,numbers:r.match(t)?r.match(t).map(Number):[0],strings:_.str(n)||e?r.split(t):[]}}function ir(n){var e=n?lt(_.arr(n)?n.map($r):$r(n)):[];return at(e,function(t,r,s){return s.indexOf(t)===r})}function Bn(n){var e=ir(n);return e.map(function(t,r){return{target:t,id:r,total:e.length,transforms:{list:In(t)}}})}function ba(n,e){var t=Zt(e);if(/^spring/.test(t.easing)&&(t.duration=Tn(t.easing)),_.arr(n)){var r=n.length,s=r===2&&!_.obj(n[0]);s?n={value:n}:_.fnc(e.duration)||(t.duration=e.duration/r)}var i=_.arr(n)?n:[n];return i.map(function(o,l){var a=_.obj(o)&&!_.pth(o)?o:{value:o};return _.und(a.delay)&&(a.delay=l?0:e.delay),_.und(a.endDelay)&&(a.endDelay=l===i.length-1?e.endDelay:0),a}).map(function(o){return ct(o,t)})}function wa(n){for(var e=at(lt(n.map(function(i){return Object.keys(i)})),function(i){return _.key(i)}).reduce(function(i,o){return i.indexOf(o)<0&&i.push(o),i},[]),t={},r=function(i){var o=e[i];t[o]=n.map(function(l){var a={};for(var u in l)_.key(u)?u==o&&(a.value=l[u]):a[u]=l[u];return a})},s=0;s<e.length;s++)r(s);return t}function _a(n,e){var t=[],r=e.keyframes;r&&(e=ct(wa(r),e));for(var s in e)_.key(s)&&t.push({name:s,tweens:ba(e[s],n)});return t}function ka(n,e){var t={};for(var r in n){var s=Ut(n[r],e);_.arr(s)&&(s=s.map(function(i){return Ut(i,e)}),s.length===1&&(s=s[0])),t[r]=s}return t.duration=parseFloat(t.duration),t.delay=parseFloat(t.delay),t}function xa(n,e){var t;return n.tweens.map(function(r){var s=ka(r,e),i=s.value,o=_.arr(i)?i[1]:i,l=G(o),a=rr(e.target,n.name,l,e),u=t?t.to.original:a,c=_.arr(i)?i[0]:u,d=G(c)||G(a),h=l||d;return _.und(o)&&(o=u),s.from=Rr(c,h),s.to=Rr(nr(o,c),h),s.start=t?t.end:0,s.end=s.start+s.delay+s.duration+s.endDelay,s.easing=Yt(s.easing,s.duration),s.isPath=_.pth(i),s.isPathTargetInsideSVG=s.isPath&&_.svg(e.target),s.isColor=_.col(s.from.original),s.isColor&&(s.round=1),t=s,s})}var jn={css:function(n,e,t){return n.style[e]=t},attribute:function(n,e,t){return n.setAttribute(e,t)},object:function(n,e,t){return n[e]=t},transform:function(n,e,t,r,s){if(r.list.set(e,t),e===r.last||s){var i="";r.list.forEach(function(o,l){i+=l+"("+o+") "}),n.style.transform=i}}};function Mn(n,e){var t=Bn(n);t.forEach(function(r){for(var s in e){var i=Ut(e[s],r),o=r.target,l=G(i),a=rr(o,s,l,r),u=l||G(a),c=nr($n(i,u),a),d=tr(o,s);jn[d](o,s,c,r.transforms,!0)}})}function Sa(n,e){var t=tr(n.target,e.name);if(t){var r=xa(e,n),s=r[r.length-1];return{type:t,property:e.name,animatable:n,tweens:r,duration:s.end,delay:r[0].delay,endDelay:s.endDelay}}}function Ea(n,e){return at(lt(n.map(function(t){return e.map(function(r){return Sa(t,r)})})),function(t){return!_.und(t)})}function Dn(n,e){var t=n.length,r=function(i){return i.timelineOffset?i.timelineOffset:0},s={};return s.duration=t?Math.max.apply(Math,n.map(function(i){return r(i)+i.duration})):e.duration,s.delay=t?Math.min.apply(Math,n.map(function(i){return r(i)+i.delay})):e.delay,s.endDelay=t?s.duration-Math.max.apply(Math,n.map(function(i){return r(i)+i.duration-i.endDelay})):e.endDelay,s}var Or=0;function Ta(n){var e=Dt(Sn,n),t=Dt(Qt,n),r=_a(t,n),s=Bn(n.targets),i=Ea(s,r),o=Dn(i,t),l=Or;return Or++,ct(e,{id:l,children:[],animatables:s,animations:i,duration:o.duration,delay:o.delay,endDelay:o.endDelay})}var H=[],Un=function(){var n;function e(){!n&&(!Lr()||!A.suspendWhenDocumentHidden)&&H.length>0&&(n=requestAnimationFrame(t))}function t(s){for(var i=H.length,o=0;o<i;){var l=H[o];l.paused?(H.splice(o,1),i--):(l.tick(s),o++)}n=o>0?requestAnimationFrame(t):void 0}function r(){A.suspendWhenDocumentHidden&&(Lr()?n=cancelAnimationFrame(n):(H.forEach(function(s){return s._onDocumentVisibility()}),Un()))}return typeof document<"u"&&document.addEventListener("visibilitychange",r),e}();function Lr(){return!!document&&document.hidden}function A(n){n===void 0&&(n={});var e=0,t=0,r=0,s,i=0,o=null;function l(y){var v=window.Promise&&new Promise(function(w){return o=w});return y.finished=v,v}var a=Ta(n);l(a);function u(){var y=a.direction;y!=="alternate"&&(a.direction=y!=="normal"?"normal":"reverse"),a.reversed=!a.reversed,s.forEach(function(v){return v.reversed=a.reversed})}function c(y){return a.reversed?a.duration-y:y}function d(){e=0,t=c(a.currentTime)*(1/A.speed)}function h(y,v){v&&v.seek(y-v.timelineOffset)}function f(y){if(a.reversePlayback)for(var w=i;w--;)h(y,s[w]);else for(var v=0;v<i;v++)h(y,s[v])}function g(y){for(var v=0,w=a.animations,k=w.length;v<k;){var x=w[v],P=x.animatable,O=x.tweens,L=O.length-1,T=O[L];L&&(T=at(O,function(qn){return y<qn.end})[0]||T);for(var N=V(y-T.start-T.delay,0,T.duration)/T.duration,Q=isNaN(N)?1:T.easing(N),I=T.to.strings,ut=T.round,dt=[],Fn=T.to.numbers.length,de=void 0,Ee=0;Ee<Fn;Ee++){var Te=void 0,or=T.to.numbers[Ee],ar=T.from.numbers[Ee]||0;T.isPath?Te=ya(T.value,Q*or,T.isPathTargetInsideSVG):Te=ar+Q*(or-ar),ut&&(T.isColor&&Ee>2||(Te=Math.round(Te*ut)/ut)),dt.push(Te)}var lr=I.length;if(!lr)de=dt[0];else{de=I[0];for(var Pe=0;Pe<lr;Pe++){I[Pe];var cr=I[Pe+1],ht=dt[Pe];isNaN(ht)||(cr?de+=ht+cr:de+=ht+" ")}}jn[x.type](P.target,x.property,de,P.transforms),x.currentValue=de,v++}}function m(y){a[y]&&!a.passThrough&&a[y](a)}function b(){a.remaining&&a.remaining!==!0&&a.remaining--}function p(y){var v=a.duration,w=a.delay,k=v-a.endDelay,x=c(y);a.progress=V(x/v*100,0,100),a.reversePlayback=x<a.currentTime,s&&f(x),!a.began&&a.currentTime>0&&(a.began=!0,m("begin")),!a.loopBegan&&a.currentTime>0&&(a.loopBegan=!0,m("loopBegin")),x<=w&&a.currentTime!==0&&g(0),(x>=k&&a.currentTime!==v||!v)&&g(v),x>w&&x<k?(a.changeBegan||(a.changeBegan=!0,a.changeCompleted=!1,m("changeBegin")),m("change"),g(x)):a.changeBegan&&(a.changeCompleted=!0,a.changeBegan=!1,m("changeComplete")),a.currentTime=V(x,0,v),a.began&&m("update"),y>=v&&(t=0,b(),a.remaining?(e=r,m("loopComplete"),a.loopBegan=!1,a.direction==="alternate"&&u()):(a.paused=!0,a.completed||(a.completed=!0,m("loopComplete"),m("complete"),!a.passThrough&&"Promise"in window&&(o(),l(a)))))}return a.reset=function(){var y=a.direction;a.passThrough=!1,a.currentTime=0,a.progress=0,a.paused=!0,a.began=!1,a.loopBegan=!1,a.changeBegan=!1,a.completed=!1,a.changeCompleted=!1,a.reversePlayback=!1,a.reversed=y==="reverse",a.remaining=a.loop,s=a.children,i=s.length;for(var v=i;v--;)a.children[v].reset();(a.reversed&&a.loop!==!0||y==="alternate"&&a.loop===1)&&a.remaining++,g(a.reversed?a.duration:0)},a._onDocumentVisibility=d,a.set=function(y,v){return Mn(y,v),a},a.tick=function(y){r=y,e||(e=r),p((r+(t-e))*A.speed)},a.seek=function(y){p(c(y))},a.pause=function(){a.paused=!0,d()},a.play=function(){a.paused&&(a.completed&&a.reset(),a.paused=!1,H.push(a),d(),Un())},a.reverse=function(){u(),a.completed=!a.reversed,d()},a.restart=function(){a.reset(),a.play()},a.remove=function(y){var v=ir(y);Nn(v,a)},a.reset(),a.autoplay&&a.play(),a}function Br(n,e){for(var t=e.length;t--;)Xt(n,e[t].animatable.target)&&e.splice(t,1)}function Nn(n,e){var t=e.animations,r=e.children;Br(n,t);for(var s=r.length;s--;){var i=r[s],o=i.animations;Br(n,o),!o.length&&!i.children.length&&r.splice(s,1)}!t.length&&!r.length&&e.pause()}function Pa(n){for(var e=ir(n),t=H.length;t--;){var r=H[t];Nn(e,r)}}function Ca(n,e){e===void 0&&(e={});var t=e.direction||"normal",r=e.easing?Yt(e.easing):null,s=e.grid,i=e.axis,o=e.from||0,l=o==="first",a=o==="center",u=o==="last",c=_.arr(n),d=parseFloat(c?n[0]:n),h=c?parseFloat(n[1]):0,f=G(c?n[1]:n)||0,g=e.start||0+(c?d:0),m=[],b=0;return function(p,y,v){if(l&&(o=0),a&&(o=(v-1)/2),u&&(o=v-1),!m.length){for(var w=0;w<v;w++){if(!s)m.push(Math.abs(o-w));else{var k=a?(s[0]-1)/2:o%s[0],x=a?(s[1]-1)/2:Math.floor(o/s[0]),P=w%s[0],O=Math.floor(w/s[0]),L=k-P,T=x-O,N=Math.sqrt(L*L+T*T);i==="x"&&(N=-L),i==="y"&&(N=-T),m.push(N)}b=Math.max.apply(Math,m)}r&&(m=m.map(function(I){return r(I/b)*b})),t==="reverse"&&(m=m.map(function(I){return i?I<0?I*-1:-I:Math.abs(b-I)}))}var Q=c?(h-d)/b:d;return g+Q*(Math.round(m[y]*100)/100)+f}}function Aa(n){n===void 0&&(n={});var e=A(n);return e.duration=0,e.add=function(t,r){var s=H.indexOf(e),i=e.children;s>-1&&H.splice(s,1);function o(h){h.passThrough=!0}for(var l=0;l<i.length;l++)o(i[l]);var a=ct(t,Dt(Qt,n));a.targets=a.targets||n.targets;var u=e.duration;a.autoplay=!1,a.direction=e.direction,a.timelineOffset=_.und(r)?u:nr(r,u),o(e),e.seek(a.timelineOffset);var c=A(a);o(c),i.push(c);var d=Dn(i,n);return e.delay=d.delay,e.endDelay=d.endDelay,e.duration=d.duration,e.seek(0),e.reset(),e.autoplay&&e.play(),e},e}A.version="3.2.1";A.speed=1;A.suspendWhenDocumentHidden=!0;A.running=H;A.remove=Pa;A.get=rr;A.set=Mn;A.convertPx=er;A.path=va;A.setDashoffset=ma;A.stagger=Ca;A.timeline=Aa;A.easing=Yt;A.penner=Pn;A.random=function(n,e){return Math.floor(Math.random()*(e-n+1))+n};class Ia{constructor(){this.currentService=null,this.baseURL=window.location.hostname==="localhost"?"https://cornwells-services.netlify.app":window.location.origin,this.init()}init(){var r;this.setupEventListeners(),this.loadCurrentPage(),this.initializeAnimations(),$.captureUTMParameters();const e=this.extractServiceIdFromPath(window.location.pathname),t=e?(r=Y(e))==null?void 0:r.title:null;$.trackPageView(t),this.registerServiceWorker()}registerServiceWorker(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/src/sw.js").then(e=>{console.log("SW registered: ",e)}).catch(e=>{console.log("SW registration failed: ",e)})})}isQRCodeVisit(){const e=new URLSearchParams(window.location.search);return e.has("utm_content")&&e.get("utm_content")==="qr"}isMobileDevice(){return window.innerWidth<=768||/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}setupEventListeners(){document.addEventListener("click",e=>{e.target.matches("[data-book-consultation]")&&(e.preventDefault(),this.handleBookingClick(e.target)),e.target.matches("[data-call-pharmacy]")&&(e.preventDefault(),this.handleCallClick()),e.target.matches("[data-visit-cornwells]")&&(e.preventDefault(),this.handleCornwellsClick()),e.target.matches("[data-generate-qr]")&&(e.preventDefault(),this.generateQRCode(e.target))}),document.addEventListener("submit",e=>{e.target.id==="mobile-booking-form"&&(e.preventDefault(),this.handleMobileBookingSubmission())}),window.addEventListener("popstate",()=>{this.loadCurrentPage()})}loadCurrentPage(){const e=window.location.pathname,t=this.extractServiceIdFromPath(e);t&&Y(t)?this.isQRCodeVisit()&&this.isMobileDevice()?this.loadMobileQRLanding(t):this.loadServiceLanding(t):this.loadServiceSelector()}extractServiceIdFromPath(e){return e.replace(/^\/+|\/+$/g,"")||null}async loadMobileQRLanding(e){const t=Y(e);if(!t){this.loadServiceSelector();return}this.currentService=t;const r=new URLSearchParams(window.location.search),s=r.get("utm_medium")||"unknown",i=r.get("utm_source")||"qr";$.trackPageView(`${t.title} - QR Landing`);const o=await this.generateUltraFastBookingHTML(t,s,i);document.getElementById("app").innerHTML=o,this.initializeEnhancedUltraFastBooking(),document.title=`Book ${t.title} - Cornwells Pharmacy`,this.updateMetaDescription(`Quick booking for ${t.title}. Request a callback for consultation.`)}async generateUltraFastBookingHTML(e,t,r){const s=this.getBranchName(t),i=new Date().getHours()<17,o=await M.getScarcityIndicators(e.id),l=await M.getSocialProof(e.id),a=M.getPersonalizedDefaults(),u=M.getLossAversionMessage();return`
      <div class="min-h-screen bg-gradient-to-br ${e.colorScheme.primary}">
        <!-- Enhanced Header with Behavioral Psychology -->
        <div class="bg-white/95 backdrop-blur-sm px-4 py-3 safe-area-top">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-2">
              <div class="text-2xl">${e.icon}</div>
              <div>
                <h1 class="font-bold text-gray-900 text-lg leading-tight">${e.title}</h1>
                <p class="text-sm text-gray-600">${s}</p>
                ${a.isReturningUser?'<p class="text-xs text-blue-600">ðŸ‘‹ Welcome back!</p>':""}
            </div>
          </div>
            <div class="text-right">
              <div class="text-xs text-green-600 font-semibold">âœ… Available ${i?"Today":"Tomorrow"}</div>
              ${o.showScarcity?`<div class="text-xs text-orange-600 font-semibold">âš¡ ${o.message}</div>`:'<div class="text-xs text-gray-500">Quick response</div>'}
            </div>
          </div>

          <!-- Social Proof & Loss Aversion -->
          <div class="mt-2 flex items-center justify-between text-xs">
            <div class="text-gray-600">ðŸ‘¥ ${l.message}</div>
            ${u?`<div class="text-orange-600 font-semibold">${u}</div>`:""}
              </div>
              </div>

        <!-- Hero Message -->
        <div class="px-4 py-6 text-center text-white">
          <h2 class="text-2xl font-bold mb-2 leading-tight">${e.headline}</h2>
          <p class="text-white/90 mb-6 leading-relaxed">${e.subheadline}</p>
          
          <!-- Key Benefits (2 max) -->
          <div class="space-y-2 mb-6">
            ${e.specificBenefits.slice(0,2).map(c=>`
              <div class="flex items-center justify-center space-x-2 text-sm">
                <div class="w-1.5 h-1.5 bg-white rounded-full"></div>
                <span class="text-white/90">${c}</span>
          </div>
            `).join("")}
        </div>
      </div>

        <!-- Ultra-Fast Booking Form -->
        <div class="bg-white rounded-t-3xl px-4 py-6 min-h-screen">
          <div class="max-w-sm mx-auto">
            
            <!-- Progress Indicator -->
            <div class="flex items-center justify-center space-x-2 mb-6">
              <div class="w-8 h-1 bg-gradient-to-r ${e.colorScheme.primary} rounded-full"></div>
              <div class="w-8 h-1 bg-gray-200 rounded-full"></div>
              <div class="w-8 h-1 bg-gray-200 rounded-full"></div>
                </div>

            <form id="ultra-fast-booking" class="space-y-6">
              <!-- Step 1: Enhanced Phone Number with Voice Input -->
              <div class="booking-step active" data-step="1">
                <div class="text-center mb-4">
                  <h3 class="text-xl font-bold text-gray-900 mb-1">Your Phone Number</h3>
                  <p class="text-gray-600 text-sm mb-2">We'll call you back soon</p>
                  <div id="progress-message" class="text-xs text-blue-600 font-semibold"></div>
              </div>
                
                <div class="relative">
                  <input 
                    type="tel" 
                    id="ultra-phone" 
                    placeholder="07XXX XXX XXX" 
                    value="${a.phoneNumber}"
                    class="w-full px-4 py-4 text-lg font-semibold text-center border-2 border-gray-200 rounded-2xl focus:border-blue-500 focus:ring-0 transition-colors"
                    autocomplete="tel"
                    inputmode="numeric"
                  >
                  
                  <!-- Voice Input Button -->
                  <button 
                    type="button" 
                    id="voice-input-btn" 
                    class="absolute right-3 top-1/2 transform -translate-y-1/2 p-2 text-blue-600 hover:bg-blue-50 rounded-full transition-colors"
                    title="Tap to speak your number"
                  >
                    ðŸŽ¤
                  </button>
                  
                  <div id="phone-feedback" class="mt-2 text-center text-sm"></div>
        </div>

                <!-- One-Tap Quick Options for Returning Users -->
                ${a.isReturningUser&&a.phoneNumber?`
                  <div class="mt-4 text-center">
                    <button 
                      type="button" 
                      id="use-saved-number" 
                      class="text-sm text-blue-600 font-semibold underline"
                    >
                      ðŸ“ž Use ${a.phoneNumber}
          </button>
        </div>
                `:""}
              </div>

              <!-- Step 2: Smart Time Selection with Real-Time Availability -->
              <div class="booking-step" data-step="2">
                <div class="text-center mb-4">
                  <h3 class="text-xl font-bold text-gray-900 mb-1">When works best?</h3>
                  <p class="text-gray-600 text-sm mb-2">Choose your preferred time</p>
                  <div id="progress-message-2" class="text-xs text-blue-600 font-semibold">Almost done! Just one more step ðŸ’ª</div>
                </div>
                
                <div class="space-y-3" id="time-slots-container">
                  ${i?`
                    <button type="button" class="time-option active" data-time="today">
                      <div class="flex items-center justify-between p-4 border-2 border-blue-500 bg-blue-50 rounded-2xl">
              <div>
                          <div class="font-semibold text-gray-900">Today</div>
                          <div class="text-sm text-gray-600">Next available slot</div>
                          ${o.showScarcity?`<div class="text-xs text-orange-600 font-semibold">${o.message}</div>`:""}
              </div>
                        <div class="text-right">
                          <div class="text-2xl">âš¡</div>
                          <div class="text-xs text-green-600">Available</div>
            </div>
        </div>
                    </button>
                  `:""}
                  <button type="button" class="time-option ${i?"":"active"}" data-time="tomorrow">
                    <div class="flex items-center justify-between p-4 border-2 ${i?"border-gray-200":"border-blue-500 bg-blue-50"} rounded-2xl">
                      <div>
                        <div class="font-semibold text-gray-900">Tomorrow</div>
                        <div class="text-sm text-gray-600">Morning preferred</div>
                      </div>
                      <div class="text-right">
                        <div class="text-2xl">ðŸ“…</div>
                        <div class="text-xs text-blue-600">Recommended</div>
                      </div>
                    </div>
                  </button>
                  <button type="button" class="time-option" data-time="this-week">
                    <div class="flex items-center justify-between p-4 border-2 border-gray-200 rounded-2xl">
                      <div>
                        <div class="font-semibold text-gray-900">This Week</div>
                        <div class="text-sm text-gray-600">When convenient</div>
                      </div>
                      <div class="text-right">
                        <div class="text-2xl">ðŸ“‹</div>
                        <div class="text-xs text-gray-600">Flexible</div>
                      </div>
                    </div>
                  </button>
                </div>
                
                <!-- One-Tap Booking for Smart Default -->
                <div class="mt-6 text-center">
                  <button 
                    type="button" 
                    id="one-tap-book" 
                    class="w-full bg-gradient-to-r ${e.colorScheme.primary} text-white py-4 rounded-2xl font-bold text-lg shadow-xl transform transition-all active:scale-95"
                    style="display: none;"
                  >
                    âš¡ Book ${a.preferredTime==="today"?"Today":"Tomorrow"} (One-Tap)
                  </button>
                </div>
              </div>

              <!-- Step 3: Confirmation -->
              <div class="booking-step" data-step="3">
                <div class="text-center">
                  <div class="text-6xl mb-4">ðŸ“ž</div>
                  <h3 class="text-xl font-bold text-gray-900 mb-2">Ready to Book?</h3>
                  <p class="text-gray-600 text-sm mb-6">We'll call <span id="confirm-phone" class="font-semibold"></span> <span id="confirm-time"></span></p>
                </div>
              </div>

              <!-- Action Buttons -->
              <div class="space-y-3">
                <button 
                  type="button" 
                  id="next-step-btn" 
                  class="w-full bg-gradient-to-r ${e.colorScheme.primary} text-white py-4 rounded-2xl font-bold text-lg shadow-xl transform transition-all active:scale-95"
                  disabled
                >
                  Enter Phone Number
            </button>
            
                <button 
                  type="submit" 
                  id="book-now-btn" 
                  class="w-full bg-gradient-to-r ${e.colorScheme.primary} text-white py-4 rounded-2xl font-bold text-lg shadow-xl transform transition-all active:scale-95 hidden"
                >
                  ðŸ“ž Book Consultation
                </button>
                
                <button 
                  type="button" 
                  id="back-step-btn" 
                  class="w-full bg-gray-100 text-gray-700 py-3 rounded-2xl font-semibold hidden"
                >
                  â† Back
                </button>
            </div>
            </form>

            <!-- Trust Indicators -->
            <div class="grid grid-cols-3 gap-4 mt-8 pt-6 border-t border-gray-100">
              <div class="text-center">
                <div class="text-2xl mb-1">âš¡</div>
                <div class="text-xs font-semibold text-gray-900">Quick response</div>
          </div>
              <div class="text-center">
                <div class="text-2xl mb-1">ðŸ”’</div>
                <div class="text-xs font-semibold text-gray-900">Confidential</div>
        </div>
              <div class="text-center">
                <div class="text-2xl mb-1">ðŸ’¯</div>
                <div class="text-xs font-semibold text-gray-900">Free consultation</div>
              </div>
            </div>

            <!-- Emergency Contact -->
            <div class="text-center mt-6 pt-4 border-t border-gray-100">
              <p class="text-xs text-gray-500 mb-2">Need to speak to someone now?</p>
              <button data-call-pharmacy class="text-blue-600 font-semibold text-sm underline">
                ðŸ“ž Call Pharmacy Directly
          </button>
            </div>

            <div class="safe-area-bottom"></div>
          </div>
        </div>
      </div>
    `}initializeEnhancedUltraFastBooking(){var m;let e=1,t="",r="";const s=document.getElementById("ultra-phone"),i=document.getElementById("phone-feedback"),o=document.getElementById("next-step-btn"),l=document.getElementById("book-now-btn"),a=document.getElementById("back-step-btn"),u=document.getElementById("confirm-phone"),c=document.getElementById("confirm-time"),d=document.getElementById("voice-input-btn"),h=document.getElementById("one-tap-book"),f=document.getElementById("progress-message"),g=M.getPersonalizedDefaults();g.phoneNumber&&s&&(s.value=g.phoneNumber,r=g.phoneNumber,this.validatePhoneAndUpdateUI(r,i,o)),s==null||s.addEventListener("input",b=>{let p=b.target.value.replace(/\D/g,"");p.startsWith("44")&&(p=p.substring(2)),p.startsWith("0")&&(p=p.substring(1)),p.length>0&&(p.length<=5?p=`07${p}`:p.length<=8?p=`07${p.substring(1,5)} ${p.substring(5)}`:p=`07${p.substring(1,5)} ${p.substring(5,8)} ${p.substring(8,11)}`),b.target.value=p,r=p,this.validatePhoneAndUpdateUI(p,i,o,f),M.trackConversionFunnel("phone_entry",{phoneLength:p.length,isValid:this.isValidUKMobile(p)})}),d==null||d.addEventListener("click",()=>{d.innerHTML="ðŸŽ™ï¸",d.classList.add("animate-pulse"),M.startVoiceInput(b=>{d.innerHTML="ðŸŽ¤",d.classList.remove("animate-pulse"),b.success&&b.phoneNumber?(s.value=b.phoneNumber,r=b.phoneNumber,this.validatePhoneAndUpdateUI(r,i,o,f),this.isValidUKMobile(r)&&setTimeout(()=>this.advanceToStep(2),500)):i.innerHTML='<span class="text-red-600">âŒ Voice input failed. Please type your number.</span>'})}),h==null||h.addEventListener("click",()=>{if(r&&this.isValidUKMobile(r)){const b=M.getSmartTimeDefault();this.handleUltraFastBooking(r,b)}}),document.querySelectorAll(".time-option").forEach(b=>{b.addEventListener("click",p=>{p.preventDefault(),document.querySelectorAll(".time-option").forEach(y=>{y.classList.remove("active"),y.querySelector("div").classList.remove("border-blue-500","bg-blue-50"),y.querySelector("div").classList.add("border-gray-200")}),b.classList.add("active"),b.querySelector("div").classList.add("border-blue-500","bg-blue-50"),b.querySelector("div").classList.remove("border-gray-200"),t=b.dataset.time,setTimeout(()=>{this.advanceToStep(3)},300)})}),o==null||o.addEventListener("click",()=>{e===1&&this.isValidUKMobile(r)&&this.advanceToStep(2)}),a==null||a.addEventListener("click",()=>{e>1&&this.advanceToStep(e-1)}),(m=document.getElementById("ultra-fast-booking"))==null||m.addEventListener("submit",b=>{b.preventDefault(),this.handleUltraFastBooking(r,t)}),this.advanceToStep=b=>{e=b,document.querySelectorAll(".booking-step").forEach((p,y)=>{p.classList.toggle("active",y+1===b),p.style.display=y+1===b?"block":"none"}),document.querySelectorAll(".w-8.h-1").forEach((p,y)=>{y<b?p.className=`w-8 h-1 bg-gradient-to-r ${this.currentService.colorScheme.primary} rounded-full`:p.className="w-8 h-1 bg-gray-200 rounded-full"}),b===1?(o.style.display="block",l.style.display="none",a.style.display="none"):b===2?(o.style.display="none",l.style.display="none",a.style.display="block"):b===3&&(o.style.display="none",l.style.display="block",a.style.display="block",u.textContent=r,c.textContent=this.getTimeText(t))}}isValidUKMobile(e){const t=e.replace(/\s/g,"");return/^07\d{9}$/.test(t)}validatePhoneAndUpdateUI(e,t,r,s){if(this.isValidUKMobile(e)){t.innerHTML='<span class="text-green-600">âœ… Perfect!</span>',r.disabled=!1,r.textContent="Choose Time â†’",r.classList.remove("opacity-50");const i=M.getProgressAnchoring(1,3);s&&(s.textContent=i.message);const o=document.getElementById("one-tap-book");o&&(o.style.display="block",setTimeout(()=>o.style.display="none",3e3))}else e.length>5?(t.innerHTML='<span class="text-orange-600">âš ï¸ Please check your number</span>',r.disabled=!0,r.textContent="Enter Phone Number",r.classList.add("opacity-50"),s&&(s.textContent="")):(t.innerHTML="",r.disabled=!0,r.textContent="Enter Phone Number",r.classList.add("opacity-50"),s&&(s.textContent=""))}getTimeText(e){switch(e){case"today":return"today";case"tomorrow":return"tomorrow";case"this-week":return"this week";default:return""}}getBranchName(e){return{wx:"Weeping Cross",gw:"Great Wyrley",hc:"Holmcroft",wol:"Wolstanton",bc:"Beaconside",nc:"Newcastle",sv:"Silverdale",st4:"Stoke City Centre",ch:"Chadsmoor",ah:"Abbey Hulton"}[e]||"Cornwells Pharmacy"}async handleUltraFastBooking(e,t){const r=document.getElementById("book-now-btn"),s=r.textContent;try{r.textContent="â³ Booking...",r.disabled=!0;const i=new URLSearchParams(window.location.search),o=$.getStoredUTMData(),l={patient_name:null,phone_number:e.replace(/\s/g,""),email:null,preferred_time_slot:t,notes:`Ultra-fast booking via ${i.get("utm_source")||"QR code"}`,service_type:this.currentService.id,service_name:this.currentService.title,source_url:window.location.href,consent_given:!0,preferred_contact_method:"phone",booking_type:"ultra_fast",utm_params:o,branch_code:i.get("utm_medium"),material_type:i.get("utm_source")};console.log("Ultra-fast booking:",l);const{data:a,error:u}=await le.from("service_consultations").insert([l]).select();if(u)throw u;$.trackBookingConversion(this.currentService.id,l),M.trackConversionFunnel("booking_complete",{serviceId:this.currentService.id,timePreference:t,bookingType:"ultra_fast"}),M.saveUserProfile({phoneNumber:e,preferredTimes:[t],lastVisit:new Date().toISOString(),previousBookings:[{serviceId:this.currentService.id,serviceName:this.currentService.title,date:new Date().toISOString()}]});const c={serviceName:this.currentService.title,time:this.getTimeText(t),date:new Date().toLocaleDateString(),reference:`CW${Date.now().toString().slice(-6)}`};await Promise.all([M.sendSMSConfirmation(e,c),M.sendWhatsAppMessage(e,c)]),M.requestNotificationPermission(),this.showUltraFastSuccess(e,t,c)}catch(i){console.error("Ultra-fast booking error:",i),this.showUltraFastError(),r.textContent=s,r.disabled=!1}}showUltraFastSuccess(e,t,r){const s=document.querySelector(".max-w-sm");s&&(s.innerHTML=`
        <div class="text-center py-8">
          <div class="text-8xl mb-6">âœ…</div>
          <h2 class="text-2xl font-bold text-gray-900 mb-4">Booking Confirmed!</h2>
          <p class="text-lg text-gray-700 mb-6">
            We'll call <span class="font-semibold">${e}</span> back soon.
          </p>
          
          <div class="bg-green-50 border border-green-200 rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-center space-x-2 mb-3">
              <div class="text-2xl">ðŸ“ž</div>
              <div class="font-semibold text-green-800">Keep your phone nearby!</div>
          </div>
            <p class="text-sm text-green-700 mb-3">
              Our pharmacist will call to confirm your ${this.getTimeText(t)} appointment.
            </p>
            <div class="text-xs text-green-600 font-semibold">
              Reference: ${(r==null?void 0:r.reference)||`#${Date.now().toString().slice(-6)}`}
        </div>
          </div>
          
          <!-- Multi-Channel Confirmation -->
          <div class="bg-blue-50 border border-blue-200 rounded-2xl p-4 mb-6">
            <h3 class="font-semibold text-blue-800 mb-2">ðŸ“± Confirmation Sent</h3>
            <div class="space-y-1 text-sm text-blue-700">
              <div class="flex items-center justify-center space-x-2">
                <span>ðŸ’¬</span>
                <span>SMS confirmation sent</span>
              </div>
              <div class="flex items-center justify-center space-x-2">
                <span>ðŸ“±</span>
                <span>WhatsApp message sent</span>
              </div>
            </div>
          </div>
          
          <div class="space-y-3">
            <button data-call-pharmacy class="w-full bg-blue-600 text-white py-4 rounded-2xl font-bold">
              ðŸ“ž Call Us Instead
            </button>
            <button onclick="window.app.loadServiceSelector()" class="w-full bg-gray-100 text-gray-700 py-3 rounded-2xl font-semibold">
              â† Back to Services
            </button>
          </div>
          
          <!-- PWA Install Prompt -->
          <div class="mt-6 pt-4 border-t border-gray-100">
            <button id="install-pwa" class="text-sm text-blue-600 underline" style="display: none;">
              ðŸ“± Add to Home Screen for faster booking
            </button>
          </div>
        </div>
    `,this.showPWAInstallPrompt(),this.showConfettiEffect())}showPWAInstallPrompt(){let e;window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),e=t;const r=document.getElementById("install-pwa");r&&(r.style.display="block",r.addEventListener("click",()=>{e.prompt(),e.userChoice.then(s=>{s.outcome==="accepted"&&console.log("User accepted the PWA install prompt"),e=null,r.style.display="none"})}))})}showUltraFastError(){const e=document.getElementById("book-now-btn");e&&(e.innerHTML="âŒ Try Again",e.classList.add("bg-red-500"),setTimeout(()=>{e.innerHTML="ðŸ“ž Book Consultation",e.classList.remove("bg-red-500"),e.disabled=!1},3e3))}async loadServiceLanding(e){const t=Y(e);if(!t){this.loadServiceSelector();return}this.currentService=t,$.trackPageView(t.title);const r=this.generateServiceLandingHTML(t);document.getElementById("app").innerHTML=r,document.title=`${t.title} - Cornwells Pharmacy Services`,this.updateMetaDescription(t.description),this.initializeAnimations()}loadServiceSelector(){this.currentService=null;const e=this.generateServiceSelectorHTML();document.getElementById("app").innerHTML=e,document.title="Cornwells Pharmacy Services - Expert Healthcare in Your Community",this.updateMetaDescription("Discover our comprehensive range of pharmacy services including health screenings, vaccinations, travel health, and specialized consultations. Book your appointment today."),$.trackPageView(),this.initializeAnimations()}generateServiceSelectorHTML(){return`
      <div class="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900">
        <!-- Mobile-First Header -->
        <div class="bg-white/95 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-50 safe-area-top">
          <div class="px-4 py-4">
            <div class="text-center">
              <h1 class="text-xl font-bold text-gray-900">Cornwells Pharmacy</h1>
              <p class="text-sm text-gray-600 mt-1">Choose Your Service</p>
            </div>
          </div>
        </div>
          
        <!-- Mobile Hero Section -->
        <div class="px-4 py-6 text-center text-white">
          <h2 class="text-2xl font-bold mb-2">Expert Healthcare Services</h2>
          <p class="text-white/90 mb-6">Professional consultations available today</p>
          
          <!-- Quick Stats with Icons -->
          <div class="flex justify-center space-x-8 mb-6">
            <div class="text-center">
              <div class="flex items-center justify-center mb-1">
                <span class="text-lg mr-1">âš¡</span>
                <div class="text-lg font-bold">Fast</div>
              </div>
              <div class="text-xs text-white/80">Response</div>
            </div>
            <div class="text-center">
              <div class="flex items-center justify-center mb-1">
                <span class="text-lg mr-1">ðŸ“</span>
                <div class="text-lg font-bold">10</div>
              </div>
              <div class="text-xs text-white/80">Locations</div>
            </div>
            <div class="text-center">
              <div class="flex items-center justify-center mb-1">
                <span class="text-lg mr-1">ðŸ’¬</span>
                <div class="text-lg font-bold">Free</div>
              </div>
              <div class="text-xs text-white/80">Consultation</div>
            </div>
          </div>
        </div>

        <!-- Enhanced Service Cards -->
        <div class="bg-white rounded-t-3xl px-4 py-6 min-h-screen">
          <div class="max-w-2xl mx-auto">
            <div class="space-y-5">
              ${zn().map((t,r)=>`
                <div class="service-card bg-white border-2 border-gray-100 rounded-2xl overflow-hidden shadow-sm hover:shadow-lg transition-all duration-200" data-service="${t.id}">
                  <!-- Service Header with Fixed Height -->
                  <div class="p-4 bg-gradient-to-r ${t.colorScheme.primary} text-white">
                    <div class="flex items-center justify-between">
                      <div class="flex items-center space-x-3 flex-1">
                        <div class="text-2xl">${t.icon}</div>
                        <div class="flex-1">
                          <h3 class="font-bold text-lg leading-tight">${t.title}</h3>
                          <p class="text-white/90 text-sm mt-0.5">${t.headline}</p>
                        </div>
                      </div>
                      <!-- Fixed Height Availability Block -->
                      <div class="text-right flex-shrink-0 min-w-[80px]">
                        <div class="h-8 flex flex-col justify-center">
                          <div class="text-xs font-semibold leading-tight">Available</div>
                          <div class="text-xs font-semibold leading-tight">Today</div>
                        </div>
                        <div class="text-xs text-white/80 mt-0.5">Quick response</div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Benefits Section with Consistent Spacing -->
                  <div class="p-4">
                    <div class="space-y-3 mb-5">
                      ${t.specificBenefits.slice(0,2).map(s=>`
                        <div class="flex items-start space-x-3 text-sm">
                          <div class="w-1.5 h-1.5 bg-gradient-to-r ${t.colorScheme.primary} rounded-full mt-2 flex-shrink-0"></div>
                          <span class="text-gray-700 leading-relaxed">${s}</span>
                        </div>
                      `).join("")}
                    </div>
                    
                    <!-- Action Buttons with Improved Contrast -->
                    <div class="flex space-x-3">
                      <button 
                        onclick="window.app.showQuickBooking('${t.id}')" 
                        class="flex-1 bg-gradient-to-r ${t.colorScheme.primary} text-white py-3 px-4 rounded-xl font-semibold text-sm shadow-lg transform transition-all active:scale-95 min-h-[44px]"
                      >
                        ðŸ“ž Quick Book
                      </button>
                      <button 
                        onclick="window.app.loadServiceLanding('${t.id}')" 
                        class="px-4 py-3 bg-gray-50 text-gray-700 rounded-xl font-semibold text-sm border-2 border-gray-200 hover:bg-gray-100 hover:border-gray-300 transition-colors min-h-[44px]"
                      >
                        Learn More
                      </button>
                    </div>
                  </div>
                </div>
              `).join("")}
            </div>
            
            <!-- Emergency Contact -->
            <div class="text-center mt-8 pt-6 border-t border-gray-100">
              <p class="text-sm text-gray-600 mb-3">Need to speak to someone immediately?</p>
              <button data-call-pharmacy class="bg-green-600 text-white px-6 py-3 rounded-xl font-semibold shadow-lg inline-flex items-center space-x-2">
                <span>ðŸ“ž</span>
                <span>Call Pharmacy Now</span>
              </button>
            </div>
            
            <div class="safe-area-bottom"></div>
          </div>
        </div>
      </div>
    `}showQuickBooking(e){const t=Y(e);if(!t)return;const r=`
      <div id="quick-booking-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-end sm:items-center justify-center">
        <!-- iPhone-optimized modal -->
        <div class="bg-white w-full sm:max-w-sm sm:w-full sm:rounded-3xl rounded-t-3xl max-h-[90vh] overflow-y-auto">
          <!-- Safe area padding for iPhone -->
          <div class="px-4 py-4 pb-safe">
            <!-- Compact Header -->
            <div class="text-center mb-4">
              <div class="flex items-center justify-center space-x-2 mb-2">
                <div class="text-2xl">${t.icon}</div>
                <h2 class="text-lg font-bold text-gray-900">${t.title}</h2>
              </div>
              <p class="text-sm text-blue-600 font-semibold">ðŸ“ž Request a callback</p>
            </div>
            
            <form id="quick-booking-form" class="space-y-4">
              <!-- Phone Number (Compact) -->
              <div>
                <label for="quick-phone" class="block text-sm font-semibold text-gray-700 mb-2">Your Phone Number</label>
                <input 
                  type="tel" 
                  id="quick-phone" 
                  required 
                  placeholder="07XXX XXX XXX"
                  class="w-full px-4 py-3 text-lg font-semibold text-center border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-0 transition-colors"
                  autocomplete="tel"
                  inputmode="numeric"
                >
                <div id="quick-phone-feedback" class="mt-1 text-center text-sm"></div>
              </div>

              <!-- Time Preference (Compact) -->
              <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">When works best?</label>
                <div class="space-y-2">
                  <label class="flex items-center p-2.5 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors active:bg-gray-100">
                    <input type="radio" name="quick-time" value="today" class="mr-3 scale-110" ${new Date().getHours()<17?"checked":""}>
                    <div class="flex items-center justify-between w-full">
                      <span class="font-medium text-sm">Today</span>
                      <span class="text-xs text-gray-600">Next available</span>
                    </div>
                  </label>
                  <label class="flex items-center p-2.5 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors active:bg-gray-100">
                    <input type="radio" name="quick-time" value="tomorrow" class="mr-3 scale-110" ${new Date().getHours()>=17?"checked":""}>
                    <div class="flex items-center justify-between w-full">
                      <span class="font-medium text-sm">Tomorrow</span>
                      <span class="text-xs text-gray-600">Morning/afternoon</span>
                    </div>
                  </label>
                  <label class="flex items-center p-2.5 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors active:bg-gray-100">
                    <input type="radio" name="quick-time" value="this-week" class="mr-3 scale-110">
                    <div class="flex items-center justify-between w-full">
                      <span class="font-medium text-sm">This Week</span>
                      <span class="text-xs text-gray-600">When convenient</span>
                    </div>
                  </label>
                </div>
              </div>

              <!-- Action Buttons (iPhone-optimized) -->
              <div class="space-y-3 pt-3">
                <button 
                  type="submit" 
                  id="quick-submit-btn" 
                  class="w-full bg-gradient-to-r ${t.colorScheme.primary} text-white py-4 rounded-xl font-bold text-base shadow-lg transform transition-all active:scale-95 min-h-[44px]"
                  disabled
                >
                  ðŸ“ž Book Consultation
                </button>
                <button 
                  type="button" 
                  onclick="document.getElementById('quick-booking-modal').remove()" 
                  class="w-full bg-gray-100 text-gray-700 py-3 rounded-xl font-semibold text-sm min-h-[44px]"
                >
                  Cancel
                </button>
              </div>
            </form>

            <!-- Compact Trust Indicators -->
            <div class="flex justify-center space-x-4 mt-4 pt-3 border-t border-gray-100">
              <div class="text-center">
                <div class="text-sm mb-0.5">âš¡</div>
                <div class="text-xs font-semibold text-gray-900">Fast</div>
              </div>
              <div class="text-center">
                <div class="text-sm mb-0.5">ðŸ”’</div>
                <div class="text-xs font-semibold text-gray-900">Private</div>
              </div>
              <div class="text-center">
                <div class="text-sm mb-0.5">ðŸ’¯</div>
                <div class="text-xs font-semibold text-gray-900">Free</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    `;document.body.insertAdjacentHTML("beforeend",r),this.initializeQuickBooking(e)}initializeQuickBooking(e){const t=document.getElementById("quick-phone"),r=document.getElementById("quick-phone-feedback"),s=document.getElementById("quick-submit-btn"),i=document.getElementById("quick-booking-form");t==null||t.addEventListener("input",o=>{let l=o.target.value.replace(/\D/g,"");l.startsWith("44")&&(l=l.substring(2)),l.startsWith("0")&&(l=l.substring(1)),l.length>0&&(l.length<=5?l=`07${l}`:l.length<=8?l=`07${l.substring(1,5)} ${l.substring(5)}`:l=`07${l.substring(1,5)} ${l.substring(5,8)} ${l.substring(8,11)}`),o.target.value=l,this.isValidUKMobile(l)?(r.innerHTML='<span class="text-green-600">âœ… Perfect!</span>',s.disabled=!1,s.classList.remove("opacity-50")):l.length>5?(r.innerHTML='<span class="text-orange-600">âš ï¸ Please check your number</span>',s.disabled=!0,s.classList.add("opacity-50")):(r.innerHTML="",s.disabled=!0,s.classList.add("opacity-50"))}),i==null||i.addEventListener("submit",o=>{o.preventDefault(),this.handleQuickBookingSubmission(e)})}async handleQuickBookingSubmission(e){const t=Y(e),r=document.getElementById("quick-submit-btn"),s=r.textContent;try{r.textContent="â³ Booking...",r.disabled=!0;const i=document.getElementById("quick-phone").value.replace(/\s/g,""),o=document.querySelector('input[name="quick-time"]:checked').value,l={patient_name:null,phone_number:i,email:null,preferred_time_slot:o,notes:"Quick booking from service selector",service_type:e,service_name:t.title,source_url:window.location.href,consent_given:!0,preferred_contact_method:"phone",booking_type:"quick_book",utm_params:$.getStoredUTMData()},{data:a,error:u}=await le.from("service_consultations").insert([l]).select();if(u)throw u;$.trackBookingConversion(e,l),this.showQuickBookingSuccess(i,o,t)}catch(i){console.error("Quick booking error:",i),this.showQuickBookingError(),r.textContent=s,r.disabled=!1}}showQuickBookingSuccess(e,t,r){const s=document.getElementById("quick-booking-modal");s&&(s.innerHTML=`
        <div class="bg-white rounded-3xl max-w-sm w-full">
          <div class="p-6 text-center">
            <div class="text-6xl mb-4">âœ…</div>
            <h2 class="text-xl font-bold text-gray-900 mb-2">Booking Confirmed!</h2>
            <p class="text-gray-700 mb-6">
              We'll call <span class="font-semibold">${e}</span> back soon to discuss your ${r.title.toLowerCase()}.
            </p>
            
            <div class="bg-green-50 border border-green-200 rounded-2xl p-4 mb-6">
              <div class="flex items-center justify-center space-x-2 mb-2">
                <div class="text-xl">ðŸ“ž</div>
                <div class="font-semibold text-green-800">Keep your phone nearby!</div>
              </div>
              <p class="text-sm text-green-700">
                Our pharmacist will call to confirm your ${this.getTimeText(t)} appointment.
              </p>
            </div>
            
            <div class="space-y-3">
              <button onclick="document.getElementById('quick-booking-modal').remove()" class="w-full bg-gradient-to-r ${r.colorScheme.primary} text-white py-4 rounded-2xl font-bold">
                Perfect, Thanks!
              </button>
              <button data-call-pharmacy class="w-full bg-gray-100 text-gray-700 py-3 rounded-2xl font-semibold">
                ðŸ“ž Call Instead
              </button>
            </div>
            
            <div class="mt-6 pt-4 border-t border-gray-100 text-center">
              <p class="text-sm text-gray-600">
                Reference: <span class="font-mono text-xs">#${Date.now().toString().slice(-6)}</span>
              </p>
            </div>
          </div>
        </div>
      `)}showQuickBookingError(){const e=document.getElementById("quick-submit-btn");e&&(e.innerHTML="âŒ Try Again",e.classList.add("bg-red-500"),setTimeout(()=>{e.innerHTML="ðŸ“ž Book Consultation",e.classList.remove("bg-red-500"),e.disabled=!1},3e3))}handleBookingClick(e){const t=e.getAttribute("data-book-consultation");t&&($.trackEvent("booking_intent",{service_id:t,service_name:$.services[t]||"Unknown Service"}),this.showBookingModal(t))}showBookingModal(e){const t=Y(e);if(!t)return;const r=`
      <div id="booking-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
          <div class="p-8">
            <div class="flex justify-between items-center mb-6">
              <h2 class="text-3xl font-bold text-gray-900">Book ${t.title}</h2>
              <button onclick="document.getElementById('booking-modal').remove()" class="text-gray-400 hover:text-gray-600 text-2xl">Ã—</button>
            </div>
          
            <form id="booking-form" class="space-y-6">
              <div class="grid md:grid-cols-2 gap-6">
            <div>
                  <label for="patient-name" class="block text-sm font-semibold text-gray-700 mb-2">Full Name *</label>
                  <input type="text" id="patient-name" required class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            </div>
            <div>
                  <label for="phone-number" class="block text-sm font-semibold text-gray-700 mb-2">Phone Number *</label>
                  <input type="tel" id="phone-number" required class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
            </div>
            
            <div>
                <label for="email" class="block text-sm font-semibold text-gray-700 mb-2">Email Address</label>
                <input type="email" id="email" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            </div>
            
            <div>
                <label for="preferred-time" class="block text-sm font-semibold text-gray-700 mb-2">Preferred Time *</label>
                <select id="preferred-time" required class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                  <option value="">Select preferred time</option>
                  <option value="0">Morning (9:00 AM - 12:00 PM)</option>
                  <option value="1">Afternoon (12:00 PM - 5:00 PM)</option>
                  <option value="2">Evening (5:00 PM - 7:00 PM)</option>
              </select>
            </div>
            
            <div>
                <label for="notes" class="block text-sm font-semibold text-gray-700 mb-2">Additional Notes</label>
                <textarea id="notes" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Any specific concerns or questions?"></textarea>
            </div>
            
              <div class="flex items-start space-x-3">
                <input type="checkbox" id="consent" required class="mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                <label for="consent" class="text-sm text-gray-700">
                  I consent to Cornwells Pharmacy contacting me about this consultation and understand that my data will be processed in accordance with their privacy policy. *
              </label>
            </div>
              
              <button type="submit" id="submit-booking" class="w-full bg-gradient-to-r ${t.colorScheme.primary} text-white py-4 rounded-2xl font-bold text-lg hover:opacity-90 transition-opacity">
                ðŸ“… Submit Booking Request
            </button>
              
              <p class="text-sm text-gray-600 text-center">
                We'll call you within 2 hours to confirm your consultation time.
              </p>
            </form>
          </div>
        </div>
      </div>
    `;document.body.insertAdjacentHTML("beforeend",r),document.getElementById("booking-form").addEventListener("submit",s=>{s.preventDefault(),this.handleBookingSubmission(e)})}handleCallClick(){$.trackEvent("call_intent",{source:"website_button"}),this.showSuccessMessage("ðŸ“ž Calling pharmacy... (In demo: would open phone dialer)")}handleCornwellsClick(){$.trackEvent("website_visit_intent",{source:"services_site"}),window.open("https://cornwells.co.uk","_blank")}async generateQRCode(e){var i;const t=e.getAttribute("data-generate-qr")||((i=this.currentService)==null?void 0:i.id);if(!t)return;const r=Y(t),s=`${this.baseURL}/${t}`;try{const o=await ce.toDataURL(s,{width:256,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"}),l=`
        <div id="qr-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
          <div class="bg-white rounded-3xl p-8 max-w-sm w-full text-center">
            <h3 class="text-2xl font-bold text-gray-900 mb-6">${r.title}</h3>
            <div class="mb-6">
              <img src="${o}" alt="QR Code" class="mx-auto rounded-2xl shadow-lg">
            </div>
            <p class="text-gray-600 mb-6">Scan to access this service page</p>
            <button class="w-full py-3 bg-gray-900 text-white rounded-2xl font-semibold" onclick="this.closest('#qr-modal').remove()">
              Close
            </button>
          </div>
        </div>
      `;document.body.insertAdjacentHTML("beforeend",l)}catch(o){console.error("Error generating QR code:",o)}}initializeAnimations(){const e=new IntersectionObserver(t=>{t.forEach(r=>{r.isIntersecting&&(r.target.style.opacity="1",r.target.style.transform="translateY(0)")})},{threshold:.1});document.querySelectorAll(".fade-in-up").forEach(t=>{t.style.opacity="0",t.style.transform="translateY(30px)",t.style.transition="all 0.6s ease-out",e.observe(t)}),A({targets:".stagger-1, .stagger-2, .stagger-3, .stagger-4",opacity:[0,1],translateY:[30,0],delay:function(t,r){return r*200},duration:800,easing:"easeOutCubic"})}async handleMobileBookingSubmission(){const e=document.getElementById("mobile-booking-form"),t=document.getElementById("mobile-submit");if(!e||!t||!this.currentService)return;const r={patient_name:document.getElementById("mobile-name").value.trim(),phone_number:document.getElementById("mobile-phone").value.trim(),email:null,preferred_time_slot:Pr[document.getElementById("mobile-time").value],notes:document.getElementById("mobile-notes").value.trim()||null,service_type:this.currentService.id,service_name:Tr[this.currentService.id],source_url:window.location.href,consent_given:document.getElementById("mobile-consent").checked,preferred_contact_method:"phone"},s=$.getStoredUTMData();Object.keys(s).length>0&&(r.utm_params=s),t.disabled=!0,t.innerHTML="â³ Submitting...";try{const{data:i,error:o}=await le.from("service_consultations").insert([r]).select();if(o)throw o;$.trackBookingConversion(this.currentService.id,r),this.showMobileSuccessMessage()}catch(i){console.error("Mobile booking submission error:",i),this.showMobileErrorMessage(),t.disabled=!1,t.innerHTML="ðŸ“… Book My Consultation"}}showMobileSuccessMessage(){const e=document.getElementById("mobile-booking-form");e&&(e.innerHTML=`
        <div class="text-center py-8">
          <div class="text-6xl mb-4">âœ…</div>
          <h3 class="text-2xl font-bold text-gray-900 mb-4">Booking Submitted!</h3>
          <p class="text-lg text-gray-700 mb-6">
            Thank you! We'll call you within 2 hours to confirm your consultation time.
          </p>
          <div class="bg-green-50 border border-green-200 rounded-xl p-4 mb-6">
            <p class="text-sm text-green-800">
              ðŸ“ž Keep your phone nearby - we'll be in touch soon!
            </p>
          </div>
          <button data-call-pharmacy class="bg-blue-600 text-white px-6 py-3 rounded-xl font-semibold">
            ðŸ“ž Call Us Now Instead
          </button>
        </div>
      `)}showMobileErrorMessage(){const e=document.getElementById("mobile-booking-form");if(e){const t=document.createElement("div");t.className="bg-red-50 border border-red-200 rounded-xl p-4 mb-4",t.innerHTML=`
        <p class="text-sm text-red-800">
          âš ï¸ Sorry, there was an issue submitting your booking. Please try calling us directly.
        </p>
      `,e.insertBefore(t,e.firstChild),setTimeout(()=>{t.remove()},5e3)}}async handleBookingSubmission(e){const t=document.getElementById("submit-booking"),r=t.innerHTML;try{t.innerHTML="â³ Submitting...",t.disabled=!0;const s={patient_name:document.getElementById("patient-name").value.trim(),phone_number:document.getElementById("phone-number").value.trim(),email:document.getElementById("email").value.trim()||null,preferred_time_slot:Pr[document.getElementById("preferred-time").value],notes:document.getElementById("notes").value.trim()||null,service_type:e,service_name:Tr[e],source_url:window.location.href,consent_given:document.getElementById("consent").checked,preferred_contact_method:"phone"},i=$.getStoredUTMData();Object.keys(i).length>0&&(s.utm_params=i),console.log("Submitting booking:",s);const{data:o,error:l}=await le.from("service_consultations").insert([s]).select();if(l)throw console.error("Supabase error:",l),new Error("Failed to submit booking. Please try again.");console.log("Booking submitted successfully:",o),$.trackBookingConversion(e,s),document.getElementById("booking-modal").remove(),this.showSuccessMessage("ðŸŽ‰ Booking request sent! We'll call you within 2 hours to confirm your consultation.")}catch(s){console.error("Booking submission error:",s),this.showErrorMessage("Sorry, there was an issue submitting your booking. Please try again or call us directly."),t.innerHTML=r,t.disabled=!1}}showSuccessMessage(e){const t=document.createElement("div");t.className="fixed bottom-6 left-6 right-6 bg-green-600 text-white p-4 rounded-2xl shadow-xl z-50 text-center font-semibold",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.parentElement&&t.remove()},4e3)}showErrorMessage(e){const t=document.createElement("div");t.className="fixed bottom-6 left-6 right-6 bg-red-600 text-white p-4 rounded-2xl shadow-xl z-50 text-center font-semibold",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.parentElement&&t.remove()},7e3)}updateMetaDescription(e){let t=document.querySelector('meta[name="description"]');t||(t=document.createElement("meta"),t.name="description",document.head.appendChild(t)),t.content=e}generateServiceLandingHTML(e){return`
      <div class="min-h-screen bg-gradient-to-br ${e.colorScheme.primary}">
        <!-- Mobile Navigation -->
        <nav class="bg-white/95 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-50 safe-area-top">
          <div class="px-4 py-4">
            <div class="flex items-center justify-between">
              <button onclick="window.app.loadServiceSelector()" class="flex items-center space-x-2 text-gray-600 font-medium">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                <span>Back</span>
              </button>
              <h1 class="text-lg font-bold text-gray-900">Cornwells</h1>
              <button data-call-pharmacy class="bg-green-600 text-white px-4 py-2 rounded-xl font-semibold text-sm">
                ðŸ“ž Call
              </button>
            </div>
          </div>
        </nav>

        <!-- Mobile Hero -->
        <div class="px-4 py-8 text-center text-white">
          <div class="fade-in-up">
            <div class="text-6xl mb-6">${e.icon}</div>
            <h1 class="text-3xl font-bold mb-4 leading-tight">${e.title}</h1>
            <p class="text-lg text-white/90 mb-8 leading-relaxed max-w-sm mx-auto">
              ${e.description}
            </p>
          </div>
        </div>

        <!-- Mobile Benefits Section -->
        <div class="bg-white rounded-t-3xl mt-8 min-h-screen">
          <div class="px-4 py-8">
            <!-- What You Get -->
            <div class="mb-8">
              <h2 class="text-2xl font-bold text-gray-900 mb-6">What You Get</h2>
              <div class="space-y-4">
                ${e.specificBenefits.map(t=>`
                  <div class="flex items-start space-x-4 p-4 bg-gray-50 rounded-2xl">
                    <div class="w-6 h-6 bg-gradient-to-r ${e.colorScheme.primary} rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                      <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                      </svg>
                    </div>
                    <p class="text-gray-700 leading-relaxed">${t}</p>
                  </div>
                `).join("")}
              </div>
            </div>

            <!-- How It Works -->
            <div class="mb-8">
              <h2 class="text-2xl font-bold text-gray-900 mb-6">How It Works</h2>
              <div class="space-y-4">
                ${e.uniqueProcess.map((t,r)=>`
                  <div class="flex items-start space-x-4 p-4 bg-gradient-to-r ${e.colorScheme.secondary} rounded-2xl">
                    <div class="w-8 h-8 bg-gradient-to-r ${e.colorScheme.primary} rounded-full flex items-center justify-center flex-shrink-0 text-white font-bold">
                      ${r+1}
                    </div>
                    <p class="text-gray-700 leading-relaxed">${t}</p>
                  </div>
                `).join("")}
              </div>
            </div>

            <!-- Social Proof -->
            <div class="bg-gradient-to-r ${e.colorScheme.primary} rounded-2xl p-6 text-white text-center mb-8">
              <div class="text-3xl mb-3">â­â­â­â­â­</div>
              <p class="font-semibold text-lg mb-2">${e.socialProof}</p>
              <p class="text-white/80 text-sm">${e.urgency}</p>
            </div>

            <!-- Mobile CTA Section -->
            <div class="space-y-4 mb-8">
              <button data-book-consultation="${e.id}" class="w-full bg-gradient-to-r ${e.colorScheme.primary} text-white py-5 rounded-2xl font-bold text-lg shadow-xl transform transition-all active:scale-95">
                ðŸ“… Book My Consultation
              </button>
              <button data-call-pharmacy class="w-full bg-gray-100 text-gray-900 py-5 rounded-2xl font-bold text-lg border-2 border-gray-200">
                ðŸ“ž Call to Discuss First
              </button>
            </div>

            <!-- Trust Indicators -->
            <div class="grid grid-cols-2 gap-4 mb-8">
              <div class="text-center p-4 bg-gray-50 rounded-2xl">
                <div class="text-3xl mb-2">âš¡</div>
                <div class="font-semibold text-gray-900 text-sm">Quick Access</div>
                <div class="text-xs text-gray-600">24-48h appointments</div>
              </div>
              <div class="text-center p-4 bg-gray-50 rounded-2xl">
                <div class="text-3xl mb-2">ðŸ†</div>
                <div class="font-semibold text-gray-900 text-sm">Expert Care</div>
                <div class="text-xs text-gray-600">Qualified pharmacists</div>
              </div>
              <div class="text-center p-4 bg-gray-50 rounded-2xl">
                <div class="text-3xl mb-2">ðŸ”’</div>
                <div class="font-semibold text-gray-900 text-sm">Confidential</div>
                <div class="text-xs text-gray-600">Private consultations</div>
              </div>
              <div class="text-center p-4 bg-gray-50 rounded-2xl">
                <div class="text-3xl mb-2">ðŸ“</div>
                <div class="font-semibold text-gray-900 text-sm">Local</div>
                <div class="text-xs text-gray-600">10 locations</div>
              </div>
            </div>

            <!-- Contact Info -->
            <div class="text-center text-gray-600 text-sm safe-area-bottom">
              <p class="mb-2">Available Mon-Sat, 9am-6pm</p>
              <p>Trusted healthcare since 1835</p>
            </div>
          </div>
        </div>
      </div>
    `}showConfettiEffect(){for(let e=0;e<50;e++){const t=document.createElement("div");t.className="confetti",t.style.left=Math.random()*100+"%",t.style.animationDelay=Math.random()*3+"s",t.style.animationDuration=Math.random()*3+2+"s",document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},5e3)}}}document.addEventListener("DOMContentLoaded",()=>{window.app=new Ia});
//# sourceMappingURL=main-0okcIQY9.js.map
