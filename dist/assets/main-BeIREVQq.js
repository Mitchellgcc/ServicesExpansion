(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const _t={"metabolic-weight":{id:"metabolic-weight",title:"Metabolic & Weight Management",headline:"Finally Lose Weight & Keep It Off",subheadline:"Break free from yo-yo dieting with medical support that actually works.",description:"Ready for lasting results? Get proven weight loss support with expert medical guidance.",colorScheme:{primary:"from-orange-600 to-red-600",secondary:"from-orange-500/20 to-red-500/20",accent:"bg-orange-500",hero:"from-orange-900 via-red-900 to-slate-900"},specificBenefits:["Lose 10-30 pounds safely without crash dieting or hunger","Get your energy back and stop afternoon crashes","Keep the weight off for good with proven medical support"],uniqueProcess:["Complete health assessment to find what's been holding you back","Personalized plan with medication support if needed","Weekly check-ins until you reach and maintain your goal"],callToAction:"Ready to break the cycle? Start your weight loss journey the right way.",socialProof:"Over 300 successful weight loss transformations",urgency:"New patient spots filling fast",targetAudience:"Adults wanting sustainable weight loss with medical support",icon:"âš¡",featured:!0},"womens-health":{id:"womens-health",title:"Women's Health Services",headline:"Feel Like Yourself Again",subheadline:"End sleepless nights and hot flashes with expert menopause care",description:"Menopause doesn't have to be this hard. Get personalized support that actually works.",colorScheme:{primary:"from-pink-600 to-purple-600",secondary:"from-pink-500/20 to-purple-500/20",accent:"bg-pink-500",hero:"from-pink-900 via-purple-900 to-slate-900"},specificBenefits:["Sleep through the night without hot flashes waking you up","Feel balanced and energetic instead of exhausted and moody",`Get real solutions that work - not just "it's normal" advice`],uniqueProcess:["Private 20-minute consultation to understand your symptoms","Personalized treatment plan (HRT, natural alternatives, or both)","Ongoing support with adjustments until you feel right again"],callToAction:"Ready to feel like yourself again? Book your confidential consultation.",socialProof:"Helping 200+ women reclaim their energy and confidence",urgency:"Limited consultation slots this week",targetAudience:"Women aged 45-65 experiencing menopause symptoms",icon:"ðŸŒ¸",featured:!0},"health-screening":{id:"health-screening",title:"Health Screening & Monitoring",headline:"Catch Problems Before They Start",subheadline:"Find out what's really going on inside your body",description:"Take control of your health. Get instant answers and peace of mind with comprehensive screening.",colorScheme:{primary:"from-blue-600 to-cyan-600",secondary:"from-blue-500/20 to-cyan-500/20",accent:"bg-blue-500",hero:"from-blue-900 via-cyan-900 to-slate-900"},specificBenefits:["Catch diabetes, heart disease, and stroke risk before symptoms appear","Get instant results with clear explanations - no medical jargon","Walk out with a personalized plan to improve your numbers"],uniqueProcess:["Choose your screening level based on your concerns","Quick 15-minute tests with results explained immediately","Personalized action plan to keep you healthy long-term"],callToAction:"Don't wait for warning signs. Know your health status today.",socialProof:"Trusted by 1,000+ health-conscious individuals",urgency:"Same-day screening available",targetAudience:"Health-conscious adults 40+ wanting proactive health monitoring",icon:"ðŸ”",featured:!1},vaccinations:{id:"vaccinations",title:"Core Vaccinations",headline:"Keep Your Family Safe",subheadline:"Protect against serious illness with convenient vaccination services",description:"Keep your family healthy and protected with convenient same-day vaccinations.",colorScheme:{primary:"from-green-600 to-emerald-600",secondary:"from-green-500/20 to-emerald-500/20",accent:"bg-green-500",hero:"from-green-900 via-emerald-900 to-slate-900"},specificBenefits:["Avoid weeks of illness from flu, COVID, or pneumonia","Same-day service - no GP wait times or hassle","Family packages available with special pricing"],uniqueProcess:["Quick health check to recommend the right vaccines","Professional vaccination with comfortable, experienced staff","Digital certificate ready for travel or work requirements"],callToAction:"Protect your family now. Walk-ins welcome today.",socialProof:"Protecting 2,000+ families this year",urgency:"Flu season starting - book before it's too late",targetAudience:"Individuals and families wanting protection against preventable diseases",icon:"ðŸ›¡ï¸",featured:!1},"nhs-services":{id:"nhs-services",title:"NHS Clinical Services",headline:"Feel Better Today",subheadline:"Get NHS treatment now - no GP appointment needed",description:"Feeling unwell? Get free NHS treatment and medicine without the wait.",colorScheme:{primary:"from-indigo-600 to-blue-700",secondary:"from-indigo-500/20 to-blue-500/20",accent:"bg-indigo-500",hero:"from-indigo-900 via-blue-900 to-slate-900"},specificBenefits:["Get rid of UTIs, sore throats, and infections today","No waiting for GP appointments when you're feeling awful","Walk out with your medicine - completely free on NHS"],uniqueProcess:["Walk in when you're unwell - no appointment booking stress","Professional assessment by NHS pharmacist in minutes","Get treated immediately or referred quickly if needed"],callToAction:"Ready to feel better? Get the help you need now.",socialProof:"Helping 500+ patients get better faster each month",urgency:"Open now - no appointment needed",targetAudience:"Anyone needing quick NHS healthcare for minor illnesses",icon:"ðŸ¥",featured:!1},"mens-health":{id:"mens-health",title:"Men's Health & Performance",headline:"Get Your Edge Back",subheadline:"Reclaim your energy, strength, and confidence",description:"Ready to feel energized and strong again? Reclaim the vitality you had in your twenties.",colorScheme:{primary:"from-slate-600 to-gray-800",secondary:"from-slate-500/20 to-gray-500/20",accent:"bg-slate-600",hero:"from-slate-800 via-gray-900 to-black"},specificBenefits:["Wake up energized instead of exhausted every morning","Build muscle and strength like you did when you were younger","Regain confidence in the bedroom with proven treatments"],uniqueProcess:["Private consultation about your energy and performance goals","Comprehensive testing to find what's really causing the problem","Personalized treatment plan to get you back to your best"],callToAction:"Ready to feel like your best self again? Take control today.",socialProof:"Helping 150+ men reclaim their prime",urgency:"Confidential consultations available this week",targetAudience:"Men 35-65 wanting to optimize health, energy, and performance",icon:"ðŸ’ª",featured:!0},"travel-health":{id:"travel-health",title:"Travel Health Services",headline:"Travel Without Worry",subheadline:"Protect yourself from diseases that could ruin your trip",description:"Enjoy your dream holiday with confidence. Get the right protection for any destination.",colorScheme:{primary:"from-sky-600 to-blue-600",secondary:"from-sky-500/20 to-blue-500/20",accent:"bg-sky-500",hero:"from-sky-900 via-blue-900 to-slate-900"},specificBenefits:["Avoid malaria, typhoid, and serious travel diseases","Get expert advice for your exact destination and activities","Fast-track service for last-minute travel plans"],uniqueProcess:["Tell us where you're going and we'll recommend what you need","Professional vaccinations and travel health advice in one visit","All certificates and documentation sorted for your trip"],callToAction:"Ready for worry-free travel? Get protected today.",socialProof:"Protecting 800+ travelers every year",urgency:"Last-minute appointments available",targetAudience:"Travelers needing destination-specific health protection and advice",icon:"âœˆï¸",featured:!0},"gut-health":{id:"gut-health",title:"Gut Health & Digestive Wellness",headline:"Eat Without Fear Again",subheadline:"Stop bloating, pain, and bathroom emergencies for good",description:"Ready to enjoy food again without discomfort? Get your digestion working properly.",colorScheme:{primary:"from-green-500 to-lime-600",secondary:"from-green-400/20 to-lime-400/20",accent:"bg-green-500",hero:"from-green-900 via-lime-900 to-slate-900"},specificBenefits:["Stop embarrassing bloating and gas that ruins your day","Find out exactly which foods are causing your problems","Enjoy meals without worrying about pain or bathroom trips"],uniqueProcess:["Complete digestive assessment to find your specific triggers","Personalized healing plan with natural solutions that work","Ongoing support until you can eat normally again"],callToAction:"Ready to enjoy eating again? Let's fix your gut health today.",socialProof:"Helping 250+ people enjoy food again",urgency:"Limited gut health consultations this month",targetAudience:"Adults with IBS, bloating, food intolerances, or digestive discomfort",icon:"ðŸŒ±",featured:!1}},ar=n=>_t[n]||null,Dn="modulepreload",Un=function(n){return"/"+n},lr={},Oe=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(t.map(a=>{if(a=Un(a),a in lr)return;lr[a]=!0;const u=a.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${c}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":Dn,u||(h.as="script"),h.crossOrigin="",h.href=a,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((d,f)=>{h.addEventListener("load",d),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${a}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},Nn=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Oe(async()=>{const{default:r}=await Promise.resolve().then(()=>ve);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Mt extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Fn extends Mt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class qn extends Mt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class zn extends Mt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var kt;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(kt||(kt={}));var Hn=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};class Vn{constructor(e,{headers:t={},customFetch:r,region:i=kt.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=Nn(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Hn(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:o}=t;let l={},{region:a}=t;a||(a=this.region),a&&a!=="any"&&(l["x-region"]=a);let u;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),i),body:u}).catch(g=>{throw new Fn(g)}),h=c.headers.get("x-relay-error");if(h&&h==="true")throw new qn(c);if(!c.ok)throw new zn(c);let d=((r=c.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),f;return d==="application/json"?f=yield c.json():d==="application/octet-stream"?f=yield c.blob():d==="text/event-stream"?f=c:d==="multipart/form-data"?f=yield c.formData():f=yield c.text(),{data:f,error:null}}catch(i){return{data:null,error:i}}})}}var U=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jn(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var B={},Dt={},Je={},Re={},Ke={},Ge={},Kn=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},de=Kn();const Gn=de.fetch,Rr=de.fetch.bind(de),jr=de.Headers,Wn=de.Request,Yn=de.Response,ve=Object.freeze(Object.defineProperty({__proto__:null,Headers:jr,Request:Wn,Response:Yn,default:Rr,fetch:Gn},Symbol.toStringTag,{value:"Module"})),Qn=Jn(ve);var We={};Object.defineProperty(We,"__esModule",{value:!0});let Zn=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};We.default=Zn;var $r=U&&U.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ge,"__esModule",{value:!0});const Xn=$r(Qn),ei=$r(We);let ti=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Xn.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var o,l,a;let u=null,c=null,h=null,d=s.status,f=s.statusText;if(s.ok){if(this.method!=="HEAD"){const y=await s.text();y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=y:c=JSON.parse(y))}const p=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),b=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");p&&b&&b.length>1&&(h=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,d=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const p=await s.text();try{u=JSON.parse(p),Array.isArray(u)&&s.status===404&&(c=[],u=null,d=200,f="OK")}catch{s.status===404&&p===""?(d=204,f="No Content"):u={message:p}}if(u&&this.isMaybeSingle&&(!((a=u==null?void 0:u.details)===null||a===void 0)&&a.includes("0 rows"))&&(u=null,d=200,f="OK"),u&&this.shouldThrowOnError)throw new ei.default(u)}return{error:u,data:c,count:h,status:d,statusText:f}});return this.shouldThrowOnError||(i=i.catch(s=>{var o,l,a;return{error:{message:`${(o=s==null?void 0:s.name)!==null&&o!==void 0?o:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(l=s==null?void 0:s.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(a=s==null?void 0:s.code)!==null&&a!==void 0?a:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}};Ge.default=ti;var ri=U&&U.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ke,"__esModule",{value:!0});const ni=ri(Ge);let ii=class extends ni.default{select(e){let t=!1;const r=(e??"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:i,referencedTable:s=i}={}){const o=s?`${s}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:i=r}={}){const s=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:i=!1,wal:s=!1,format:o="text"}={}){var l;const a=[e?"analyze":null,t?"verbose":null,r?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${a};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Ke.default=ii;var si=U&&U.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Re,"__esModule",{value:!0});const oi=si(Ke);let ai=class extends oi.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};Re.default=ai;var li=U&&U.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Je,"__esModule",{value:!0});const ke=li(Re);let ci=class{constructor(e,{headers:t={},schema:r,fetch:i}){this.url=e,this.headers=t,this.schema=r,this.fetch=i}select(e,{head:t=!1,count:r}={}){const i=t?"HEAD":"GET";let s=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new ke.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),r||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const o=e.reduce((l,a)=>l.concat(Object.keys(a)),[]);if(o.length>0){const l=[...new Set(o)].map(a=>`"${a}"`);this.url.searchParams.set("columns",l.join(","))}}return new ke.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:i,defaultToNull:s=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),s||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const a=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(a.length>0){const u=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new ke.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),this.headers.Prefer=i.join(","),new ke.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new ke.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Je.default=ci;var Ye={},Qe={};Object.defineProperty(Qe,"__esModule",{value:!0});Qe.version=void 0;Qe.version="0.0.0-automated";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.DEFAULT_HEADERS=void 0;const ui=Qe;Ye.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${ui.version}`};var Lr=U&&U.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Dt,"__esModule",{value:!0});const hi=Lr(Je),di=Lr(Re),fi=Ye;let gi=class Br{constructor(e,{headers:t={},schema:r,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},fi.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=i}from(e){const t=new URL(`${this.url}/${e}`);return new hi.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Br(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:i=!1,count:s}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let a;r||i?(o=r?"HEAD":"GET",Object.entries(t).filter(([c,h])=>h!==void 0).map(([c,h])=>[c,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([c,h])=>{l.searchParams.append(c,h)})):(o="POST",a=t);const u=Object.assign({},this.headers);return s&&(u.Prefer=`count=${s}`),new di.default({method:o,url:l,headers:u,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}};Dt.default=gi;var ye=U&&U.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(B,"__esModule",{value:!0});B.PostgrestError=B.PostgrestBuilder=B.PostgrestTransformBuilder=B.PostgrestFilterBuilder=B.PostgrestQueryBuilder=B.PostgrestClient=void 0;const Mr=ye(Dt);B.PostgrestClient=Mr.default;const Dr=ye(Je);B.PostgrestQueryBuilder=Dr.default;const Ur=ye(Re);B.PostgrestFilterBuilder=Ur.default;const Nr=ye(Ke);B.PostgrestTransformBuilder=Nr.default;const Fr=ye(Ge);B.PostgrestBuilder=Fr.default;const qr=ye(We);B.PostgrestError=qr.default;var pi=B.default={PostgrestClient:Mr.default,PostgrestQueryBuilder:Dr.default,PostgrestFilterBuilder:Ur.default,PostgrestTransformBuilder:Nr.default,PostgrestBuilder:Fr.default,PostgrestError:qr.default};const{PostgrestClient:mi,PostgrestQueryBuilder:Ta,PostgrestFilterBuilder:Pa,PostgrestTransformBuilder:Ca,PostgrestBuilder:Aa,PostgrestError:xa}=pi;let St;typeof window>"u"?St=require("ws"):St=window.WebSocket;const vi="2.11.9",yi={"X-Client-Info":`realtime-js/${vi}`},wi="1.0.0",zr=1e4,bi=1e3;var he;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(he||(he={}));var $;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})($||($={}));var N;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(N||(N={}));var Et;(function(n){n.websocket="websocket"})(Et||(Et={}));var ie;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(ie||(ie={}));class _i{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const i=t.getUint8(1),s=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+i));o=o+i;const a=r.decode(e.slice(o,o+s));o=o+s;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:a,payload:u}}}class Hr{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var A;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(A||(A={}));const cr=(n,e,t={})=>{var r;const i=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,o)=>(s[o]=ki(o,n,e,i),s),{})},ki=(n,e,t,r)=>{const i=e.find(l=>l.name===n),s=i==null?void 0:i.type,o=t[n];return s&&!r.includes(s)?Vr(s,o):Tt(o)},Vr=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Pi(e,t)}switch(n){case A.bool:return Si(e);case A.float4:case A.float8:case A.int2:case A.int4:case A.int8:case A.numeric:case A.oid:return Ei(e);case A.json:case A.jsonb:return Ti(e);case A.timestamp:return Ci(e);case A.abstime:case A.date:case A.daterange:case A.int4range:case A.int8range:case A.money:case A.reltime:case A.text:case A.time:case A.timestamptz:case A.timetz:case A.tsrange:case A.tstzrange:return Tt(e);default:return Tt(e)}},Tt=n=>n,Si=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Ei=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Ti=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Pi=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let s;const o=n.slice(1,t);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(l=>Vr(e,l))}return n},Ci=n=>typeof n=="string"?n.replace(" ","T"):n,Jr=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class ct{constructor(e,t,r={},i=zr){this.channel=e,this.event=t,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ur;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(ur||(ur={}));class Ee{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ee.syncState(this.state,i,s,o),this.pendingDiffs.forEach(a=>{this.state=Ee.syncDiff(this.state,a,s,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},i=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Ee.syncDiff(this.state,i,s,o),l())}),this.onJoin((i,s,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:o})}),this.onLeave((i,s,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,i){const s=this.cloneDeep(e),o=this.transformState(t),l={},a={};return this.map(s,(u,c)=>{o[u]||(a[u]=c)}),this.map(o,(u,c)=>{const h=s[u];if(h){const d=c.map(b=>b.presence_ref),f=h.map(b=>b.presence_ref),g=c.filter(b=>f.indexOf(b.presence_ref)<0),p=h.filter(b=>d.indexOf(b.presence_ref)<0);g.length>0&&(l[u]=g),p.length>0&&(a[u]=p)}else l[u]=c}),this.syncDiff(s,{joins:l,leaves:a},r,i)}static syncDiff(e,t,r,i){const{joins:s,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(s,(l,a)=>{var u;const c=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(a),c.length>0){const h=e[l].map(f=>f.presence_ref),d=c.filter(f=>h.indexOf(f.presence_ref)<0);e[l].unshift(...d)}r(l,c,a)}),this.map(o,(l,a)=>{let u=e[l];if(!u)return;const c=a.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),e[l]=u,i(l,u,a),u.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const i=e[r];return"metas"in i?t[r]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):t[r]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var hr;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(hr||(hr={}));var dr;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(dr||(dr={}));var J;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(J||(J={}));class Ut{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=$.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ct(this,N.join,this.params,this.timeout),this.rejoinTimer=new Hr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=$.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=$.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=$.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=$.errored,this.rejoinTimer.scheduleTimeout())}),this._on(N.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new Ee(this),this.broadcastEndpointURL=Jr(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:o,private:l}}=this.params;this._onError(c=>e==null?void 0:e(J.CHANNEL_ERROR,c)),this._onClose(()=>e==null?void 0:e(J.CLOSED));const a={},u={broadcast:s,presence:o,postgres_changes:(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&i!==void 0?i:[],private:l};this.socket.accessTokenValue&&(a.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},a)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:c})=>{var h;if(this.socket.setAuth(),c===void 0){e==null||e(J.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,f=(h=d==null?void 0:d.length)!==null&&h!==void 0?h:0,g=[];for(let p=0;p<f;p++){const b=d[p],{filter:{event:y,schema:v,table:m,filter:w}}=b,k=c&&c[p];if(k&&k.event===y&&k.schema===v&&k.table===m&&k.filter===w)g.push(Object.assign(Object.assign({},b),{id:k.id}));else{this.unsubscribe(),this.state=$.errored,e==null||e(J.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(J.SUBSCRIBED);return}}).receive("error",c=>{this.state=$.errored,e==null||e(J.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(J.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,l,a;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((a=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||a===void 0)&&a.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=$.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(N.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(r=>{const i=new ct(this,N.leave,{},e);i.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,r){const i=new AbortController,s=setTimeout(()=>i.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(s),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new ct(this,e,t,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var i,s;const o=e.toLocaleLowerCase(),{close:l,error:a,leave:u,join:c}=N;if(r&&[l,a,u,c].indexOf(o)>=0&&r!==this._joinRef())return;let d=this._onMessage(o,t,r);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(f=>{var g,p,b;return((g=f.filter)===null||g===void 0?void 0:g.event)==="*"||((b=(p=f.filter)===null||p===void 0?void 0:p.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===o}).map(f=>f.callback(d,r)):(s=this.bindings[o])===null||s===void 0||s.filter(f=>{var g,p,b,y,v,m;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const w=f.id,k=(g=f.filter)===null||g===void 0?void 0:g.event;return w&&((p=t.ids)===null||p===void 0?void 0:p.includes(w))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((b=t.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const w=(v=(y=f==null?void 0:f.filter)===null||y===void 0?void 0:y.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return w==="*"||w===((m=t==null?void 0:t.event)===null||m===void 0?void 0:m.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const g=d.data,{schema:p,table:b,commit_timestamp:y,type:v,errors:m}=g;d=Object.assign(Object.assign({},{schema:p,table:b,commit_timestamp:y,eventType:v,new:{},old:{},errors:m}),this._getPayloadRecords(g))}f.callback(d,r)})}_isClosed(){return this.state===$.closed}_isJoined(){return this.state===$.joined}_isJoining(){return this.state===$.joining}_isLeaving(){return this.state===$.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const i=e.toLocaleLowerCase(),s={type:i,filter:t,callback:r};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&Ut.isEqual(i.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(N.close,{},e)}_onError(e){this._on(N.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=$.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=cr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=cr(e.columns,e.old_record)),t}}const fr=()=>{},Ai=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class xi{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=yi,this.params={},this.timeout=zr,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=fr,this.ref=0,this.logger=fr,this.conn=null,this.sendBuffer=[],this.serializer=new _i,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...l)=>Oe(async()=>{const{default:a}=await Promise.resolve().then(()=>ve);return{default:a}},void 0).then(({default:a})=>a(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${Et.websocket}`,this.httpEndpoint=Jr(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(s,o)=>o(JSON.stringify(s)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Hr(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=St),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new Ii(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:wi}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels=this.channels.filter(r=>r._joinRef!==e._joinRef),this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case he.connecting:return ie.Connecting;case he.open:return ie.Open;case he.closing:return ie.Closing;default:return ie.Closed}}isConnected(){return this.connectionState()===ie.Open}channel(e,t={config:{}}){const r=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===r);if(i)return i;{const s=new Ut(`realtime:${e}`,t,this);return this.channels.push(s),s}}push(e){const{topic:t,event:r,payload:i,ref:s}=e,o=()=>{this.encode(e,l=>{var a;(a=this.conn)===null||a===void 0||a.send(l)})};this.log("push",`${t} ${r} (${s})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{t&&r.updateJoinPayload({access_token:t,version:this.headers&&this.headers["X-Client-Info"]}),r.joinedOnce&&r._isJoined()&&r._push(N.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(bi,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:i,payload:s,ref:o}=t;r==="phoenix"&&i==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${i} ${o&&"("+o+")"||""}`,s),Array.from(this.channels).filter(l=>l._isMember(r)).forEach(l=>l._trigger(i,s,o)),this.stateChangeCallbacks.message.forEach(l=>l(t))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(N.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${r}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([Ai],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class Ii{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=he.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class Nt extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function O(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Oi extends Nt{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Pt extends Nt{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Ri=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};const Kr=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Oe(async()=>{const{default:r}=await Promise.resolve().then(()=>ve);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},ji=()=>Ri(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Oe(()=>Promise.resolve().then(()=>ve),void 0)).Response:Response}),Ct=n=>{if(Array.isArray(n))return n.map(t=>Ct(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const i=t.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=Ct(r)}),e};var se=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};const ut=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),$i=(n,e,t)=>se(void 0,void 0,void 0,function*(){const r=yield ji();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(i=>{e(new Oi(ut(i),n.status||500))}).catch(i=>{e(new Pt(ut(i),i))}):e(new Pt(ut(n),n))}),Li=(n,e,t,r)=>{const i={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(i.body=JSON.stringify(r)),Object.assign(Object.assign({},i),t))};function je(n,e,t,r,i,s){return se(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,Li(e,r,i,s)).then(a=>{if(!a.ok)throw a;return r!=null&&r.noResolveJson?a:a.json()}).then(a=>o(a)).catch(a=>$i(a,l,r))})})}function qe(n,e,t,r){return se(this,void 0,void 0,function*(){return je(n,"GET",e,t,r)})}function Q(n,e,t,r,i){return se(this,void 0,void 0,function*(){return je(n,"POST",e,r,i,t)})}function Bi(n,e,t,r,i){return se(this,void 0,void 0,function*(){return je(n,"PUT",e,r,i,t)})}function Mi(n,e,t,r){return se(this,void 0,void 0,function*(){return je(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function Gr(n,e,t,r,i){return se(this,void 0,void 0,function*(){return je(n,"DELETE",e,r,i,t)})}var L=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};const Di={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},gr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ui{constructor(e,t={},r,i){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Kr(i)}uploadOrUpdate(e,t,r,i){return L(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},gr),i);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const a=o.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),a&&s.append("metadata",this.encodeMetadata(a)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",o.cacheControl),a&&s.append("metadata",this.encodeMetadata(a))):(s=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,a&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const u=this._removeEmptyFolders(t),c=this._getFinalPath(u),h=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:s,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),d=yield h.json();return h.ok?{data:{path:u,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(s){if(O(s))return{data:null,error:s};throw s}})}upload(e,t,r){return L(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,i){return L(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let a;const u=Object.assign({upsert:gr.upsert},i),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",u.cacheControl),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",u.cacheControl)):(a=r,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:a,headers:c}),d=yield h.json();return h.ok?{data:{path:s,fullPath:d.Key},error:null}:{data:null,error:d}}catch(a){if(O(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e,t){return L(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const s=yield Q(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),o=new URL(this.url+s.url),l=o.searchParams.get("token");if(!l)throw new Nt("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(O(r))return{data:null,error:r};throw r}})}update(e,t,r){return L(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return L(this,void 0,void 0,function*(){try{return{data:yield Q(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(O(i))return{data:null,error:i};throw i}})}copy(e,t,r){return L(this,void 0,void 0,function*(){try{return{data:{path:(yield Q(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(O(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,r){return L(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield Q(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(i){if(O(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,r){return L(this,void 0,void 0,function*(){try{const i=yield Q(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(i){if(O(i))return{data:null,error:i};throw i}})}download(e,t){return L(this,void 0,void 0,function*(){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=s?`?${s}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield qe(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(O(l))return{data:null,error:l};throw l}})}info(e){return L(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield qe(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Ct(r),error:null}}catch(r){if(O(r))return{data:null,error:r};throw r}})}exists(e){return L(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Mi(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(O(r)&&r instanceof Pt){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),i=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&i.push(s);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});a!==""&&i.push(a);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}remove(e){return L(this,void 0,void 0,function*(){try{return{data:yield Gr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(O(t))return{data:null,error:t};throw t}})}list(e,t,r){return L(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Di),t),{prefix:e||""});return{data:yield Q(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(O(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Ni="2.7.1",Fi={"X-Client-Info":`storage-js/${Ni}`};var ae=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};class qi{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},Fi),t),this.fetch=Kr(r)}listBuckets(){return ae(this,void 0,void 0,function*(){try{return{data:yield qe(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(O(e))return{data:null,error:e};throw e}})}getBucket(e){return ae(this,void 0,void 0,function*(){try{return{data:yield qe(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(O(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return ae(this,void 0,void 0,function*(){try{return{data:yield Q(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(O(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return ae(this,void 0,void 0,function*(){try{return{data:yield Bi(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(O(r))return{data:null,error:r};throw r}})}emptyBucket(e){return ae(this,void 0,void 0,function*(){try{return{data:yield Q(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(O(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ae(this,void 0,void 0,function*(){try{return{data:yield Gr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(O(t))return{data:null,error:t};throw t}})}}class zi extends qi{constructor(e,t={},r){super(e,t,r)}from(e){return new Ui(this.url,this.headers,e,this.fetch)}}const Hi="2.49.9";let Se="";typeof Deno<"u"?Se="deno":typeof document<"u"?Se="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Se="react-native":Se="node";const Vi={"X-Client-Info":`supabase-js-${Se}/${Hi}`},Ji={headers:Vi},Ki={schema:"public"},Gi={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Wi={};var Yi=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};const Qi=n=>{let e;return n?e=n:typeof fetch>"u"?e=Rr:e=fetch,(...t)=>e(...t)},Zi=()=>typeof Headers>"u"?jr:Headers,Xi=(n,e,t)=>{const r=Qi(t),i=Zi();return(s,o)=>Yi(void 0,void 0,void 0,function*(){var l;const a=(l=yield e())!==null&&l!==void 0?l:n;let u=new i(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",n),u.has("Authorization")||u.set("Authorization",`Bearer ${a}`),r(s,Object.assign(Object.assign({},o),{headers:u}))})};var es=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};function ts(n){return n.endsWith("/")?n:n+"/"}function rs(n,e){var t,r;const{db:i,auth:s,realtime:o,global:l}=n,{db:a,auth:u,realtime:c,global:h}=e,d={db:Object.assign(Object.assign({},a),i),auth:Object.assign(Object.assign({},u),s),realtime:Object.assign(Object.assign({},c),o),global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>es(this,void 0,void 0,function*(){return""})};return n.accessToken?d.accessToken=n.accessToken:delete d.accessToken,d}const Wr="2.69.1",ue=30*1e3,At=3,ht=At*ue,ns="http://localhost:9999",is="supabase.auth.token",ss={"X-Client-Info":`gotrue-js/${Wr}`},xt="X-Supabase-Api-Version",Yr={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},os=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,as=6e5;class Ft extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function E(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class ls extends Ft{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function cs(n){return E(n)&&n.name==="AuthApiError"}class Qr extends Ft{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ee extends Ft{constructor(e,t,r,i){super(e,r,i),this.name=t,this.status=r}}class W extends ee{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function us(n){return E(n)&&n.name==="AuthSessionMissingError"}class dt extends ee{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Be extends ee{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Me extends ee{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function hs(n){return E(n)&&n.name==="AuthImplicitGrantRedirectError"}class pr extends ee{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class It extends ee{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ft(n){return E(n)&&n.name==="AuthRetryableFetchError"}class mr extends ee{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class Te extends ee{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const vr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),yr=` 	
\r=`.split(""),ds=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<yr.length;e+=1)n[yr[e].charCodeAt(0)]=-2;for(let e=0;e<vr.length;e+=1)n[vr[e].charCodeAt(0)]=e;return n})();function Zr(n,e,t){const r=ds[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function wr(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=o=>{ps(o,r,t)};for(let o=0;o<n.length;o+=1)Zr(n.charCodeAt(o),i,s);return e.join("")}function fs(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function gs(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const i=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}fs(r,e)}}function ps(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if(!(n>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function ms(n){const e=[],t={queue:0,queuedBits:0},r=i=>{e.push(i)};for(let i=0;i<n.length;i+=1)Zr(n.charCodeAt(i),t,r);return new Uint8Array(e)}function vs(n){const e=[];return gs(n,t=>e.push(t)),new Uint8Array(e)}function ys(n){return Math.round(Date.now()/1e3)+n}function ws(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const q=()=>typeof window<"u"&&typeof document<"u",re={tested:!1,writable:!1},Pe=()=>{if(!q())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(re.tested)return re.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),re.tested=!0,re.writable=!0}catch{re.tested=!0,re.writable=!1}return re.writable};function bs(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return t.searchParams.forEach((r,i)=>{e[i]=r}),e}const Xr=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Oe(async()=>{const{default:r}=await Promise.resolve().then(()=>ve);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},_s=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",en=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},De=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ue=async(n,e)=>{await n.removeItem(e)};class Ze{constructor(){this.promise=new Ze.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Ze.promiseConstructor=Promise;function gt(n){const e=n.split(".");if(e.length!==3)throw new Te("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!os.test(e[r]))throw new Te("JWT not in base64url format");return{header:JSON.parse(wr(e[0])),payload:JSON.parse(wr(e[1])),signature:ms(e[2]),raw:{header:e[0],payload:e[1]}}}async function ks(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Ss(n,e){return new Promise((r,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await n(s);if(!e(s,null,o)){r(o);return}}catch(o){if(!e(s,o)){i(o);return}}})()})}function Es(n){return("0"+n.toString(16)).substr(-2)}function Ts(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let i="";for(let s=0;s<56;s++)i+=t.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,Es).join("")}async function Ps(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(r);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function Cs(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Ps(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function le(n,e,t=!1){const r=Ts();let i=r;t&&(i+="/PASSWORD_RECOVERY"),await en(n,`${e}-code-verifier`,i);const s=await Cs(r);return[s,r===s?"plain":"s256"]}const As=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function xs(n){const e=n.headers.get(xt);if(!e||!e.match(As))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Is(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function Os(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var Rs=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const ne=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),js=[502,503,504];async function br(n){var e;if(!_s(n))throw new It(ne(n),0);if(js.includes(n.status))throw new It(ne(n),n.status);let t;try{t=await n.json()}catch(s){throw new Qr(ne(s),s)}let r;const i=xs(n);if(i&&i.getTime()>=Yr["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new mr(ne(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new W}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new mr(ne(t),n.status,t.weak_password.reasons);throw new ls(ne(t),n.status||500,r)}const $s=(n,e,t,r)=>{const i={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),t))};async function T(n,e,t,r){var i;const s=Object.assign({},r==null?void 0:r.headers);s[xt]||(s[xt]=Yr["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const o=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",a=await Ls(n,e,t+l,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(a):{data:Object.assign({},a),error:null}}async function Ls(n,e,t,r,i,s){const o=$s(e,r,i,s);let l;try{l=await n(t,Object.assign({},o))}catch(a){throw console.error(a),new It(ne(a),0)}if(l.ok||await br(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(a){await br(a)}}function Y(n){var e;let t=null;Us(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=ys(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function _r(n){const e=Y(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Z(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Bs(n){return{data:n,error:null}}function Ms(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:i,verification_type:s}=n,o=Rs(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:r,redirect_to:i,verification_type:s},a=Object.assign({},o);return{data:{properties:l,user:a},error:null}}function Ds(n){return n}function Us(n){return n.access_token&&n.refresh_token&&n.expires_in}var Ns=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};class Fs{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Xr(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await T(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(E(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await T(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Z})}catch(r){if(E(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Ns(e,["options"]),i=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await T(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Ms,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(E(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await T(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Z})}catch(t){if(E(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,i,s,o,l,a;try{const u={nextPage:null,lastPage:0,total:0},c=await T(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Ds});if(c.error)throw c.error;const h=await c.json(),d=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(a=(l=c.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return f.length>0&&(f.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(g.split(";")[1].split("=")[1]);u[`${b}Page`]=p}),u.total=parseInt(d)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(E(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await T(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Z})}catch(t){if(E(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await T(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Z})}catch(r){if(E(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await T(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Z})}catch(r){if(E(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await T(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:r}}catch(t){if(E(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await T(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(E(t))return{data:null,error:t};throw t}}}const qs={getItem:n=>Pe()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{Pe()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{Pe()&&globalThis.localStorage.removeItem(n)}};function kr(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function zs(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ce={debug:!!(globalThis&&Pe()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class tn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Hs extends tn{}async function Vs(n,e,t){ce.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),ce.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){ce.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,i.name);try{return await t()}finally{ce.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,i.name)}}else{if(e===0)throw ce.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Hs(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(ce.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}zs();const Js={url:ns,storageKey:is,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ss,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Sr(n,e,t){return await t()}class xe{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=xe.nextInstanceID,xe.nextInstanceID+=1,this.instanceID>0&&q()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Js),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Fs({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Xr(i.fetch),this.lock=i.lock||Sr,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:q()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Vs:this.lock=Sr,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:Pe()?this.storage=qs:(this.memoryStorage={},this.storage=kr(this.memoryStorage)):(this.memoryStorage={},this.storage=kr(this.memoryStorage)),q()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Wr}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=bs(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),q()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:s}=await this._getSessionFromURL(t,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),hs(s)){const a=(e=s.details)===null||e===void 0?void 0:e.code;if(a==="identity_already_exists"||a==="identity_not_found"||a==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return E(t)?{error:t}:{error:new Qr("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,i;try{const s=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Y}),{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(E(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var t,r,i;try{let s;if("email"in e){const{email:c,password:h,options:d}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await le(this.storage,this.storageKey)),s=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:c,password:h,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:g},xform:Y})}else if("phone"in e){const{phone:c,password:h,options:d}=e;s=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},channel:(i=d==null?void 0:d.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Y})}else throw new Be("You must provide either an email or phone number and a password");const{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(E(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:o,options:l}=e;t=await T(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:_r})}else if("phone"in e){const{phone:s,password:o,options:l}=e;t=await T(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:_r})}else throw new Be("You must provide either an email or phone number and a password");const{data:r,error:i}=t;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new dt}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(t){if(E(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await De(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(t??"").split("/");try{const{data:s,error:o}=await T(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Y});if(await Ue(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new dt}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:o})}catch(s){if(E(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:t,provider:r,token:i,access_token:s,nonce:o}=e,l=await T(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Y}),{data:a,error:u}=l;return u?{data:{user:null,session:null},error:u}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new dt}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:u})}catch(t){if(E(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,i,s,o;try{if("email"in e){const{email:l,options:a}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await le(this.storage,this.storageKey));const{error:h}=await T(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=a==null?void 0:a.data)!==null&&t!==void 0?t:{},create_user:(r=a==null?void 0:a.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:a}=e,{data:u,error:c}=await T(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=a==null?void 0:a.data)!==null&&i!==void 0?i:{},create_user:(s=a==null?void 0:a.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(o=a==null?void 0:a.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new Be("You must provide either an email or phone number.")}catch(l){if(E(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,r;try{let i,s;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await T(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Y});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const a=o.session,u=o.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(i){if(E(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,r,i;try{let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await le(this.storage,this.storageKey)),await T(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:Bs})}catch(s){if(E(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new W;const{error:i}=await T(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(E(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:s}=e,{error:o}=await T(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:i,options:s}=e,{data:o,error:l}=await T(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Be("You must provide either an email or phone number and a type")}catch(t){if(E(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await De(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<ht:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(a,u,c)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(a,u,c))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await T(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Z}):await this._useSession(async t=>{var r,i,s;const{data:o,error:l}=t;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new W}:await T(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:Z})})}catch(t){if(E(t))return us(t)&&(await this._removeSession(),await Ue(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:i,error:s}=r;if(s)throw s;if(!i.session)throw new W;const o=i.session;let l=null,a=null;this.flowType==="pkce"&&e.email!=null&&([l,a]=await le(this.storage,this.storageKey));const{data:u,error:c}=await T(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:a}),jwt:o.access_token,xform:Z});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(E(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new W;const t=Date.now()/1e3;let r=t,i=!0,s=null;const{payload:o}=gt(e.access_token);if(o.exp&&(r=o.exp,i=r<=t),i){const{session:l,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return{data:{user:null,session:null},error:a};if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:a}=await this._getUser(e.access_token);if(a)throw a;s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(t){if(E(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new W;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(E(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!q())throw new Me("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Me(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new pr("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Me("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new pr("No code detected.");const{data:v,error:m}=await this._exchangeCodeForSession(e.code);if(m)throw m;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:s,refresh_token:o,expires_in:l,expires_at:a,token_type:u}=e;if(!s||!l||!o||!u)throw new Me("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(l);let d=c+h;a&&(d=parseInt(a));const f=d-c;f*1e3<=ue&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const g=d-h;c-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,d,c):c-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,d,c);const{data:p,error:b}=await this._getUser(s);if(b)throw b;const y={provider_token:r,provider_refresh_token:i,access_token:s,expires_in:h,expires_at:d,refresh_token:o,token_type:u,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(r){if(E(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await De(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:i,error:s}=t;if(s)return{error:s};const o=(r=i.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(cs(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Ue(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=ws(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,i;try{const{data:{session:s},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,t={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await le(this.storage,this.storageKey,!0));try{return await T(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(E(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(E(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:i}=await this._useSession(async s=>{var o,l,a,u,c;const{data:h,error:d}=s;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await T(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(i)throw i;return q()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(E(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,i;const{data:s,error:o}=t;if(o)throw o;return await T(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(E(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Ss(async i=>(i>0&&await ks(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await T(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Y})),(i,s)=>{const o=200*Math.pow(2,i);return s&&ft(s)&&Date.now()+o-r<ue})}catch(r){if(this._debug(t,"error",r),E(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),q()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await De(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<ht;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${ht}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:s}=await this._callRefreshToken(r.refresh_token);s&&(console.error(s),ft(s)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new W;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Ze;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new W;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={session:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(i,"error",s),E(s)){const o={session:null,error:s};return ft(s)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(a){s.push(a)}});if(await Promise.all(o),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await en(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Ue(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&q()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ue);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/ue);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ue}ms, refresh threshold is ${At} ticks`),i<=At&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof tn)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!q()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const i=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,o]=await le(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);i.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:i,error:s}=t;return s?{data:null,error:s}:await T(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(E(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,i;const{data:s,error:o}=t;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:a,error:u}=await T(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((i=a==null?void 0:a.totp)===null||i===void 0)&&i.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(t){if(E(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:i,error:s}=t;if(s)return{data:null,error:s};const{data:o,error:l}=await T(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(t){if(E(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:i,error:s}=t;return s?{data:null,error:s}:await T(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(E(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],i=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),s=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=gt(i.access_token);let l=null;o.aal&&(l=o.aal);let a=l;((r=(t=i.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(a="aal2");const c=o.amr||[];return{data:{currentLevel:l,nextLevel:a,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(o=>o.kid===e);if(r||(r=this.jwks.keys.find(o=>o.kid===e),r&&this.jwks_cached_at+as>Date.now()))return r;const{data:i,error:s}=await T(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!i.keys||i.keys.length===0)throw new Te("JWKS is empty");if(this.jwks=i,this.jwks_cached_at=Date.now(),r=i.keys.find(o=>o.kid===e),!r)throw new Te("No matching signing key found in JWKS");return r}async getClaims(e,t={keys:[]}){try{let r=e;if(!r){const{data:f,error:g}=await this.getSession();if(g||!f.session)return{data:null,error:g};r=f.session.access_token}const{header:i,payload:s,signature:o,raw:{header:l,payload:a}}=gt(r);if(Is(s.exp),!i.kid||i.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:f}=await this.getUser(r);if(f)throw f;return{data:{claims:s,header:i,signature:o},error:null}}const u=Os(i.alg),c=await this.fetchJwk(i.kid,t),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,vs(`${l}.${a}`)))throw new Te("Invalid JWT signature");return{data:{claims:s,header:i,signature:o},error:null}}catch(r){if(E(r))return{data:null,error:r};throw r}}}xe.nextInstanceID=0;const Ks=xe;class Gs extends Ks{constructor(e){super(e)}}var Ws=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};class Ys{constructor(e,t,r){var i,s,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const l=ts(e),a=new URL(l);this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const u=`sb-${a.hostname.split(".")[0]}-auth-token`,c={db:Ki,realtime:Wi,auth:Object.assign(Object.assign({},Gi),{storageKey:u}),global:Ji},h=rs(r??{},c);this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=Xi(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new mi(new URL("rest/v1",a).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new Vn(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new zi(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Ws(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,storageKey:s,flowType:o,lock:l,debug:a},u,c){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Gs({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,flowType:o,lock:l,debug:a,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new xi(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Qs=(n,e,t)=>new Ys(n,e,t),Zs="https://sssanglcqfnciyipjngx.supabase.co",Xs="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNzc2FuZ2xjcWZuY2l5aXBqbmd4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg1ODgyNjIsImV4cCI6MjA2NDE2NDI2Mn0.L97-7NcxKWpMoMxVKTeOSL7VRt-U7cq2uk3MgjF1sz0",eo=Qs(Zs,Xs),to={"metabolic-weight":"Metabolic & Weight Management","womens-health":"Women's Health Services","health-screening":"Health Screening & Monitoring",vaccinations:"Core Vaccinations","nhs-services":"NHS Clinical Services","mens-health":"Men's Health & Performance","travel-health":"Travel Health Services","gut-health":"Gut Health & Digestive Wellness"},ro={"Morning (9am-12pm)":"morning","Afternoon (12pm-5pm)":"afternoon","Evening (5pm-7pm)":"evening"};var $e={},no=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},rn={},M={};let qt;const io=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];M.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};M.getSymbolTotalCodewords=function(e){return io[e]};M.getBCHDigit=function(n){let e=0;for(;n!==0;)e++,n>>>=1;return e};M.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');qt=e};M.isKanjiModeEnabled=function(){return typeof qt<"u"};M.toSJIS=function(e){return qt(e)};var Xe={};(function(n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2};function e(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+t)}}n.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},n.from=function(r,i){if(n.isValid(r))return r;try{return e(r)}catch{return i}}})(Xe);function nn(){this.buffer=[],this.length=0}nn.prototype={get:function(n){const e=Math.floor(n/8);return(this.buffer[e]>>>7-n%8&1)===1},put:function(n,e){for(let t=0;t<e;t++)this.putBit((n>>>e-t-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),n&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var so=nn;function Le(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}Le.prototype.set=function(n,e,t,r){const i=n*this.size+e;this.data[i]=t,r&&(this.reservedBit[i]=!0)};Le.prototype.get=function(n,e){return this.data[n*this.size+e]};Le.prototype.xor=function(n,e,t){this.data[n*this.size+e]^=t};Le.prototype.isReserved=function(n,e){return this.reservedBit[n*this.size+e]};var oo=Le,sn={};(function(n){const e=M.getSymbolSize;n.getRowColCoords=function(r){if(r===1)return[];const i=Math.floor(r/7)+2,s=e(r),o=s===145?26:Math.ceil((s-13)/(2*i-2))*2,l=[s-7];for(let a=1;a<i-1;a++)l[a]=l[a-1]-o;return l.push(6),l.reverse()},n.getPositions=function(r){const i=[],s=n.getRowColCoords(r),o=s.length;for(let l=0;l<o;l++)for(let a=0;a<o;a++)l===0&&a===0||l===0&&a===o-1||l===o-1&&a===0||i.push([s[l],s[a]]);return i}})(sn);var on={};const ao=M.getSymbolSize,Er=7;on.getPositions=function(e){const t=ao(e);return[[0,0],[t-Er,0],[0,t-Er]]};var an={};(function(n){n.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};n.isValid=function(i){return i!=null&&i!==""&&!isNaN(i)&&i>=0&&i<=7},n.from=function(i){return n.isValid(i)?parseInt(i,10):void 0},n.getPenaltyN1=function(i){const s=i.size;let o=0,l=0,a=0,u=null,c=null;for(let h=0;h<s;h++){l=a=0,u=c=null;for(let d=0;d<s;d++){let f=i.get(h,d);f===u?l++:(l>=5&&(o+=e.N1+(l-5)),u=f,l=1),f=i.get(d,h),f===c?a++:(a>=5&&(o+=e.N1+(a-5)),c=f,a=1)}l>=5&&(o+=e.N1+(l-5)),a>=5&&(o+=e.N1+(a-5))}return o},n.getPenaltyN2=function(i){const s=i.size;let o=0;for(let l=0;l<s-1;l++)for(let a=0;a<s-1;a++){const u=i.get(l,a)+i.get(l,a+1)+i.get(l+1,a)+i.get(l+1,a+1);(u===4||u===0)&&o++}return o*e.N2},n.getPenaltyN3=function(i){const s=i.size;let o=0,l=0,a=0;for(let u=0;u<s;u++){l=a=0;for(let c=0;c<s;c++)l=l<<1&2047|i.get(u,c),c>=10&&(l===1488||l===93)&&o++,a=a<<1&2047|i.get(c,u),c>=10&&(a===1488||a===93)&&o++}return o*e.N3},n.getPenaltyN4=function(i){let s=0;const o=i.data.length;for(let a=0;a<o;a++)s+=i.data[a];return Math.abs(Math.ceil(s*100/o/5)-10)*e.N4};function t(r,i,s){switch(r){case n.Patterns.PATTERN000:return(i+s)%2===0;case n.Patterns.PATTERN001:return i%2===0;case n.Patterns.PATTERN010:return s%3===0;case n.Patterns.PATTERN011:return(i+s)%3===0;case n.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(s/3))%2===0;case n.Patterns.PATTERN101:return i*s%2+i*s%3===0;case n.Patterns.PATTERN110:return(i*s%2+i*s%3)%2===0;case n.Patterns.PATTERN111:return(i*s%3+(i+s)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}n.applyMask=function(i,s){const o=s.size;for(let l=0;l<o;l++)for(let a=0;a<o;a++)s.isReserved(a,l)||s.xor(a,l,t(i,a,l))},n.getBestMask=function(i,s){const o=Object.keys(n.Patterns).length;let l=0,a=1/0;for(let u=0;u<o;u++){s(u),n.applyMask(u,i);const c=n.getPenaltyN1(i)+n.getPenaltyN2(i)+n.getPenaltyN3(i)+n.getPenaltyN4(i);n.applyMask(u,i),c<a&&(a=c,l=u)}return l}})(an);var et={};const X=Xe,Ne=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Fe=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];et.getBlocksCount=function(e,t){switch(t){case X.L:return Ne[(e-1)*4+0];case X.M:return Ne[(e-1)*4+1];case X.Q:return Ne[(e-1)*4+2];case X.H:return Ne[(e-1)*4+3];default:return}};et.getTotalCodewordsCount=function(e,t){switch(t){case X.L:return Fe[(e-1)*4+0];case X.M:return Fe[(e-1)*4+1];case X.Q:return Fe[(e-1)*4+2];case X.H:return Fe[(e-1)*4+3];default:return}};var ln={},tt={};const Ce=new Uint8Array(512),ze=new Uint8Array(256);(function(){let e=1;for(let t=0;t<255;t++)Ce[t]=e,ze[e]=t,e<<=1,e&256&&(e^=285);for(let t=255;t<512;t++)Ce[t]=Ce[t-255]})();tt.log=function(e){if(e<1)throw new Error("log("+e+")");return ze[e]};tt.exp=function(e){return Ce[e]};tt.mul=function(e,t){return e===0||t===0?0:Ce[ze[e]+ze[t]]};(function(n){const e=tt;n.mul=function(r,i){const s=new Uint8Array(r.length+i.length-1);for(let o=0;o<r.length;o++)for(let l=0;l<i.length;l++)s[o+l]^=e.mul(r[o],i[l]);return s},n.mod=function(r,i){let s=new Uint8Array(r);for(;s.length-i.length>=0;){const o=s[0];for(let a=0;a<i.length;a++)s[a]^=e.mul(i[a],o);let l=0;for(;l<s.length&&s[l]===0;)l++;s=s.slice(l)}return s},n.generateECPolynomial=function(r){let i=new Uint8Array([1]);for(let s=0;s<r;s++)i=n.mul(i,new Uint8Array([1,e.exp(s)]));return i}})(ln);const cn=ln;function zt(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}zt.prototype.initialize=function(e){this.degree=e,this.genPoly=cn.generateECPolynomial(this.degree)};zt.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const r=cn.mod(t,this.genPoly),i=this.degree-r.length;if(i>0){const s=new Uint8Array(this.degree);return s.set(r,i),s}return r};var lo=zt,un={},te={},Ht={};Ht.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var V={};const hn="[0-9]+",co="[A-Z $%*+\\-./:]+";let Ie="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Ie=Ie.replace(/u/g,"\\u");const uo="(?:(?![A-Z0-9 $%*+\\-./:]|"+Ie+`)(?:.|[\r
]))+`;V.KANJI=new RegExp(Ie,"g");V.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");V.BYTE=new RegExp(uo,"g");V.NUMERIC=new RegExp(hn,"g");V.ALPHANUMERIC=new RegExp(co,"g");const ho=new RegExp("^"+Ie+"$"),fo=new RegExp("^"+hn+"$"),go=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");V.testKanji=function(e){return ho.test(e)};V.testNumeric=function(e){return fo.test(e)};V.testAlphanumeric=function(e){return go.test(e)};(function(n){const e=Ht,t=V;n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(s,o){if(!s.ccBits)throw new Error("Invalid mode: "+s);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?s.ccBits[0]:o<27?s.ccBits[1]:s.ccBits[2]},n.getBestModeForData=function(s){return t.testNumeric(s)?n.NUMERIC:t.testAlphanumeric(s)?n.ALPHANUMERIC:t.testKanji(s)?n.KANJI:n.BYTE},n.toString=function(s){if(s&&s.id)return s.id;throw new Error("Invalid mode")},n.isValid=function(s){return s&&s.bit&&s.ccBits};function r(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+i)}}n.from=function(s,o){if(n.isValid(s))return s;try{return r(s)}catch{return o}}})(te);(function(n){const e=M,t=et,r=Xe,i=te,s=Ht,o=7973,l=e.getBCHDigit(o);function a(d,f,g){for(let p=1;p<=40;p++)if(f<=n.getCapacity(p,g,d))return p}function u(d,f){return i.getCharCountIndicator(d,f)+4}function c(d,f){let g=0;return d.forEach(function(p){const b=u(p.mode,f);g+=b+p.getBitsLength()}),g}function h(d,f){for(let g=1;g<=40;g++)if(c(d,g)<=n.getCapacity(g,f,i.MIXED))return g}n.from=function(f,g){return s.isValid(f)?parseInt(f,10):g},n.getCapacity=function(f,g,p){if(!s.isValid(f))throw new Error("Invalid QR Code version");typeof p>"u"&&(p=i.BYTE);const b=e.getSymbolTotalCodewords(f),y=t.getTotalCodewordsCount(f,g),v=(b-y)*8;if(p===i.MIXED)return v;const m=v-u(p,f);switch(p){case i.NUMERIC:return Math.floor(m/10*3);case i.ALPHANUMERIC:return Math.floor(m/11*2);case i.KANJI:return Math.floor(m/13);case i.BYTE:default:return Math.floor(m/8)}},n.getBestVersionForData=function(f,g){let p;const b=r.from(g,r.M);if(Array.isArray(f)){if(f.length>1)return h(f,b);if(f.length===0)return 1;p=f[0]}else p=f;return a(p.mode,p.getLength(),b)},n.getEncodedBits=function(f){if(!s.isValid(f)||f<7)throw new Error("Invalid QR Code version");let g=f<<12;for(;e.getBCHDigit(g)-l>=0;)g^=o<<e.getBCHDigit(g)-l;return f<<12|g}})(un);var dn={};const Ot=M,fn=1335,po=21522,Tr=Ot.getBCHDigit(fn);dn.getEncodedBits=function(e,t){const r=e.bit<<3|t;let i=r<<10;for(;Ot.getBCHDigit(i)-Tr>=0;)i^=fn<<Ot.getBCHDigit(i)-Tr;return(r<<10|i)^po};var gn={};const mo=te;function fe(n){this.mode=mo.NUMERIC,this.data=n.toString()}fe.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};fe.prototype.getLength=function(){return this.data.length};fe.prototype.getBitsLength=function(){return fe.getBitsLength(this.data.length)};fe.prototype.write=function(e){let t,r,i;for(t=0;t+3<=this.data.length;t+=3)r=this.data.substr(t,3),i=parseInt(r,10),e.put(i,10);const s=this.data.length-t;s>0&&(r=this.data.substr(t),i=parseInt(r,10),e.put(i,s*3+1))};var vo=fe;const yo=te,pt=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function ge(n){this.mode=yo.ALPHANUMERIC,this.data=n}ge.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};ge.prototype.getLength=function(){return this.data.length};ge.prototype.getBitsLength=function(){return ge.getBitsLength(this.data.length)};ge.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let r=pt.indexOf(this.data[t])*45;r+=pt.indexOf(this.data[t+1]),e.put(r,11)}this.data.length%2&&e.put(pt.indexOf(this.data[t]),6)};var wo=ge;const bo=te;function pe(n){this.mode=bo.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}pe.getBitsLength=function(e){return e*8};pe.prototype.getLength=function(){return this.data.length};pe.prototype.getBitsLength=function(){return pe.getBitsLength(this.data.length)};pe.prototype.write=function(n){for(let e=0,t=this.data.length;e<t;e++)n.put(this.data[e],8)};var _o=pe;const ko=te,So=M;function me(n){this.mode=ko.KANJI,this.data=n}me.getBitsLength=function(e){return e*13};me.prototype.getLength=function(){return this.data.length};me.prototype.getBitsLength=function(){return me.getBitsLength(this.data.length)};me.prototype.write=function(n){let e;for(e=0;e<this.data.length;e++){let t=So.toSJIS(this.data[e]);if(t>=33088&&t<=40956)t-=33088;else if(t>=57408&&t<=60351)t-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);t=(t>>>8&255)*192+(t&255),n.put(t,13)}};var Eo=me,pn={exports:{}};(function(n){var e={single_source_shortest_paths:function(t,r,i){var s={},o={};o[r]=0;var l=e.PriorityQueue.make();l.push(r,0);for(var a,u,c,h,d,f,g,p,b;!l.empty();){a=l.pop(),u=a.value,h=a.cost,d=t[u]||{};for(c in d)d.hasOwnProperty(c)&&(f=d[c],g=h+f,p=o[c],b=typeof o[c]>"u",(b||p>g)&&(o[c]=g,l.push(c,g),s[c]=u))}if(typeof i<"u"&&typeof o[i]>"u"){var y=["Could not find a path from ",r," to ",i,"."].join("");throw new Error(y)}return s},extract_shortest_path_from_predecessor_list:function(t,r){for(var i=[],s=r;s;)i.push(s),t[s],s=t[s];return i.reverse(),i},find_path:function(t,r,i){var s=e.single_source_shortest_paths(t,r,i);return e.extract_shortest_path_from_predecessor_list(s,i)},PriorityQueue:{make:function(t){var r=e.PriorityQueue,i={},s;t=t||{};for(s in r)r.hasOwnProperty(s)&&(i[s]=r[s]);return i.queue=[],i.sorter=t.sorter||r.default_sorter,i},default_sorter:function(t,r){return t.cost-r.cost},push:function(t,r){var i={value:t,cost:r};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};n.exports=e})(pn);var To=pn.exports;(function(n){const e=te,t=vo,r=wo,i=_o,s=Eo,o=V,l=M,a=To;function u(y){return unescape(encodeURIComponent(y)).length}function c(y,v,m){const w=[];let k;for(;(k=y.exec(m))!==null;)w.push({data:k[0],index:k.index,mode:v,length:k[0].length});return w}function h(y){const v=c(o.NUMERIC,e.NUMERIC,y),m=c(o.ALPHANUMERIC,e.ALPHANUMERIC,y);let w,k;return l.isKanjiModeEnabled()?(w=c(o.BYTE,e.BYTE,y),k=c(o.KANJI,e.KANJI,y)):(w=c(o.BYTE_KANJI,e.BYTE,y),k=[]),v.concat(m,w,k).sort(function(C,R){return C.index-R.index}).map(function(C){return{data:C.data,mode:C.mode,length:C.length}})}function d(y,v){switch(v){case e.NUMERIC:return t.getBitsLength(y);case e.ALPHANUMERIC:return r.getBitsLength(y);case e.KANJI:return s.getBitsLength(y);case e.BYTE:return i.getBitsLength(y)}}function f(y){return y.reduce(function(v,m){const w=v.length-1>=0?v[v.length-1]:null;return w&&w.mode===m.mode?(v[v.length-1].data+=m.data,v):(v.push(m),v)},[])}function g(y){const v=[];for(let m=0;m<y.length;m++){const w=y[m];switch(w.mode){case e.NUMERIC:v.push([w,{data:w.data,mode:e.ALPHANUMERIC,length:w.length},{data:w.data,mode:e.BYTE,length:w.length}]);break;case e.ALPHANUMERIC:v.push([w,{data:w.data,mode:e.BYTE,length:w.length}]);break;case e.KANJI:v.push([w,{data:w.data,mode:e.BYTE,length:u(w.data)}]);break;case e.BYTE:v.push([{data:w.data,mode:e.BYTE,length:u(w.data)}])}}return v}function p(y,v){const m={},w={start:{}};let k=["start"];for(let S=0;S<y.length;S++){const C=y[S],R=[];for(let j=0;j<C.length;j++){const P=C[j],D=""+S+j;R.push(D),m[D]={node:P,lastCount:0},w[D]={};for(let G=0;G<k.length;G++){const I=k[G];m[I]&&m[I].node.mode===P.mode?(w[I][D]=d(m[I].lastCount+P.length,P.mode)-d(m[I].lastCount,P.mode),m[I].lastCount+=P.length):(m[I]&&(m[I].lastCount=P.length),w[I][D]=d(P.length,P.mode)+4+e.getCharCountIndicator(P.mode,v))}}k=R}for(let S=0;S<k.length;S++)w[k[S]].end=0;return{map:w,table:m}}function b(y,v){let m;const w=e.getBestModeForData(y);if(m=e.from(v,w),m!==e.BYTE&&m.bit<w.bit)throw new Error('"'+y+'" cannot be encoded with mode '+e.toString(m)+`.
 Suggested mode is: `+e.toString(w));switch(m===e.KANJI&&!l.isKanjiModeEnabled()&&(m=e.BYTE),m){case e.NUMERIC:return new t(y);case e.ALPHANUMERIC:return new r(y);case e.KANJI:return new s(y);case e.BYTE:return new i(y)}}n.fromArray=function(v){return v.reduce(function(m,w){return typeof w=="string"?m.push(b(w,null)):w.data&&m.push(b(w.data,w.mode)),m},[])},n.fromString=function(v,m){const w=h(v,l.isKanjiModeEnabled()),k=g(w),S=p(k,m),C=a.find_path(S.map,"start","end"),R=[];for(let j=1;j<C.length-1;j++)R.push(S.table[C[j]].node);return n.fromArray(f(R))},n.rawSplit=function(v){return n.fromArray(h(v,l.isKanjiModeEnabled()))}})(gn);const rt=M,mt=Xe,Po=so,Co=oo,Ao=sn,xo=on,Rt=an,jt=et,Io=lo,He=un,Oo=dn,Ro=te,vt=gn;function jo(n,e){const t=n.size,r=xo.getPositions(e);for(let i=0;i<r.length;i++){const s=r[i][0],o=r[i][1];for(let l=-1;l<=7;l++)if(!(s+l<=-1||t<=s+l))for(let a=-1;a<=7;a++)o+a<=-1||t<=o+a||(l>=0&&l<=6&&(a===0||a===6)||a>=0&&a<=6&&(l===0||l===6)||l>=2&&l<=4&&a>=2&&a<=4?n.set(s+l,o+a,!0,!0):n.set(s+l,o+a,!1,!0))}}function $o(n){const e=n.size;for(let t=8;t<e-8;t++){const r=t%2===0;n.set(t,6,r,!0),n.set(6,t,r,!0)}}function Lo(n,e){const t=Ao.getPositions(e);for(let r=0;r<t.length;r++){const i=t[r][0],s=t[r][1];for(let o=-2;o<=2;o++)for(let l=-2;l<=2;l++)o===-2||o===2||l===-2||l===2||o===0&&l===0?n.set(i+o,s+l,!0,!0):n.set(i+o,s+l,!1,!0)}}function Bo(n,e){const t=n.size,r=He.getEncodedBits(e);let i,s,o;for(let l=0;l<18;l++)i=Math.floor(l/3),s=l%3+t-8-3,o=(r>>l&1)===1,n.set(i,s,o,!0),n.set(s,i,o,!0)}function yt(n,e,t){const r=n.size,i=Oo.getEncodedBits(e,t);let s,o;for(s=0;s<15;s++)o=(i>>s&1)===1,s<6?n.set(s,8,o,!0):s<8?n.set(s+1,8,o,!0):n.set(r-15+s,8,o,!0),s<8?n.set(8,r-s-1,o,!0):s<9?n.set(8,15-s-1+1,o,!0):n.set(8,15-s-1,o,!0);n.set(r-8,8,1,!0)}function Mo(n,e){const t=n.size;let r=-1,i=t-1,s=7,o=0;for(let l=t-1;l>0;l-=2)for(l===6&&l--;;){for(let a=0;a<2;a++)if(!n.isReserved(i,l-a)){let u=!1;o<e.length&&(u=(e[o]>>>s&1)===1),n.set(i,l-a,u),s--,s===-1&&(o++,s=7)}if(i+=r,i<0||t<=i){i-=r,r=-r;break}}}function Do(n,e,t){const r=new Po;t.forEach(function(a){r.put(a.mode.bit,4),r.put(a.getLength(),Ro.getCharCountIndicator(a.mode,n)),a.write(r)});const i=rt.getSymbolTotalCodewords(n),s=jt.getTotalCodewordsCount(n,e),o=(i-s)*8;for(r.getLengthInBits()+4<=o&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);const l=(o-r.getLengthInBits())/8;for(let a=0;a<l;a++)r.put(a%2?17:236,8);return Uo(r,n,e)}function Uo(n,e,t){const r=rt.getSymbolTotalCodewords(e),i=jt.getTotalCodewordsCount(e,t),s=r-i,o=jt.getBlocksCount(e,t),l=r%o,a=o-l,u=Math.floor(r/o),c=Math.floor(s/o),h=c+1,d=u-c,f=new Io(d);let g=0;const p=new Array(o),b=new Array(o);let y=0;const v=new Uint8Array(n.buffer);for(let C=0;C<o;C++){const R=C<a?c:h;p[C]=v.slice(g,g+R),b[C]=f.encode(p[C]),g+=R,y=Math.max(y,R)}const m=new Uint8Array(r);let w=0,k,S;for(k=0;k<y;k++)for(S=0;S<o;S++)k<p[S].length&&(m[w++]=p[S][k]);for(k=0;k<d;k++)for(S=0;S<o;S++)m[w++]=b[S][k];return m}function No(n,e,t,r){let i;if(Array.isArray(n))i=vt.fromArray(n);else if(typeof n=="string"){let u=e;if(!u){const c=vt.rawSplit(n);u=He.getBestVersionForData(c,t)}i=vt.fromString(n,u||40)}else throw new Error("Invalid data");const s=He.getBestVersionForData(i,t);if(!s)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=s;else if(e<s)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+s+`.
`);const o=Do(e,t,i),l=rt.getSymbolSize(e),a=new Co(l);return jo(a,e),$o(a),Lo(a,e),yt(a,t,0),e>=7&&Bo(a,e),Mo(a,o),isNaN(r)&&(r=Rt.getBestMask(a,yt.bind(null,a,t))),Rt.applyMask(r,a),yt(a,t,r),{modules:a,version:e,errorCorrectionLevel:t,maskPattern:r,segments:i}}rn.create=function(e,t){if(typeof e>"u"||e==="")throw new Error("No input text");let r=mt.M,i,s;return typeof t<"u"&&(r=mt.from(t.errorCorrectionLevel,mt.M),i=He.from(t.version),s=Rt.from(t.maskPattern),t.toSJISFunc&&rt.setToSJISFunction(t.toSJISFunc)),No(e,i,r,s)};var mn={},Vt={};(function(n){function e(t){if(typeof t=="number"&&(t=t.toString()),typeof t!="string")throw new Error("Color should be defined as hex string");let r=t.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+t);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(s){return[s,s]}))),r.length===6&&r.push("F","F");const i=parseInt(r.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:i&255,hex:"#"+r.slice(0,6).join("")}}n.getOptions=function(r){r||(r={}),r.color||(r.color={});const i=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,s=r.width&&r.width>=21?r.width:void 0,o=r.scale||4;return{width:s,scale:s?4:o,margin:i,color:{dark:e(r.color.dark||"#000000ff"),light:e(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},n.getScale=function(r,i){return i.width&&i.width>=r+i.margin*2?i.width/(r+i.margin*2):i.scale},n.getImageWidth=function(r,i){const s=n.getScale(r,i);return Math.floor((r+i.margin*2)*s)},n.qrToImageData=function(r,i,s){const o=i.modules.size,l=i.modules.data,a=n.getScale(o,s),u=Math.floor((o+s.margin*2)*a),c=s.margin*a,h=[s.color.light,s.color.dark];for(let d=0;d<u;d++)for(let f=0;f<u;f++){let g=(d*u+f)*4,p=s.color.light;if(d>=c&&f>=c&&d<u-c&&f<u-c){const b=Math.floor((d-c)/a),y=Math.floor((f-c)/a);p=h[l[b*o+y]?1:0]}r[g++]=p.r,r[g++]=p.g,r[g++]=p.b,r[g]=p.a}}})(Vt);(function(n){const e=Vt;function t(i,s,o){i.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=o,s.width=o,s.style.height=o+"px",s.style.width=o+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}n.render=function(s,o,l){let a=l,u=o;typeof a>"u"&&(!o||!o.getContext)&&(a=o,o=void 0),o||(u=r()),a=e.getOptions(a);const c=e.getImageWidth(s.modules.size,a),h=u.getContext("2d"),d=h.createImageData(c,c);return e.qrToImageData(d.data,s,a),t(h,u,c),h.putImageData(d,0,0),u},n.renderToDataURL=function(s,o,l){let a=l;typeof a>"u"&&(!o||!o.getContext)&&(a=o,o=void 0),a||(a={});const u=n.render(s,o,a),c=a.type||"image/png",h=a.rendererOpts||{};return u.toDataURL(c,h.quality)}})(mn);var vn={};const Fo=Vt;function Pr(n,e){const t=n.a/255,r=e+'="'+n.hex+'"';return t<1?r+" "+e+'-opacity="'+t.toFixed(2).slice(1)+'"':r}function wt(n,e,t){let r=n+e;return typeof t<"u"&&(r+=" "+t),r}function qo(n,e,t){let r="",i=0,s=!1,o=0;for(let l=0;l<n.length;l++){const a=Math.floor(l%e),u=Math.floor(l/e);!a&&!s&&(s=!0),n[l]?(o++,l>0&&a>0&&n[l-1]||(r+=s?wt("M",a+t,.5+u+t):wt("m",i,0),i=0,s=!1),a+1<e&&n[l+1]||(r+=wt("h",o),o=0)):i++}return r}vn.render=function(e,t,r){const i=Fo.getOptions(t),s=e.modules.size,o=e.modules.data,l=s+i.margin*2,a=i.color.light.a?"<path "+Pr(i.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",u="<path "+Pr(i.color.dark,"stroke")+' d="'+qo(o,s,i.margin)+'"/>',c='viewBox="0 0 '+l+" "+l+'"',d='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+c+' shape-rendering="crispEdges">'+a+u+`</svg>
`;return typeof r=="function"&&r(null,d),d};const zo=no,$t=rn,yn=mn,Ho=vn;function Jt(n,e,t,r,i){const s=[].slice.call(arguments,1),o=s.length,l=typeof s[o-1]=="function";if(!l&&!zo())throw new Error("Callback required as last argument");if(l){if(o<2)throw new Error("Too few arguments provided");o===2?(i=t,t=e,e=r=void 0):o===3&&(e.getContext&&typeof i>"u"?(i=r,r=void 0):(i=r,r=t,t=e,e=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(t=e,e=r=void 0):o===2&&!e.getContext&&(r=t,t=e,e=void 0),new Promise(function(a,u){try{const c=$t.create(t,r);a(n(c,e,r))}catch(c){u(c)}})}try{const a=$t.create(t,r);i(null,n(a,e,r))}catch(a){i(a)}}$e.create=$t.create;$e.toCanvas=Jt.bind(null,yn.render);$e.toDataURL=Jt.bind(null,yn.renderToDataURL);$e.toString=Jt.bind(null,function(n,e,t){return Ho.render(n,t)});var wn={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},Kt={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},Vo=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],Ve={CSS:{},springs:{}};function z(n,e,t){return Math.min(Math.max(n,e),t)}function Ae(n,e){return n.indexOf(e)>-1}function bt(n,e){return n.apply(null,e)}var _={arr:function(n){return Array.isArray(n)},obj:function(n){return Ae(Object.prototype.toString.call(n),"Object")},pth:function(n){return _.obj(n)&&n.hasOwnProperty("totalLength")},svg:function(n){return n instanceof SVGElement},inp:function(n){return n instanceof HTMLInputElement},dom:function(n){return n.nodeType||_.svg(n)},str:function(n){return typeof n=="string"},fnc:function(n){return typeof n=="function"},und:function(n){return typeof n>"u"},nil:function(n){return _.und(n)||n===null},hex:function(n){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(n)},rgb:function(n){return/^rgb/.test(n)},hsl:function(n){return/^hsl/.test(n)},col:function(n){return _.hex(n)||_.rgb(n)||_.hsl(n)},key:function(n){return!wn.hasOwnProperty(n)&&!Kt.hasOwnProperty(n)&&n!=="targets"&&n!=="keyframes"}};function bn(n){var e=/\(([^)]+)\)/.exec(n);return e?e[1].split(",").map(function(t){return parseFloat(t)}):[]}function _n(n,e){var t=bn(n),r=z(_.und(t[0])?1:t[0],.1,100),i=z(_.und(t[1])?100:t[1],.1,100),s=z(_.und(t[2])?10:t[2],.1,100),o=z(_.und(t[3])?0:t[3],.1,100),l=Math.sqrt(i/r),a=s/(2*Math.sqrt(i*r)),u=a<1?l*Math.sqrt(1-a*a):0,c=1,h=a<1?(a*l+-o)/u:-o+l;function d(g){var p=e?e*g/1e3:g;return a<1?p=Math.exp(-p*a*l)*(c*Math.cos(u*p)+h*Math.sin(u*p)):p=(c+h*p)*Math.exp(-p*l),g===0||g===1?g:1-p}function f(){var g=Ve.springs[n];if(g)return g;for(var p=1/6,b=0,y=0;;)if(b+=p,d(b)===1){if(y++,y>=16)break}else y=0;var v=b*p*1e3;return Ve.springs[n]=v,v}return e?d:f}function Jo(n){return n===void 0&&(n=10),function(e){return Math.ceil(z(e,1e-6,1)*n)*(1/n)}}var Ko=function(){var n=11,e=1/(n-1);function t(c,h){return 1-3*h+3*c}function r(c,h){return 3*h-6*c}function i(c){return 3*c}function s(c,h,d){return((t(h,d)*c+r(h,d))*c+i(h))*c}function o(c,h,d){return 3*t(h,d)*c*c+2*r(h,d)*c+i(h)}function l(c,h,d,f,g){var p,b,y=0;do b=h+(d-h)/2,p=s(b,f,g)-c,p>0?d=b:h=b;while(Math.abs(p)>1e-7&&++y<10);return b}function a(c,h,d,f){for(var g=0;g<4;++g){var p=o(h,d,f);if(p===0)return h;var b=s(h,d,f)-c;h-=b/p}return h}function u(c,h,d,f){if(!(0<=c&&c<=1&&0<=d&&d<=1))return;var g=new Float32Array(n);if(c!==h||d!==f)for(var p=0;p<n;++p)g[p]=s(p*e,c,d);function b(y){for(var v=0,m=1,w=n-1;m!==w&&g[m]<=y;++m)v+=e;--m;var k=(y-g[m])/(g[m+1]-g[m]),S=v+k*e,C=o(S,c,d);return C>=.001?a(y,S,c,d):C===0?S:l(y,v,v+e,c,d)}return function(y){return c===h&&d===f||y===0||y===1?y:s(b(y),h,f)}}return u}(),kn=function(){var n={linear:function(){return function(r){return r}}},e={Sine:function(){return function(r){return 1-Math.cos(r*Math.PI/2)}},Expo:function(){return function(r){return r?Math.pow(2,10*r-10):0}},Circ:function(){return function(r){return 1-Math.sqrt(1-r*r)}},Back:function(){return function(r){return r*r*(3*r-2)}},Bounce:function(){return function(r){for(var i,s=4;r<((i=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((i*3-2)/22-r,2)}},Elastic:function(r,i){r===void 0&&(r=1),i===void 0&&(i=.5);var s=z(r,1,10),o=z(i,.1,2);return function(l){return l===0||l===1?l:-s*Math.pow(2,10*(l-1))*Math.sin((l-1-o/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/o)}}},t=["Quad","Cubic","Quart","Quint"];return t.forEach(function(r,i){e[r]=function(){return function(s){return Math.pow(s,i+2)}}}),Object.keys(e).forEach(function(r){var i=e[r];n["easeIn"+r]=i,n["easeOut"+r]=function(s,o){return function(l){return 1-i(s,o)(1-l)}},n["easeInOut"+r]=function(s,o){return function(l){return l<.5?i(s,o)(l*2)/2:1-i(s,o)(l*-2+2)/2}},n["easeOutIn"+r]=function(s,o){return function(l){return l<.5?(1-i(s,o)(1-l*2))/2:(i(s,o)(l*2-1)+1)/2}}}),n}();function Gt(n,e){if(_.fnc(n))return n;var t=n.split("(")[0],r=kn[t],i=bn(n);switch(t){case"spring":return _n(n,e);case"cubicBezier":return bt(Ko,i);case"steps":return bt(Jo,i);default:return bt(r,i)}}function Sn(n){try{var e=document.querySelectorAll(n);return e}catch{return}}function nt(n,e){for(var t=n.length,r=arguments.length>=2?arguments[1]:void 0,i=[],s=0;s<t;s++)if(s in n){var o=n[s];e.call(r,o,s,n)&&i.push(o)}return i}function it(n){return n.reduce(function(e,t){return e.concat(_.arr(t)?it(t):t)},[])}function Cr(n){return _.arr(n)?n:(_.str(n)&&(n=Sn(n)||n),n instanceof NodeList||n instanceof HTMLCollection?[].slice.call(n):[n])}function Wt(n,e){return n.some(function(t){return t===e})}function Yt(n){var e={};for(var t in n)e[t]=n[t];return e}function Lt(n,e){var t=Yt(n);for(var r in n)t[r]=e.hasOwnProperty(r)?e[r]:n[r];return t}function st(n,e){var t=Yt(n);for(var r in e)t[r]=_.und(n[r])?e[r]:n[r];return t}function Go(n){var e=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(n);return e?"rgba("+e[1]+",1)":n}function Wo(n){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,t=n.replace(e,function(l,a,u,c){return a+a+u+u+c+c}),r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),i=parseInt(r[1],16),s=parseInt(r[2],16),o=parseInt(r[3],16);return"rgba("+i+","+s+","+o+",1)"}function Yo(n){var e=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(n)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(n),t=parseInt(e[1],10)/360,r=parseInt(e[2],10)/100,i=parseInt(e[3],10)/100,s=e[4]||1;function o(d,f,g){return g<0&&(g+=1),g>1&&(g-=1),g<1/6?d+(f-d)*6*g:g<1/2?f:g<2/3?d+(f-d)*(2/3-g)*6:d}var l,a,u;if(r==0)l=a=u=i;else{var c=i<.5?i*(1+r):i+r-i*r,h=2*i-c;l=o(h,c,t+1/3),a=o(h,c,t),u=o(h,c,t-1/3)}return"rgba("+l*255+","+a*255+","+u*255+","+s+")"}function Qo(n){if(_.rgb(n))return Go(n);if(_.hex(n))return Wo(n);if(_.hsl(n))return Yo(n)}function K(n){var e=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(n);if(e)return e[1]}function Zo(n){if(Ae(n,"translate")||n==="perspective")return"px";if(Ae(n,"rotate")||Ae(n,"skew"))return"deg"}function Bt(n,e){return _.fnc(n)?n(e.target,e.id,e.total):n}function H(n,e){return n.getAttribute(e)}function Qt(n,e,t){var r=K(e);if(Wt([t,"deg","rad","turn"],r))return e;var i=Ve.CSS[e+t];if(!_.und(i))return i;var s=100,o=document.createElement(n.tagName),l=n.parentNode&&n.parentNode!==document?n.parentNode:document.body;l.appendChild(o),o.style.position="absolute",o.style.width=s+t;var a=s/o.offsetWidth;l.removeChild(o);var u=a*parseFloat(e);return Ve.CSS[e+t]=u,u}function En(n,e,t){if(e in n.style){var r=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),i=n.style[e]||getComputedStyle(n).getPropertyValue(r)||"0";return t?Qt(n,i,t):i}}function Zt(n,e){if(_.dom(n)&&!_.inp(n)&&(!_.nil(H(n,e))||_.svg(n)&&n[e]))return"attribute";if(_.dom(n)&&Wt(Vo,e))return"transform";if(_.dom(n)&&e!=="transform"&&En(n,e))return"css";if(n[e]!=null)return"object"}function Tn(n){if(_.dom(n)){for(var e=n.style.transform||"",t=/(\w+)\(([^)]*)\)/g,r=new Map,i;i=t.exec(e);)r.set(i[1],i[2]);return r}}function Xo(n,e,t,r){var i=Ae(e,"scale")?1:0+Zo(e),s=Tn(n).get(e)||i;return t&&(t.transforms.list.set(e,s),t.transforms.last=e),r?Qt(n,s,r):s}function Xt(n,e,t,r){switch(Zt(n,e)){case"transform":return Xo(n,e,r,t);case"css":return En(n,e,t);case"attribute":return H(n,e);default:return n[e]||0}}function er(n,e){var t=/^(\*=|\+=|-=)/.exec(n);if(!t)return n;var r=K(n)||0,i=parseFloat(e),s=parseFloat(n.replace(t[0],""));switch(t[0][0]){case"+":return i+s+r;case"-":return i-s+r;case"*":return i*s+r}}function Pn(n,e){if(_.col(n))return Qo(n);if(/\s/g.test(n))return n;var t=K(n),r=t?n.substr(0,n.length-t.length):n;return e?r+e:r}function tr(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function ea(n){return Math.PI*2*H(n,"r")}function ta(n){return H(n,"width")*2+H(n,"height")*2}function ra(n){return tr({x:H(n,"x1"),y:H(n,"y1")},{x:H(n,"x2"),y:H(n,"y2")})}function Cn(n){for(var e=n.points,t=0,r,i=0;i<e.numberOfItems;i++){var s=e.getItem(i);i>0&&(t+=tr(r,s)),r=s}return t}function na(n){var e=n.points;return Cn(n)+tr(e.getItem(e.numberOfItems-1),e.getItem(0))}function An(n){if(n.getTotalLength)return n.getTotalLength();switch(n.tagName.toLowerCase()){case"circle":return ea(n);case"rect":return ta(n);case"line":return ra(n);case"polyline":return Cn(n);case"polygon":return na(n)}}function ia(n){var e=An(n);return n.setAttribute("stroke-dasharray",e),e}function sa(n){for(var e=n.parentNode;_.svg(e)&&_.svg(e.parentNode);)e=e.parentNode;return e}function xn(n,e){var t=e||{},r=t.el||sa(n),i=r.getBoundingClientRect(),s=H(r,"viewBox"),o=i.width,l=i.height,a=t.viewBox||(s?s.split(" "):[0,0,o,l]);return{el:r,viewBox:a,x:a[0]/1,y:a[1]/1,w:o,h:l,vW:a[2],vH:a[3]}}function oa(n,e){var t=_.str(n)?Sn(n)[0]:n,r=e||100;return function(i){return{property:i,el:t,svg:xn(t),totalLength:An(t)*(r/100)}}}function aa(n,e,t){function r(c){c===void 0&&(c=0);var h=e+c>=1?e+c:0;return n.el.getPointAtLength(h)}var i=xn(n.el,n.svg),s=r(),o=r(-1),l=r(1),a=t?1:i.w/i.vW,u=t?1:i.h/i.vH;switch(n.property){case"x":return(s.x-i.x)*a;case"y":return(s.y-i.y)*u;case"angle":return Math.atan2(l.y-o.y,l.x-o.x)*180/Math.PI}}function Ar(n,e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,r=Pn(_.pth(n)?n.totalLength:n,e)+"";return{original:r,numbers:r.match(t)?r.match(t).map(Number):[0],strings:_.str(n)||e?r.split(t):[]}}function rr(n){var e=n?it(_.arr(n)?n.map(Cr):Cr(n)):[];return nt(e,function(t,r,i){return i.indexOf(t)===r})}function In(n){var e=rr(n);return e.map(function(t,r){return{target:t,id:r,total:e.length,transforms:{list:Tn(t)}}})}function la(n,e){var t=Yt(e);if(/^spring/.test(t.easing)&&(t.duration=_n(t.easing)),_.arr(n)){var r=n.length,i=r===2&&!_.obj(n[0]);i?n={value:n}:_.fnc(e.duration)||(t.duration=e.duration/r)}var s=_.arr(n)?n:[n];return s.map(function(o,l){var a=_.obj(o)&&!_.pth(o)?o:{value:o};return _.und(a.delay)&&(a.delay=l?0:e.delay),_.und(a.endDelay)&&(a.endDelay=l===s.length-1?e.endDelay:0),a}).map(function(o){return st(o,t)})}function ca(n){for(var e=nt(it(n.map(function(s){return Object.keys(s)})),function(s){return _.key(s)}).reduce(function(s,o){return s.indexOf(o)<0&&s.push(o),s},[]),t={},r=function(s){var o=e[s];t[o]=n.map(function(l){var a={};for(var u in l)_.key(u)?u==o&&(a.value=l[u]):a[u]=l[u];return a})},i=0;i<e.length;i++)r(i);return t}function ua(n,e){var t=[],r=e.keyframes;r&&(e=st(ca(r),e));for(var i in e)_.key(i)&&t.push({name:i,tweens:la(e[i],n)});return t}function ha(n,e){var t={};for(var r in n){var i=Bt(n[r],e);_.arr(i)&&(i=i.map(function(s){return Bt(s,e)}),i.length===1&&(i=i[0])),t[r]=i}return t.duration=parseFloat(t.duration),t.delay=parseFloat(t.delay),t}function da(n,e){var t;return n.tweens.map(function(r){var i=ha(r,e),s=i.value,o=_.arr(s)?s[1]:s,l=K(o),a=Xt(e.target,n.name,l,e),u=t?t.to.original:a,c=_.arr(s)?s[0]:u,h=K(c)||K(a),d=l||h;return _.und(o)&&(o=u),i.from=Ar(c,d),i.to=Ar(er(o,c),d),i.start=t?t.end:0,i.end=i.start+i.delay+i.duration+i.endDelay,i.easing=Gt(i.easing,i.duration),i.isPath=_.pth(s),i.isPathTargetInsideSVG=i.isPath&&_.svg(e.target),i.isColor=_.col(i.from.original),i.isColor&&(i.round=1),t=i,i})}var On={css:function(n,e,t){return n.style[e]=t},attribute:function(n,e,t){return n.setAttribute(e,t)},object:function(n,e,t){return n[e]=t},transform:function(n,e,t,r,i){if(r.list.set(e,t),e===r.last||i){var s="";r.list.forEach(function(o,l){s+=l+"("+o+") "}),n.style.transform=s}}};function Rn(n,e){var t=In(n);t.forEach(function(r){for(var i in e){var s=Bt(e[i],r),o=r.target,l=K(s),a=Xt(o,i,l,r),u=l||K(a),c=er(Pn(s,u),a),h=Zt(o,i);On[h](o,i,c,r.transforms,!0)}})}function fa(n,e){var t=Zt(n.target,e.name);if(t){var r=da(e,n),i=r[r.length-1];return{type:t,property:e.name,animatable:n,tweens:r,duration:i.end,delay:r[0].delay,endDelay:i.endDelay}}}function ga(n,e){return nt(it(n.map(function(t){return e.map(function(r){return fa(t,r)})})),function(t){return!_.und(t)})}function jn(n,e){var t=n.length,r=function(s){return s.timelineOffset?s.timelineOffset:0},i={};return i.duration=t?Math.max.apply(Math,n.map(function(s){return r(s)+s.duration})):e.duration,i.delay=t?Math.min.apply(Math,n.map(function(s){return r(s)+s.delay})):e.delay,i.endDelay=t?i.duration-Math.max.apply(Math,n.map(function(s){return r(s)+s.duration-s.endDelay})):e.endDelay,i}var xr=0;function pa(n){var e=Lt(wn,n),t=Lt(Kt,n),r=ua(t,n),i=In(n.targets),s=ga(i,r),o=jn(s,t),l=xr;return xr++,st(e,{id:l,children:[],animatables:i,animations:s,duration:o.duration,delay:o.delay,endDelay:o.endDelay})}var F=[],$n=function(){var n;function e(){!n&&(!Ir()||!x.suspendWhenDocumentHidden)&&F.length>0&&(n=requestAnimationFrame(t))}function t(i){for(var s=F.length,o=0;o<s;){var l=F[o];l.paused?(F.splice(o,1),s--):(l.tick(i),o++)}n=o>0?requestAnimationFrame(t):void 0}function r(){x.suspendWhenDocumentHidden&&(Ir()?n=cancelAnimationFrame(n):(F.forEach(function(i){return i._onDocumentVisibility()}),$n()))}return typeof document<"u"&&document.addEventListener("visibilitychange",r),e}();function Ir(){return!!document&&document.hidden}function x(n){n===void 0&&(n={});var e=0,t=0,r=0,i,s=0,o=null;function l(v){var m=window.Promise&&new Promise(function(w){return o=w});return v.finished=m,m}var a=pa(n);l(a);function u(){var v=a.direction;v!=="alternate"&&(a.direction=v!=="normal"?"normal":"reverse"),a.reversed=!a.reversed,i.forEach(function(m){return m.reversed=a.reversed})}function c(v){return a.reversed?a.duration-v:v}function h(){e=0,t=c(a.currentTime)*(1/x.speed)}function d(v,m){m&&m.seek(v-m.timelineOffset)}function f(v){if(a.reversePlayback)for(var w=s;w--;)d(v,i[w]);else for(var m=0;m<s;m++)d(v,i[m])}function g(v){for(var m=0,w=a.animations,k=w.length;m<k;){var S=w[m],C=S.animatable,R=S.tweens,j=R.length-1,P=R[j];j&&(P=nt(R,function(Mn){return v<Mn.end})[0]||P);for(var D=z(v-P.start-P.delay,0,P.duration)/P.duration,G=isNaN(D)?1:P.easing(D),I=P.to.strings,ot=P.round,at=[],Bn=P.to.numbers.length,oe=void 0,we=0;we<Bn;we++){var be=void 0,nr=P.to.numbers[we],ir=P.from.numbers[we]||0;P.isPath?be=aa(P.value,G*nr,P.isPathTargetInsideSVG):be=ir+G*(nr-ir),ot&&(P.isColor&&we>2||(be=Math.round(be*ot)/ot)),at.push(be)}var sr=I.length;if(!sr)oe=at[0];else{oe=I[0];for(var _e=0;_e<sr;_e++){I[_e];var or=I[_e+1],lt=at[_e];isNaN(lt)||(or?oe+=lt+or:oe+=lt+" ")}}On[S.type](C.target,S.property,oe,C.transforms),S.currentValue=oe,m++}}function p(v){a[v]&&!a.passThrough&&a[v](a)}function b(){a.remaining&&a.remaining!==!0&&a.remaining--}function y(v){var m=a.duration,w=a.delay,k=m-a.endDelay,S=c(v);a.progress=z(S/m*100,0,100),a.reversePlayback=S<a.currentTime,i&&f(S),!a.began&&a.currentTime>0&&(a.began=!0,p("begin")),!a.loopBegan&&a.currentTime>0&&(a.loopBegan=!0,p("loopBegin")),S<=w&&a.currentTime!==0&&g(0),(S>=k&&a.currentTime!==m||!m)&&g(m),S>w&&S<k?(a.changeBegan||(a.changeBegan=!0,a.changeCompleted=!1,p("changeBegin")),p("change"),g(S)):a.changeBegan&&(a.changeCompleted=!0,a.changeBegan=!1,p("changeComplete")),a.currentTime=z(S,0,m),a.began&&p("update"),v>=m&&(t=0,b(),a.remaining?(e=r,p("loopComplete"),a.loopBegan=!1,a.direction==="alternate"&&u()):(a.paused=!0,a.completed||(a.completed=!0,p("loopComplete"),p("complete"),!a.passThrough&&"Promise"in window&&(o(),l(a)))))}return a.reset=function(){var v=a.direction;a.passThrough=!1,a.currentTime=0,a.progress=0,a.paused=!0,a.began=!1,a.loopBegan=!1,a.changeBegan=!1,a.completed=!1,a.changeCompleted=!1,a.reversePlayback=!1,a.reversed=v==="reverse",a.remaining=a.loop,i=a.children,s=i.length;for(var m=s;m--;)a.children[m].reset();(a.reversed&&a.loop!==!0||v==="alternate"&&a.loop===1)&&a.remaining++,g(a.reversed?a.duration:0)},a._onDocumentVisibility=h,a.set=function(v,m){return Rn(v,m),a},a.tick=function(v){r=v,e||(e=r),y((r+(t-e))*x.speed)},a.seek=function(v){y(c(v))},a.pause=function(){a.paused=!0,h()},a.play=function(){a.paused&&(a.completed&&a.reset(),a.paused=!1,F.push(a),h(),$n())},a.reverse=function(){u(),a.completed=!a.reversed,h()},a.restart=function(){a.reset(),a.play()},a.remove=function(v){var m=rr(v);Ln(m,a)},a.reset(),a.autoplay&&a.play(),a}function Or(n,e){for(var t=e.length;t--;)Wt(n,e[t].animatable.target)&&e.splice(t,1)}function Ln(n,e){var t=e.animations,r=e.children;Or(n,t);for(var i=r.length;i--;){var s=r[i],o=s.animations;Or(n,o),!o.length&&!s.children.length&&r.splice(i,1)}!t.length&&!r.length&&e.pause()}function ma(n){for(var e=rr(n),t=F.length;t--;){var r=F[t];Ln(e,r)}}function va(n,e){e===void 0&&(e={});var t=e.direction||"normal",r=e.easing?Gt(e.easing):null,i=e.grid,s=e.axis,o=e.from||0,l=o==="first",a=o==="center",u=o==="last",c=_.arr(n),h=parseFloat(c?n[0]:n),d=c?parseFloat(n[1]):0,f=K(c?n[1]:n)||0,g=e.start||0+(c?h:0),p=[],b=0;return function(y,v,m){if(l&&(o=0),a&&(o=(m-1)/2),u&&(o=m-1),!p.length){for(var w=0;w<m;w++){if(!i)p.push(Math.abs(o-w));else{var k=a?(i[0]-1)/2:o%i[0],S=a?(i[1]-1)/2:Math.floor(o/i[0]),C=w%i[0],R=Math.floor(w/i[0]),j=k-C,P=S-R,D=Math.sqrt(j*j+P*P);s==="x"&&(D=-j),s==="y"&&(D=-P),p.push(D)}b=Math.max.apply(Math,p)}r&&(p=p.map(function(I){return r(I/b)*b})),t==="reverse"&&(p=p.map(function(I){return s?I<0?I*-1:-I:Math.abs(b-I)}))}var G=c?(d-h)/b:h;return g+G*(Math.round(p[v]*100)/100)+f}}function ya(n){n===void 0&&(n={});var e=x(n);return e.duration=0,e.add=function(t,r){var i=F.indexOf(e),s=e.children;i>-1&&F.splice(i,1);function o(d){d.passThrough=!0}for(var l=0;l<s.length;l++)o(s[l]);var a=st(t,Lt(Kt,n));a.targets=a.targets||n.targets;var u=e.duration;a.autoplay=!1,a.direction=e.direction,a.timelineOffset=_.und(r)?u:er(r,u),o(e),e.seek(a.timelineOffset);var c=x(a);o(c),s.push(c);var h=jn(s,n);return e.delay=h.delay,e.endDelay=h.endDelay,e.duration=h.duration,e.seek(0),e.reset(),e.autoplay&&e.play(),e},e}x.version="3.2.1";x.speed=1;x.suspendWhenDocumentHidden=!0;x.running=F;x.remove=ma;x.get=Xt;x.set=Rn;x.convertPx=Qt;x.path=oa;x.setDashoffset=ia;x.stagger=va;x.timeline=ya;x.easing=Gt;x.penner=kn;x.random=function(n,e){return Math.floor(Math.random()*(e-n+1))+n};class wa{constructor(){this.currentService=null,this.baseURL=window.location.hostname==="localhost"?"https://cornwells-services.netlify.app":window.location.origin,this.init()}init(){this.setupEventListeners(),this.loadCurrentPage(),this.initializeAnimations()}setupEventListeners(){document.addEventListener("click",e=>{e.target.matches("[data-book-consultation]")&&(e.preventDefault(),this.handleBookingClick(e.target)),e.target.matches("[data-call-pharmacy]")&&(e.preventDefault(),this.handleCallClick()),e.target.matches("[data-visit-cornwells]")&&(e.preventDefault(),this.handleCornwellsClick()),e.target.matches("[data-generate-qr]")&&(e.preventDefault(),this.generateQRCode(e.target))}),window.addEventListener("popstate",()=>{this.loadCurrentPage()})}loadCurrentPage(){const e=window.location.pathname,t=this.extractServiceIdFromPath(e);t&&_t[t]?this.loadServiceLanding(t):this.loadServiceSelector()}extractServiceIdFromPath(e){const t=[/^\/([^\/]+)$/,/^\/services\/([^\/]+)$/];for(const r of t){const i=e.match(r);if(i)return i[1]}return null}async loadServiceLanding(e){const t=ar(e);if(!t){this.loadServiceSelector();return}this.currentService=t;try{const r=this.generateServiceLandingHTML(t);document.getElementById("app-content").innerHTML=r,document.title=`${t.title} | Expert Pharmacy Services`,this.updateMetaDescription(t.description),this.initializeAnimations()}catch(r){console.error("Error loading service landing:",r)}}loadServiceSelector(){const e=this.generateServiceSelectorHTML();document.getElementById("app-content").innerHTML=e,document.title="Pharmacy Services | Choose Your Service"}generateServiceLandingHTML(e){const t=e.colorScheme;return`
      <div class="landing-hero bg-gradient-to-br ${t.hero}">
        <div class="content-section relative z-10">
          <!-- Service Icon & Title -->
          <div class="text-center mb-12 fade-in-up">
            <div class="service-icon stagger-1">
              ${e.icon}
            </div>
            <h1 class="hero-title stagger-2">
              ${e.headline}
            </h1>
            <p class="hero-subtitle mt-4 stagger-3">
              ${e.subheadline}
            </p>
          </div>

          <!-- Primary CTA -->
          <div class="mb-12 stagger-4">
            <button class="w-full py-5 px-8 bg-gradient-to-r ${t.primary} text-white text-xl font-bold rounded-2xl shadow-xl hover:scale-105 transition-all duration-200" data-book-consultation="${e.id}">
              ðŸ“… Book Your Free Consultation
            </button>
          </div>

          <!-- Quick Value Proposition -->
          <div class="text-center mb-12">
            <p class="text-xl text-gray-200 leading-relaxed mb-6">
              ${e.description}
            </p>
            ${e.socialProof?`
              <div class="flex items-center justify-center space-x-2 text-sm text-gray-400">
                <span>â­â­â­â­â­</span>
                <span>${e.socialProof}</span>
              </div>
            `:""}
            ${e.urgency?`
              <div class="inline-block bg-orange-500/20 text-orange-300 px-4 py-2 rounded-full text-sm mt-4">
                â° ${e.urgency}
              </div>
            `:""}
          </div>
        </div>
      </div>

      <!-- Benefits Section -->
      <section class="content-section">
        <h2 class="section-title text-center mb-8">What You'll Experience:</h2>
        
        <div class="space-y-6 mb-12">
          ${e.specificBenefits.slice(0,3).map((r,i)=>`
            <div class="benefit-card fade-in-up stagger-${i+1}">
              <div class="flex items-start space-x-4">
                <div class="w-8 h-8 ${t.accent} rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                  <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                  </svg>
                </div>
                <p class="text-gray-200 text-lg leading-relaxed">${r}</p>
              </div>
            </div>
          `).join("")}
        </div>

        <!-- Secondary CTA -->
        <div class="text-center mb-12">
          <button class="w-full py-4 px-8 bg-gradient-to-r ${t.primary} text-white text-lg font-semibold rounded-2xl shadow-xl hover:scale-105 transition-all duration-200" data-book-consultation="${e.id}">
            Start Feeling Better Today
          </button>
        </div>
      </section>

      <!-- How It Works -->
      <section class="content-section">
        <h2 class="section-title text-center mb-4">It's Simple:</h2>
        <p class="section-subtitle text-center mb-10">Three easy steps to start feeling better</p>
        
        <div class="space-y-8 mb-12">
          ${e.uniqueProcess.slice(0,3).map((r,i)=>`
            <div class="process-step fade-in-up stagger-${i+1}">
              <div class="w-12 h-12 bg-gradient-to-r ${t.primary} text-white rounded-full flex items-center justify-center font-bold text-lg flex-shrink-0">${i+1}</div>
              <div>
                <p class="text-gray-200 text-lg leading-relaxed">${r}</p>
              </div>
            </div>
          `).join("")}
        </div>
      </section>

      <!-- Contact Information -->
      <section class="content-section">
        <div class="bg-gradient-to-r ${t.secondary} p-8 rounded-3xl backdrop-blur-sm border border-white/10 text-center">
          <h3 class="text-2xl font-bold text-white mb-4">Ready to Feel Better?</h3>
          <p class="text-gray-200 mb-8 text-lg">${e.callToAction}</p>
          
          <div class="space-y-4">
            <button class="w-full py-5 px-8 bg-gradient-to-r ${t.primary} text-white text-xl font-bold rounded-2xl shadow-xl hover:scale-105 transition-all duration-200" data-book-consultation="${e.id}">
              ðŸ“… Book My Consultation
            </button>
            
            <div class="text-gray-400 text-sm">
              <span>ðŸ’¬ Free consultation â€¢ ðŸ“ž Same day appointments available</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Footer -->
      <footer class="content-section border-t border-white/10">
        <div class="text-center text-gray-400 space-y-4">
          <button class="btn-secondary-landing" data-visit-cornwells>
            Visit Cornwells Pharmacy Website
          </button>
          
          <p class="text-sm">
            Expert pharmacy services with professional care
          </p>
          
          <div class="flex justify-center space-x-4 text-xs">
            <span>Privacy Policy</span>
            <span>â€¢</span>
            <span>Terms of Service</span>
          </div>
        </div>
      </footer>
    `}generateServiceSelectorHTML(){return`
      <div class="landing-hero">
        <div class="content-section relative z-10">
          <div class="text-center mb-12">
            <h1 class="hero-title">Pharmacy Services</h1>
            <p class="hero-subtitle mt-4">Choose a service to view its landing page</p>
          </div>
          
          <div class="space-y-4">
            ${Object.values(_t).map(t=>`
              <a href="/${t.id}" 
                 class="block p-6 bg-white/5 rounded-2xl border border-white/10 hover:bg-white/10 transition-all">
                <div class="flex items-center space-x-4">
                  <div class="text-3xl">${t.icon}</div>
                  <div>
                    <h3 class="text-lg font-semibold text-white">${t.title}</h3>
                    <p class="text-gray-300 text-sm">${t.headline}</p>
                  </div>
                </div>
              </a>
            `).join("")}
          </div>
        </div>
      </div>
    `}handleBookingClick(e){var r;const t=e.getAttribute("data-book-consultation")||((r=this.currentService)==null?void 0:r.id);this.showBookingModal(t)}showBookingModal(e){document.body.insertAdjacentHTML("beforeend",`
      <div id="booking-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-3xl p-8 max-w-md w-full border border-white/10">
          <h3 class="text-2xl font-bold text-white mb-6 text-center">Book Your Consultation</h3>
          
          <form id="booking-form" class="space-y-4 mb-8">
            <div>
              <label class="block text-gray-300 mb-2">Your Name*</label>
              <input 
                type="text" 
                id="patient-name" 
                required
                class="w-full p-4 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400" 
                placeholder="Enter your full name">
            </div>
            
            <div>
              <label class="block text-gray-300 mb-2">Phone Number*</label>
              <input 
                type="tel" 
                id="phone-number" 
                required
                class="w-full p-4 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400" 
                placeholder="Your phone number (e.g., 07123 456789)">
            </div>
            
            <div>
              <label class="block text-gray-300 mb-2">Email (Optional)</label>
              <input 
                type="email" 
                id="email" 
                class="w-full p-4 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400" 
                placeholder="your.email@example.com">
            </div>
            
            <div>
              <label class="block text-gray-300 mb-2">Preferred Time*</label>
              <select id="preferred-time" required class="w-full p-4 bg-white/10 border border-white/20 rounded-xl text-white">
                <option value="">Select your preferred time</option>
                <option value="Morning (9am-12pm)">Morning (9am-12pm)</option>
                <option value="Afternoon (12pm-5pm)">Afternoon (12pm-5pm)</option>
                <option value="Evening (5pm-7pm)">Evening (5pm-7pm)</option>
              </select>
            </div>
            
            <div>
              <label class="block text-gray-300 mb-2">Additional Notes (Optional)</label>
              <textarea 
                id="notes" 
                rows="3"
                class="w-full p-4 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400" 
                placeholder="Any specific questions or requirements?"></textarea>
            </div>
            
            <div class="text-xs text-gray-400 bg-white/5 p-3 rounded-lg">
              <label class="flex items-start space-x-2">
                <input type="checkbox" id="consent" required class="mt-1">
                <span>I consent to being contacted about this consultation and understand my data will be handled according to privacy policies.*</span>
              </label>
            </div>
          </form>
          
          <div class="space-y-3">
            <button 
              type="submit" 
              form="booking-form"
              class="btn-primary-landing w-full" 
              id="submit-booking">
              ðŸ“… Request Consultation
            </button>
            <button class="btn-secondary-landing" onclick="this.closest('#booking-modal').remove()">
              Cancel
            </button>
          </div>
        </div>
      </div>
    `),document.getElementById("booking-form").addEventListener("submit",r=>{r.preventDefault(),this.handleBookingSubmission(e)})}handleCallClick(){this.showSuccessMessage("ðŸ“ž Calling pharmacy... (In demo: would open phone dialer)")}handleCornwellsClick(){window.open("https://cornwells.co.uk","_blank")}async generateQRCode(e){var s;const t=e.getAttribute("data-generate-qr")||((s=this.currentService)==null?void 0:s.id);if(!t)return;const r=ar(t),i=`${this.baseURL}/${t}`;try{const o=await $e.toDataURL(i,{width:256,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"}),l=`
        <div id="qr-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
          <div class="bg-white rounded-3xl p-8 max-w-sm w-full text-center">
            <h3 class="text-2xl font-bold text-gray-900 mb-6">${r.title}</h3>
            <div class="mb-6">
              <img src="${o}" alt="QR Code" class="mx-auto rounded-2xl shadow-lg">
            </div>
            <p class="text-gray-600 mb-6">Scan to access this service page</p>
            <button class="w-full py-3 bg-gray-900 text-white rounded-2xl font-semibold" onclick="this.closest('#qr-modal').remove()">
              Close
            </button>
          </div>
        </div>
      `;document.body.insertAdjacentHTML("beforeend",l)}catch(o){console.error("Error generating QR code:",o)}}initializeAnimations(){const e=new IntersectionObserver(t=>{t.forEach(r=>{r.isIntersecting&&(r.target.style.opacity="1",r.target.style.transform="translateY(0)")})},{threshold:.1});document.querySelectorAll(".fade-in-up").forEach(t=>{t.style.opacity="0",t.style.transform="translateY(30px)",t.style.transition="all 0.6s ease-out",e.observe(t)}),x({targets:".stagger-1, .stagger-2, .stagger-3, .stagger-4",opacity:[0,1],translateY:[30,0],delay:function(t,r){return r*200},duration:800,easing:"easeOutCubic"})}async handleBookingSubmission(e){const t=document.getElementById("submit-booking"),r=t.innerHTML;try{t.innerHTML="â³ Submitting...",t.disabled=!0;const i={patient_name:document.getElementById("patient-name").value.trim(),phone_number:document.getElementById("phone-number").value.trim(),email:document.getElementById("email").value.trim()||null,preferred_time_slot:ro[document.getElementById("preferred-time").value],notes:document.getElementById("notes").value.trim()||null,service_type:e,service_name:to[e],source_url:window.location.href,consent_given:document.getElementById("consent").checked,preferred_contact_method:"phone"},s=new URLSearchParams(window.location.search),o={};["utm_source","utm_medium","utm_campaign","utm_term","utm_content"].forEach(u=>{s.has(u)&&(o[u]=s.get(u))}),Object.keys(o).length>0&&(i.utm_params=o),console.log("Submitting booking:",i);const{data:l,error:a}=await eo.from("service_consultations").insert([i]).select();if(a)throw console.error("Supabase error:",a),new Error("Failed to submit booking. Please try again.");console.log("Booking submitted successfully:",l),document.getElementById("booking-modal").remove(),this.showSuccessMessage("ðŸŽ‰ Booking request sent! We'll call you within 2 hours to confirm your consultation."),typeof gtag<"u"&&gtag("event","consultation_booking",{event_category:"conversion",event_label:e,value:1})}catch(i){console.error("Booking submission error:",i),this.showErrorMessage("Sorry, there was an issue submitting your booking. Please try again or call us directly."),t.innerHTML=r,t.disabled=!1}}showSuccessMessage(e){const t=document.createElement("div");t.className="fixed bottom-6 left-6 right-6 bg-green-600 text-white p-4 rounded-2xl shadow-xl z-50 text-center font-semibold",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.parentElement&&t.remove()},4e3)}showErrorMessage(e){const t=document.createElement("div");t.className="fixed bottom-6 left-6 right-6 bg-red-600 text-white p-4 rounded-2xl shadow-xl z-50 text-center font-semibold",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.parentElement&&t.remove()},7e3)}updateMetaDescription(e){let t=document.querySelector('meta[name="description"]');t||(t=document.createElement("meta"),t.name="description",document.head.appendChild(t)),t.content=e}}document.addEventListener("DOMContentLoaded",()=>{window.app=new wa});
//# sourceMappingURL=main-BeIREVQq.js.map
