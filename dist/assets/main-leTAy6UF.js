function Un(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const Ir={"metabolic-weight":{id:"metabolic-weight",title:"Metabolic & Weight Management",headline:"Finally Lose Weight & Keep It Off",subheadline:"Break free from yo-yo dieting with medical support that actually works.",description:"Ready for lasting results? Get proven weight loss support with expert medical guidance.",colorScheme:{primary:"from-orange-600 to-red-600",secondary:"from-orange-500/20 to-red-500/20",accent:"bg-orange-500",hero:"from-orange-900 via-red-900 to-slate-900"},specificBenefits:["Lose 10-30 pounds safely without crash dieting or hunger","Get your energy back and stop afternoon crashes","Keep the weight off for good with proven medical support"],uniqueProcess:["Complete health assessment to find what's been holding you back","Personalized plan with medication support if needed","Weekly check-ins until you reach and maintain your goal"],callToAction:"Ready to break the cycle? Start your weight loss journey the right way.",socialProof:"Over 300 successful weight loss transformations",urgency:"New patient spots filling fast",targetAudience:"Adults wanting sustainable weight loss with medical support",icon:"⚡",featured:!0},"womens-health":{id:"womens-health",title:"Women's Health Services",headline:"Feel Like Yourself Again",subheadline:"End sleepless nights and hot flashes with expert menopause care",description:"Menopause doesn't have to be this hard. Get personalized support that actually works.",colorScheme:{primary:"from-pink-600 to-purple-600",secondary:"from-pink-500/20 to-purple-500/20",accent:"bg-pink-500",hero:"from-pink-900 via-purple-900 to-slate-900"},specificBenefits:["Sleep through the night without hot flashes waking you up","Feel balanced and energetic instead of exhausted and moody",`Get real solutions that work - not just "it's normal" advice`],uniqueProcess:["Private 20-minute consultation to understand your symptoms","Personalized treatment plan (HRT, natural alternatives, or both)","Ongoing support with adjustments until you feel right again"],callToAction:"Ready to feel like yourself again? Book your confidential consultation.",socialProof:"Helping 200+ women reclaim their energy and confidence",urgency:"Limited consultation slots this week",targetAudience:"Women aged 45-65 experiencing menopause symptoms",icon:"🌸",featured:!0},"health-screening":{id:"health-screening",title:"Health Screening & Monitoring",headline:"Catch Problems Before They Start",subheadline:"Find out what's really going on inside your body",description:"Take control of your health. Get instant answers and peace of mind with comprehensive screening.",colorScheme:{primary:"from-blue-600 to-cyan-600",secondary:"from-blue-500/20 to-cyan-500/20",accent:"bg-blue-500",hero:"from-blue-900 via-cyan-900 to-slate-900"},specificBenefits:["Catch diabetes, heart disease, and stroke risk before symptoms appear","Get instant results with clear explanations - no medical jargon","Walk out with a personalized plan to improve your numbers"],uniqueProcess:["Choose your screening level based on your concerns","Quick 15-minute tests with results explained immediately","Personalized action plan to keep you healthy long-term"],callToAction:"Don't wait for warning signs. Know your health status today.",socialProof:"Trusted by 1,000+ health-conscious individuals",urgency:"Same-day screening available",targetAudience:"Health-conscious adults 40+ wanting proactive health monitoring",icon:"🔍",featured:!1},vaccinations:{id:"vaccinations",title:"Core Vaccinations",headline:"Keep Your Family Safe",subheadline:"Protect against serious illness with convenient vaccination services",description:"Keep your family healthy and protected with convenient same-day vaccinations.",colorScheme:{primary:"from-green-600 to-emerald-600",secondary:"from-green-500/20 to-emerald-500/20",accent:"bg-green-500",hero:"from-green-900 via-emerald-900 to-slate-900"},specificBenefits:["Avoid weeks of illness from flu, COVID, or pneumonia","Same-day service - no GP wait times or hassle","Family packages available with special pricing"],uniqueProcess:["Quick health check to recommend the right vaccines","Professional vaccination with comfortable, experienced staff","Digital certificate ready for travel or work requirements"],callToAction:"Protect your family now. Walk-ins welcome today.",socialProof:"Protecting 2,000+ families this year",urgency:"Flu season starting - book before it's too late",targetAudience:"Individuals and families wanting protection against preventable diseases",icon:"🛡️",featured:!1},"nhs-services":{id:"nhs-services",title:"NHS Clinical Services",headline:"Feel Better Today",subheadline:"Get NHS treatment now - no GP appointment needed",description:"Feeling unwell? Get free NHS treatment and medicine without the wait.",colorScheme:{primary:"from-indigo-600 to-blue-700",secondary:"from-indigo-500/20 to-blue-500/20",accent:"bg-indigo-500",hero:"from-indigo-900 via-blue-900 to-slate-900"},specificBenefits:["Get rid of UTIs, sore throats, and infections today","No waiting for GP appointments when you're feeling awful","Walk out with your medicine - completely free on NHS"],uniqueProcess:["Walk in when you're unwell - no appointment booking stress","Professional assessment by NHS pharmacist in minutes","Get treated immediately or referred quickly if needed"],callToAction:"Ready to feel better? Get the help you need now.",socialProof:"Helping 500+ patients get better faster each month",urgency:"Open now - no appointment needed",targetAudience:"Anyone needing quick NHS healthcare for minor illnesses",icon:"🏥",featured:!1},"mens-health":{id:"mens-health",title:"Men's Health & Performance",headline:"Get Your Edge Back",subheadline:"Reclaim your energy, strength, and confidence",description:"Ready to feel energized and strong again? Reclaim the vitality you had in your twenties.",colorScheme:{primary:"from-slate-600 to-gray-800",secondary:"from-slate-500/20 to-gray-500/20",accent:"bg-slate-600",hero:"from-slate-800 via-gray-900 to-black"},specificBenefits:["Wake up energized instead of exhausted every morning","Build muscle and strength like you did when you were younger","Regain confidence in the bedroom with proven treatments"],uniqueProcess:["Private consultation about your energy and performance goals","Comprehensive testing to find what's really causing the problem","Personalized treatment plan to get you back to your best"],callToAction:"Ready to feel like your best self again? Take control today.",socialProof:"Helping 150+ men reclaim their prime",urgency:"Confidential consultations available this week",targetAudience:"Men 35-65 wanting to optimize health, energy, and performance",icon:"💪",featured:!0},"travel-health":{id:"travel-health",title:"Travel Health Services",headline:"Travel Without Worry",subheadline:"Protect yourself from diseases that could ruin your trip",description:"Enjoy your dream holiday with confidence. Get the right protection for any destination.",colorScheme:{primary:"from-sky-600 to-blue-600",secondary:"from-sky-500/20 to-blue-500/20",accent:"bg-sky-500",hero:"from-sky-900 via-blue-900 to-slate-900"},specificBenefits:["Avoid malaria, typhoid, and serious travel diseases","Get expert advice for your exact destination and activities","Fast-track service for last-minute travel plans"],uniqueProcess:["Tell us where you're going and we'll recommend what you need","Professional vaccinations and travel health advice in one visit","All certificates and documentation sorted for your trip"],callToAction:"Ready for worry-free travel? Get protected today.",socialProof:"Protecting 800+ travelers every year",urgency:"Last-minute appointments available",targetAudience:"Travelers needing destination-specific health protection and advice",icon:"✈️",featured:!0},"gut-health":{id:"gut-health",title:"Gut Health & Digestive Wellness",headline:"Eat Without Fear Again",subheadline:"Stop bloating, pain, and bathroom emergencies for good",description:"Ready to enjoy food again without discomfort? Get your digestion working properly.",colorScheme:{primary:"from-green-500 to-lime-600",secondary:"from-green-400/20 to-lime-400/20",accent:"bg-green-500",hero:"from-green-900 via-lime-900 to-slate-900"},specificBenefits:["Stop embarrassing bloating and gas that ruins your day","Find out exactly which foods are causing your problems","Enjoy meals without worrying about pain or bathroom trips"],uniqueProcess:["Complete digestive assessment to find your specific triggers","Personalized healing plan with natural solutions that work","Ongoing support until you can eat normally again"],callToAction:"Ready to enjoy eating again? Let's fix your gut health today.",socialProof:"Helping 250+ people enjoy food again",urgency:"Limited gut health consultations this month",targetAudience:"Adults with IBS, bloating, food intolerances, or digestive discomfort",icon:"🌱",featured:!1}},Nn=()=>Object.values(Ir).filter(n=>n.featured),Ee=n=>Ir[n]||null,Fn="modulepreload",qn=function(n){return"/"+n},lr={},we=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(t.map(a=>{if(a=qn(a),a in lr)return;lr[a]=!0;const u=a.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${c}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":Fn,u||(h.as="script"),h.crossOrigin="",h.href=a,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((d,f)=>{h.addEventListener("load",d),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${a}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},Hn=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>we(async()=>{const{default:r}=await Promise.resolve().then(()=>be);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Dt extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class zn extends Dt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Vn extends Dt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Jn extends Dt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var xt;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(xt||(xt={}));var Gn=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};class Kn{constructor(e,{headers:t={},customFetch:r,region:s=xt.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=Hn(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Gn(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=t;let l={},{region:a}=t;a||(a=this.region),a&&a!=="any"&&(l["x-region"]=a);let u;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const c=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:u}).catch(g=>{throw new zn(g)}),h=c.headers.get("x-relay-error");if(h&&h==="true")throw new Vn(c);if(!c.ok)throw new Jn(c);let d=((r=c.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),f;return d==="application/json"?f=yield c.json():d==="application/octet-stream"?f=yield c.blob():d==="text/event-stream"?f=c:d==="multipart/form-data"?f=yield c.formData():f=yield c.text(),{data:f,error:null}}catch(s){return{data:null,error:s}}})}}var U=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wn(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var B={},Ut={},Ke={},Le={},We={},Qe={},Qn=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ge=Qn();const Yn=ge.fetch,jr=ge.fetch.bind(ge),$r=ge.Headers,Zn=ge.Request,Xn=ge.Response,be=Object.freeze(Object.defineProperty({__proto__:null,Headers:$r,Request:Zn,Response:Xn,default:jr,fetch:Yn},Symbol.toStringTag,{value:"Module"})),es=Wn(be);var Ye={};Object.defineProperty(Ye,"__esModule",{value:!0});let ts=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Ye.default=ts;var Lr=U&&U.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Qe,"__esModule",{value:!0});const rs=Lr(es),ns=Lr(Ye);let ss=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=rs.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,a;let u=null,c=null,h=null,d=i.status,f=i.statusText;if(i.ok){if(this.method!=="HEAD"){const y=await i.text();y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=y:c=JSON.parse(y))}const p=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),b=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");p&&b&&b.length>1&&(h=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,d=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const p=await i.text();try{u=JSON.parse(p),Array.isArray(u)&&i.status===404&&(c=[],u=null,d=200,f="OK")}catch{i.status===404&&p===""?(d=204,f="No Content"):u={message:p}}if(u&&this.isMaybeSingle&&(!((a=u==null?void 0:u.details)===null||a===void 0)&&a.includes("0 rows"))&&(u=null,d=200,f="OK"),u&&this.shouldThrowOnError)throw new ns.default(u)}return{error:u,data:c,count:h,status:d,statusText:f}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,l,a;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(a=i==null?void 0:i.code)!==null&&a!==void 0?a:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}};Qe.default=ss;var is=U&&U.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(We,"__esModule",{value:!0});const os=is(Qe);let as=class extends os.default{select(e){let t=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var l;const a=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${a};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};We.default=as;var ls=U&&U.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Le,"__esModule",{value:!0});const cs=ls(We);let us=class extends cs.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};Le.default=us;var hs=U&&U.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ke,"__esModule",{value:!0});const Te=hs(Le);let ds=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=t,this.schema=r,this.fetch=s}select(e,{head:t=!1,count:r}={}){const s=t?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new Te.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((l,a)=>l.concat(Object.keys(a)),[]);if(o.length>0){const l=[...new Set(o)].map(a=>`"${a}"`);this.url.searchParams.set("columns",l.join(","))}}return new Te.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const a=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(a.length>0){const u=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Te.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new Te.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Te.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Ke.default=ds;var Ze={},Xe={};Object.defineProperty(Xe,"__esModule",{value:!0});Xe.version=void 0;Xe.version="0.0.0-automated";Object.defineProperty(Ze,"__esModule",{value:!0});Ze.DEFAULT_HEADERS=void 0;const fs=Xe;Ze.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${fs.version}`};var Br=U&&U.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ut,"__esModule",{value:!0});const gs=Br(Ke),ps=Br(Le),ms=Ze;let vs=class Mr{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},ms.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=s}from(e){const t=new URL(`${this.url}/${e}`);return new gs.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Mr(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:s=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let a;r||s?(o=r?"HEAD":"GET",Object.entries(t).filter(([c,h])=>h!==void 0).map(([c,h])=>[c,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([c,h])=>{l.searchParams.append(c,h)})):(o="POST",a=t);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new ps.default({method:o,url:l,headers:u,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}};Ut.default=vs;var _e=U&&U.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(B,"__esModule",{value:!0});B.PostgrestError=B.PostgrestBuilder=B.PostgrestTransformBuilder=B.PostgrestFilterBuilder=B.PostgrestQueryBuilder=B.PostgrestClient=void 0;const Dr=_e(Ut);B.PostgrestClient=Dr.default;const Ur=_e(Ke);B.PostgrestQueryBuilder=Ur.default;const Nr=_e(Le);B.PostgrestFilterBuilder=Nr.default;const Fr=_e(We);B.PostgrestTransformBuilder=Fr.default;const qr=_e(Qe);B.PostgrestBuilder=qr.default;const Hr=_e(Ye);B.PostgrestError=Hr.default;var ys=B.default={PostgrestClient:Dr.default,PostgrestQueryBuilder:Ur.default,PostgrestFilterBuilder:Nr.default,PostgrestTransformBuilder:Fr.default,PostgrestBuilder:qr.default,PostgrestError:Hr.default};const{PostgrestClient:ws,PostgrestQueryBuilder:$a,PostgrestFilterBuilder:La,PostgrestTransformBuilder:Ba,PostgrestBuilder:Ma,PostgrestError:Da}=ys;let St;typeof window>"u"?St=require("ws"):St=window.WebSocket;const bs="2.11.9",_s={"X-Client-Info":`realtime-js/${bs}`},ks="1.0.0",zr=1e4,xs=1e3;var fe;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(fe||(fe={}));var $;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})($||($={}));var F;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(F||(F={}));var Et;(function(n){n.websocket="websocket"})(Et||(Et={}));var ie;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(ie||(ie={}));class Ss{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+s));o=o+s;const a=r.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:a,payload:u}}}class Vr{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var C;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(C||(C={}));const cr=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=Es(o,n,e,s),i),{})},Es=(n,e,t,r)=>{const s=e.find(l=>l.name===n),i=s==null?void 0:s.type,o=t[n];return i&&!r.includes(i)?Jr(i,o):Tt(o)},Jr=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return As(e,t)}switch(n){case C.bool:return Ts(e);case C.float4:case C.float8:case C.int2:case C.int4:case C.int8:case C.numeric:case C.oid:return Ps(e);case C.json:case C.jsonb:return Cs(e);case C.timestamp:return Os(e);case C.abstime:case C.date:case C.daterange:case C.int4range:case C.int8range:case C.money:case C.reltime:case C.text:case C.time:case C.timestamptz:case C.timetz:case C.tsrange:case C.tstzrange:return Tt(e);default:return Tt(e)}},Tt=n=>n,Ts=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Ps=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Cs=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},As=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Jr(e,l))}return n},Os=n=>typeof n=="string"?n.replace(" ","T"):n,Gr=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class ht{constructor(e,t,r={},s=zr){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ur;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(ur||(ur={}));class Ce{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ce.syncState(this.state,s,i,o),this.pendingDiffs.forEach(a=>{this.state=Ce.syncDiff(this.state,a,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ce.syncDiff(this.state,s,i,o),l())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),o=this.transformState(t),l={},a={};return this.map(i,(u,c)=>{o[u]||(a[u]=c)}),this.map(o,(u,c)=>{const h=i[u];if(h){const d=c.map(b=>b.presence_ref),f=h.map(b=>b.presence_ref),g=c.filter(b=>f.indexOf(b.presence_ref)<0),p=h.filter(b=>d.indexOf(b.presence_ref)<0);g.length>0&&(l[u]=g),p.length>0&&(a[u]=p)}else l[u]=c}),this.syncDiff(i,{joins:l,leaves:a},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(l,a)=>{var u;const c=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(a),c.length>0){const h=e[l].map(f=>f.presence_ref),d=c.filter(f=>h.indexOf(f.presence_ref)<0);e[l].unshift(...d)}r(l,c,a)}),this.map(o,(l,a)=>{let u=e[l];if(!u)return;const c=a.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),e[l]=u,s(l,u,a),u.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var hr;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(hr||(hr={}));var dr;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(dr||(dr={}));var G;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(G||(G={}));class Nt{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=$.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ht(this,F.join,this.params,this.timeout),this.rejoinTimer=new Vr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=$.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=$.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=$.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=$.errored,this.rejoinTimer.scheduleTimeout())}),this._on(F.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Ce(this),this.broadcastEndpointURL=Gr(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o,private:l}}=this.params;this._onError(c=>e==null?void 0:e(G.CHANNEL_ERROR,c)),this._onClose(()=>e==null?void 0:e(G.CLOSED));const a={},u={broadcast:i,presence:o,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&s!==void 0?s:[],private:l};this.socket.accessTokenValue&&(a.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},a)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:c})=>{var h;if(this.socket.setAuth(),c===void 0){e==null||e(G.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,f=(h=d==null?void 0:d.length)!==null&&h!==void 0?h:0,g=[];for(let p=0;p<f;p++){const b=d[p],{filter:{event:y,schema:v,table:m,filter:w}}=b,k=c&&c[p];if(k&&k.event===y&&k.schema===v&&k.table===m&&k.filter===w)g.push(Object.assign(Object.assign({},b),{id:k.id}));else{this.unsubscribe(),this.state=$.errored,e==null||e(G.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(G.SUBSCRIBED);return}}).receive("error",c=>{this.state=$.errored,e==null||e(G.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(G.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,a;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((a=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||a===void 0)&&a.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=$.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(F.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(r=>{const s=new ht(this,F.leave,{},e);s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new ht(this,e,t,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const o=e.toLocaleLowerCase(),{close:l,error:a,leave:u,join:c}=F;if(r&&[l,a,u,c].indexOf(o)>=0&&r!==this._joinRef())return;let d=this._onMessage(o,t,r);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var g,p,b;return((g=f.filter)===null||g===void 0?void 0:g.event)==="*"||((b=(p=f.filter)===null||p===void 0?void 0:p.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===o}).map(f=>f.callback(d,r)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var g,p,b,y,v,m;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const w=f.id,k=(g=f.filter)===null||g===void 0?void 0:g.event;return w&&((p=t.ids)===null||p===void 0?void 0:p.includes(w))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((b=t.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const w=(v=(y=f==null?void 0:f.filter)===null||y===void 0?void 0:y.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return w==="*"||w===((m=t==null?void 0:t.event)===null||m===void 0?void 0:m.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const g=d.data,{schema:p,table:b,commit_timestamp:y,type:v,errors:m}=g;d=Object.assign(Object.assign({},{schema:p,table:b,commit_timestamp:y,eventType:v,new:{},old:{},errors:m}),this._getPayloadRecords(g))}f.callback(d,r)})}_isClosed(){return this.state===$.closed}_isJoined(){return this.state===$.joined}_isJoining(){return this.state===$.joining}_isLeaving(){return this.state===$.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Nt.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(F.close,{},e)}_onError(e){this._on(F.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=$.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=cr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=cr(e.columns,e.old_record)),t}}const fr=()=>{},Rs=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Is{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=_s,this.params={},this.timeout=zr,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=fr,this.ref=0,this.logger=fr,this.conn=null,this.sendBuffer=[],this.serializer=new Ss,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...l)=>we(async()=>{const{default:a}=await Promise.resolve().then(()=>be);return{default:a}},void 0).then(({default:a})=>a(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${Et.websocket}`,this.httpEndpoint=Gr(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,o)=>o(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Vr(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=St),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new js(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ks}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels=this.channels.filter(r=>r._joinRef!==e._joinRef),this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case fe.connecting:return ie.Connecting;case fe.open:return ie.Open;case fe.closing:return ie.Closing;default:return ie.Closed}}isConnected(){return this.connectionState()===ie.Open}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new Nt(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:r,payload:s,ref:i}=e,o=()=>{this.encode(e,l=>{var a;(a=this.conn)===null||a===void 0||a.send(l)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{t&&r.updateJoinPayload({access_token:t,version:this.headers&&this.headers["X-Client-Info"]}),r.joinedOnce&&r._isJoined()&&r._push(F.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(xs,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:o}=t;r==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(l=>l._isMember(r)).forEach(l=>l._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(t))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(F.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([Rs],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class js{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=fe.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class Ft extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function R(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class $s extends Ft{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Pt extends Ft{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Ls=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};const Kr=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>we(async()=>{const{default:r}=await Promise.resolve().then(()=>be);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Bs=()=>Ls(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield we(()=>Promise.resolve().then(()=>be),void 0)).Response:Response}),Ct=n=>{if(Array.isArray(n))return n.map(t=>Ct(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=Ct(r)}),e};var ae=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};const dt=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Ms=(n,e,t)=>ae(void 0,void 0,void 0,function*(){const r=yield Bs();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(s=>{e(new $s(dt(s),n.status||500))}).catch(s=>{e(new Pt(dt(s),s))}):e(new Pt(dt(n),n))}),Ds=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),t))};function Be(n,e,t,r,s,i){return ae(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,Ds(e,r,s,i)).then(a=>{if(!a.ok)throw a;return r!=null&&r.noResolveJson?a:a.json()}).then(a=>o(a)).catch(a=>Ms(a,l,r))})})}function ze(n,e,t,r){return ae(this,void 0,void 0,function*(){return Be(n,"GET",e,t,r)})}function Z(n,e,t,r,s){return ae(this,void 0,void 0,function*(){return Be(n,"POST",e,r,s,t)})}function Us(n,e,t,r,s){return ae(this,void 0,void 0,function*(){return Be(n,"PUT",e,r,s,t)})}function Ns(n,e,t,r){return ae(this,void 0,void 0,function*(){return Be(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function Wr(n,e,t,r,s){return ae(this,void 0,void 0,function*(){return Be(n,"DELETE",e,r,s,t)})}var L=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};const Fs={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},gr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class qs{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Kr(s)}uploadOrUpdate(e,t,r,s){return L(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},gr),s);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const a=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),a&&i.append("metadata",this.encodeMetadata(a)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),a&&i.append("metadata",this.encodeMetadata(a))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,a&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const u=this._removeEmptyFolders(t),c=this._getFinalPath(u),h=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),d=yield h.json();return h.ok?{data:{path:u,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(R(i))return{data:null,error:i};throw i}})}upload(e,t,r){return L(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return L(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let a;const u=Object.assign({upsert:gr.upsert},s),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",u.cacheControl),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",u.cacheControl)):(a=r,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:a,headers:c}),d=yield h.json();return h.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(a){if(R(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e,t){return L(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=yield Z(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new Ft("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(R(r))return{data:null,error:r};throw r}})}update(e,t,r){return L(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return L(this,void 0,void 0,function*(){try{return{data:yield Z(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(R(s))return{data:null,error:s};throw s}})}copy(e,t,r){return L(this,void 0,void 0,function*(){try{return{data:{path:(yield Z(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(R(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return L(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield Z(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(R(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return L(this,void 0,void 0,function*(){try{const s=yield Z(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(R(s))return{data:null,error:s};throw s}})}download(e,t){return L(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield ze(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(R(l))return{data:null,error:l};throw l}})}info(e){return L(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield ze(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Ct(r),error:null}}catch(r){if(R(r))return{data:null,error:r};throw r}})}exists(e){return L(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Ns(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(R(r)&&r instanceof Pt){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});a!==""&&s.push(a);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}remove(e){return L(this,void 0,void 0,function*(){try{return{data:yield Wr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(R(t))return{data:null,error:t};throw t}})}list(e,t,r){return L(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Fs),t),{prefix:e||""});return{data:yield Z(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(R(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Hs="2.7.1",zs={"X-Client-Info":`storage-js/${Hs}`};var ce=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};class Vs{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},zs),t),this.fetch=Kr(r)}listBuckets(){return ce(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(R(e))return{data:null,error:e};throw e}})}getBucket(e){return ce(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(R(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return ce(this,void 0,void 0,function*(){try{return{data:yield Z(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(R(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return ce(this,void 0,void 0,function*(){try{return{data:yield Us(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(R(r))return{data:null,error:r};throw r}})}emptyBucket(e){return ce(this,void 0,void 0,function*(){try{return{data:yield Z(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(R(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ce(this,void 0,void 0,function*(){try{return{data:yield Wr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(R(t))return{data:null,error:t};throw t}})}}class Js extends Vs{constructor(e,t={},r){super(e,t,r)}from(e){return new qs(this.url,this.headers,e,this.fetch)}}const Gs="2.49.9";let Pe="";typeof Deno<"u"?Pe="deno":typeof document<"u"?Pe="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Pe="react-native":Pe="node";const Ks={"X-Client-Info":`supabase-js-${Pe}/${Gs}`},Ws={headers:Ks},Qs={schema:"public"},Ys={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Zs={};var Xs=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};const ei=n=>{let e;return n?e=n:typeof fetch>"u"?e=jr:e=fetch,(...t)=>e(...t)},ti=()=>typeof Headers>"u"?$r:Headers,ri=(n,e,t)=>{const r=ei(t),s=ti();return(i,o)=>Xs(void 0,void 0,void 0,function*(){var l;const a=(l=yield e())!==null&&l!==void 0?l:n;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",n),u.has("Authorization")||u.set("Authorization",`Bearer ${a}`),r(i,Object.assign(Object.assign({},o),{headers:u}))})};var ni=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};function si(n){return n.endsWith("/")?n:n+"/"}function ii(n,e){var t,r;const{db:s,auth:i,realtime:o,global:l}=n,{db:a,auth:u,realtime:c,global:h}=e,d={db:Object.assign(Object.assign({},a),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},c),o),global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>ni(this,void 0,void 0,function*(){return""})};return n.accessToken?d.accessToken=n.accessToken:delete d.accessToken,d}const Qr="2.69.1",de=30*1e3,At=3,ft=At*de,oi="http://localhost:9999",ai="supabase.auth.token",li={"X-Client-Info":`gotrue-js/${Qr}`},Ot="X-Supabase-Api-Version",Yr={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ci=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ui=6e5;class qt extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function S(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class hi extends qt{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function di(n){return S(n)&&n.name==="AuthApiError"}class Zr extends qt{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class te extends qt{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class Q extends te{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function fi(n){return S(n)&&n.name==="AuthSessionMissingError"}class gt extends te{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class De extends te{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ue extends te{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function gi(n){return S(n)&&n.name==="AuthImplicitGrantRedirectError"}class pr extends te{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Rt extends te{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function pt(n){return S(n)&&n.name==="AuthRetryableFetchError"}class mr extends te{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class Ae extends te{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const vr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),yr=` 	
\r=`.split(""),pi=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<yr.length;e+=1)n[yr[e].charCodeAt(0)]=-2;for(let e=0;e<vr.length;e+=1)n[vr[e].charCodeAt(0)]=e;return n})();function Xr(n,e,t){const r=pi[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function wr(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{yi(o,r,t)};for(let o=0;o<n.length;o+=1)Xr(n.charCodeAt(o),s,i);return e.join("")}function mi(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function vi(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}mi(r,e)}}function yi(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if(!(n>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function wi(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)Xr(n.charCodeAt(s),t,r);return new Uint8Array(e)}function bi(n){const e=[];return vi(n,t=>e.push(t)),new Uint8Array(e)}function _i(n){return Math.round(Date.now()/1e3)+n}function ki(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const H=()=>typeof window<"u"&&typeof document<"u",ne={tested:!1,writable:!1},Oe=()=>{if(!H())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ne.tested)return ne.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),ne.tested=!0,ne.writable=!0}catch{ne.tested=!0,ne.writable=!1}return ne.writable};function xi(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const en=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>we(async()=>{const{default:r}=await Promise.resolve().then(()=>be);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Si=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",tn=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Ne=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Fe=async(n,e)=>{await n.removeItem(e)};class et{constructor(){this.promise=new et.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}et.promiseConstructor=Promise;function mt(n){const e=n.split(".");if(e.length!==3)throw new Ae("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!ci.test(e[r]))throw new Ae("JWT not in base64url format");return{header:JSON.parse(wr(e[0])),payload:JSON.parse(wr(e[1])),signature:wi(e[2]),raw:{header:e[0],payload:e[1]}}}async function Ei(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Ti(n,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await n(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function Pi(n){return("0"+n.toString(16)).substr(-2)}function Ci(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,Pi).join("")}async function Ai(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function Oi(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Ai(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ue(n,e,t=!1){const r=Ci();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await tn(n,`${e}-code-verifier`,s);const i=await Oi(r);return[i,r===i?"plain":"s256"]}const Ri=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ii(n){const e=n.headers.get(Ot);if(!e||!e.match(Ri))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function ji(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function $i(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var Li=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const se=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Bi=[502,503,504];async function br(n){var e;if(!Si(n))throw new Rt(se(n),0);if(Bi.includes(n.status))throw new Rt(se(n),n.status);let t;try{t=await n.json()}catch(i){throw new Zr(se(i),i)}let r;const s=Ii(n);if(s&&s.getTime()>=Yr["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new mr(se(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Q}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new mr(se(t),n.status,t.weak_password.reasons);throw new hi(se(t),n.status||500,r)}const Mi=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function E(n,e,t,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[Ot]||(i[Ot]=Yr["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",a=await Di(n,e,t+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(a):{data:Object.assign({},a),error:null}}async function Di(n,e,t,r,s,i){const o=Mi(e,r,s,i);let l;try{l=await n(t,Object.assign({},o))}catch(a){throw console.error(a),new Rt(se(a),0)}if(l.ok||await br(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(a){await br(a)}}function Y(n){var e;let t=null;qi(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=_i(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function _r(n){const e=Y(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function X(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Ui(n){return{data:n,error:null}}function Ni(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i}=n,o=Li(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i},a=Object.assign({},o);return{data:{properties:l,user:a},error:null}}function Fi(n){return n}function qi(n){return n.access_token&&n.refresh_token&&n.expires_in}var Hi=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class zi{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=en(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await E(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(S(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await E(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:X})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Hi(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await E(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Ni,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(S(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await E(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:X})}catch(t){if(S(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,o,l,a;try{const u={nextPage:null,lastPage:0,total:0},c=await E(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Fi});if(c.error)throw c.error;const h=await c.json(),d=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(a=(l=c.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return f.length>0&&(f.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(g.split(";")[1].split("=")[1]);u[`${b}Page`]=p}),u.total=parseInt(d)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(S(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await E(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:X})}catch(t){if(S(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await E(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:X})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await E(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:X})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await E(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(S(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await E(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(S(t))return{data:null,error:t};throw t}}}const Vi={getItem:n=>Oe()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{Oe()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{Oe()&&globalThis.localStorage.removeItem(n)}};function kr(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function Ji(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const he={debug:!!(globalThis&&Oe()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class rn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Gi extends rn{}async function Ki(n,e,t){he.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),he.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){he.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{he.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw he.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Gi(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(he.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Ji();const Wi={url:oi,storageKey:ai,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:li,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function xr(n,e,t){return await t()}class je{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=je.nextInstanceID,je.nextInstanceID+=1,this.instanceID>0&&H()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Wi),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new zi({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=en(s.fetch),this.lock=s.lock||xr,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:H()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Ki:this.lock=xr,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Oe()?this.storage=Vi:(this.memoryStorage={},this.storage=kr(this.memoryStorage)):(this.memoryStorage={},this.storage=kr(this.memoryStorage)),H()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Qr}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=xi(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),H()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),gi(i)){const a=(e=i.details)===null||e===void 0?void 0:e.code;if(a==="identity_already_exists"||a==="identity_not_found"||a==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return S(t)?{error:t}:{error:new Zr("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const i=await E(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Y}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(i){if(S(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,s;try{let i;if("email"in e){const{email:c,password:h,options:d}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await ue(this.storage,this.storageKey)),i=await E(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:c,password:h,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:g},xform:Y})}else if("phone"in e){const{phone:c,password:h,options:d}=e;i=await E(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},channel:(s=d==null?void 0:d.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Y})}else throw new De("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(i){if(S(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:l}=e;t=await E(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:_r})}else if("phone"in e){const{phone:i,password:o,options:l}=e;t=await E(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:_r})}else throw new De("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new gt}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Ne(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:i,error:o}=await E(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Y});if(await Fe(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new gt}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(S(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:i,nonce:o}=e,l=await E(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Y}),{data:a,error:u}=l;return u?{data:{user:null,session:null},error:u}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new gt}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:u})}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,i,o;try{if("email"in e){const{email:l,options:a}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await ue(this.storage,this.storageKey));const{error:h}=await E(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=a==null?void 0:a.data)!==null&&t!==void 0?t:{},create_user:(r=a==null?void 0:a.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:a}=e,{data:u,error:c}=await E(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=a==null?void 0:a.data)!==null&&s!==void 0?s:{},create_user:(i=a==null?void 0:a.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(o=a==null?void 0:a.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new De("You must provide either an email or phone number.")}catch(l){if(S(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,r;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await E(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Y});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const a=o.session,u=o.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(S(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await ue(this.storage,this.storageKey)),await E(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Ui})}catch(i){if(S(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Q;const{error:s}=await E(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(S(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:o}=await E(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:o,error:l}=await E(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new De("You must provide either an email or phone number and a type")}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ne(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<ft:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(a,u,c)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(a,u,c))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await E(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:X}):await this._useSession(async t=>{var r,s,i;const{data:o,error:l}=t;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Q}:await E(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:X})})}catch(t){if(S(t))return fi(t)&&(await this._removeSession(),await Fe(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new Q;const o=s.session;let l=null,a=null;this.flowType==="pkce"&&e.email!=null&&([l,a]=await ue(this.storage,this.storageKey));const{data:u,error:c}=await E(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:a}),jwt:o.access_token,xform:X});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Q;const t=Date.now()/1e3;let r=t,s=!0,i=null;const{payload:o}=mt(e.access_token);if(o.exp&&(r=o.exp,s=r<=t),s){const{session:l,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return{data:{user:null,session:null},error:a};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:a}=await this._getUser(e.access_token);if(a)throw a;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(S(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Q;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!H())throw new Ue("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ue(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new pr("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ue("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new pr("No code detected.");const{data:v,error:m}=await this._exchangeCodeForSession(e.code);if(m)throw m;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:l,expires_at:a,token_type:u}=e;if(!i||!l||!o||!u)throw new Ue("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(l);let d=c+h;a&&(d=parseInt(a));const f=d-c;f*1e3<=de&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const g=d-h;c-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,d,c):c-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,d,c);const{data:p,error:b}=await this._getUser(i);if(b)throw b;const y={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:d,refresh_token:o,token_type:u,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(r){if(S(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ne(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{error:i};const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(di(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Fe(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=ki(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:i},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await ue(this.storage,this.storageKey,!0));try{return await E(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(S(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(S(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:s}=await this._useSession(async i=>{var o,l,a,u,c;const{data:h,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await E(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(s)throw s;return H()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(S(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)throw o;return await E(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(S(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Ti(async s=>(s>0&&await Ei(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await E(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Y})),(s,i)=>{const o=200*Math.pow(2,s);return i&&pt(i)&&Date.now()+o-r<de})}catch(r){if(this._debug(t,"error",r),S(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),H()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await Ne(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const s=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<ft;if(this._debug(t,`session has${s?"":" not"} expired with margin of ${ft}s`),s){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),pt(i)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Q;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new et;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Q;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),S(i)){const o={session:null,error:i};return pt(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(a){i.push(a)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await tn(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Fe(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&H()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),de);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/de);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${de}ms, refresh threshold is ${At} ticks`),s<=At&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof rn)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!H()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await ue(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await E(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(S(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:a,error:u}=await E(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((s=a==null?void 0:a.totp)===null||s===void 0)&&s.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(t){if(S(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:l}=await E(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(t){if(S(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await E(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(S(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],s=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=mt(s.access_token);let l=null;o.aal&&(l=o.aal);let a=l;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(a="aal2");const c=o.amr||[];return{data:{currentLevel:l,nextLevel:a,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(o=>o.kid===e);if(r||(r=this.jwks.keys.find(o=>o.kid===e),r&&this.jwks_cached_at+ui>Date.now()))return r;const{data:s,error:i}=await E(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new Ae("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),r=s.keys.find(o=>o.kid===e),!r)throw new Ae("No matching signing key found in JWKS");return r}async getClaims(e,t={keys:[]}){try{let r=e;if(!r){const{data:f,error:g}=await this.getSession();if(g||!f.session)return{data:null,error:g};r=f.session.access_token}const{header:s,payload:i,signature:o,raw:{header:l,payload:a}}=mt(r);if(ji(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:f}=await this.getUser(r);if(f)throw f;return{data:{claims:i,header:s,signature:o},error:null}}const u=$i(s.alg),c=await this.fetchJwk(s.kid,t),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,bi(`${l}.${a}`)))throw new Ae("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(r){if(S(r))return{data:null,error:r};throw r}}}je.nextInstanceID=0;const Qi=je;class Yi extends Qi{constructor(e){super(e)}}var Zi=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(l,a)}u((r=r.apply(n,e||[])).next())})};class Xi{constructor(e,t,r){var s,i,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const l=si(e),a=new URL(l);this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const u=`sb-${a.hostname.split(".")[0]}-auth-token`,c={db:Qs,realtime:Zs,auth:Object.assign(Object.assign({},Ys),{storageKey:u}),global:Ws},h=ii(r??{},c);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=ri(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new ws(new URL("rest/v1",a).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new Kn(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Js(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Zi(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:i,flowType:o,lock:l,debug:a},u,c){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Yi({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:o,lock:l,debug:a,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Is(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const eo=(n,e,t)=>new Xi(n,e,t),to="https://sssanglcqfnciyipjngx.supabase.co",ro="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNzc2FuZ2xjcWZuY2l5aXBqbmd4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg1ODgyNjIsImV4cCI6MjA2NDE2NDI2Mn0.L97-7NcxKWpMoMxVKTeOSL7VRt-U7cq2uk3MgjF1sz0",no=eo(to,ro),so={"metabolic-weight":"Metabolic & Weight Management","womens-health":"Women's Health Services","health-screening":"Health Screening & Monitoring",vaccinations:"Core Vaccinations","nhs-services":"NHS Clinical Services","mens-health":"Men's Health & Performance","travel-health":"Travel Health Services","gut-health":"Gut Health & Digestive Wellness"},io={"Morning (9am-12pm)":"morning","Afternoon (12pm-5pm)":"afternoon","Evening (5pm-7pm)":"evening"};class oo{constructor(){this.baseURL="https://cornwells-services.netlify.app",this.bitlyToken=null,this.branches={wx:"Weeping Cross",gw:"Great Wyrley",hc:"Holmcroft",wol:"Wolstanton",bc:"Beaconside",nc:"Newcastle",sv:"Silverdale",st4:"Stoke City Centre",ch:"Chadsmoor",ah:"Abbey Hulton"},this.services={"health-screening":"Health Screening & Monitoring","mens-health":"Men's Health Services","womens-health":"Women's Health Services","metabolic-weight":"Metabolic & Weight Management","travel-health":"Travel Health Services","nhs-services":"Enhanced NHS Services",vaccinations:"Core Vaccinations","gut-health":"Gut Health & Digestive Wellness","family-health":"Family Health Hub","mental-health":"Mental Health & Wellbeing"},this.materials={poster:"A4 Poster",flyer:"A5 Flyer",counter:"Counter Card",window:"Window Cling",bag:"Prescription Bag Belt",shelf:"Shelf Wobbler",partner:"Partner Material"}}generateTrackingURL(e,t,r,s="a",i=null){const o=new URLSearchParams({utm_source:r,utm_medium:t,utm_campaign:e,utm_term:s,utm_content:i||"qr"});return`${this.baseURL}/${e}?${o.toString()}`}async generateShortURL(e,t=null){if(!this.bitlyToken)return console.warn("Bitly token not configured, returning long URL"),e;try{return(await(await fetch("https://api-ssl.bitly.com/v4/shorten",{method:"POST",headers:{Authorization:`Bearer ${this.bitlyToken}`,"Content-Type":"application/json"},body:JSON.stringify({long_url:e,custom_bitlinks:t?[`bit.ly/cornwells-${t}`]:void 0})})).json()).link||e}catch(r){return console.error("Bitly shortening failed:",r),e}}async generateQRWithTracking(e,t,r,s="a"){const i=this.generateTrackingURL(e,t,r,s),o=await this.generateShortURL(i,`${e}-${t}-${s}`);return{qrCode:await(await we(()=>Promise.resolve().then(()=>Xo),void 0)).toDataURL(o,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"}),trackingURL:i,shortURL:o,metadata:{service:this.services[e],branch:this.branches[t],material:this.materials[r],version:s}}}async generateServiceQRBatch(e){const t=[];for(const[r,s]of Object.entries(this.branches))for(const[i,o]of Object.entries(this.materials))for(const l of["a","b","c"]){const a=await this.generateQRWithTracking(e,r,i,l);t.push({id:`${e}-${r}-${i}-${l}`,...a})}return t}captureUTMParameters(){const e=new URLSearchParams(window.location.search),t={};return["utm_source","utm_medium","utm_campaign","utm_term","utm_content"].forEach(r=>{e.has(r)&&(t[r]=e.get(r))}),Object.keys(t).length>0&&sessionStorage.setItem("cornwells_utm",JSON.stringify(t)),t}getStoredUTMData(){const e=sessionStorage.getItem("cornwells_utm");return e?JSON.parse(e):{}}trackEvent(e,t={}){typeof gtag<"u"&&gtag("event",e,{event_category:"mvp_services",...t,...this.getStoredUTMData()})}trackPageView(e=null){this.captureUTMParameters(),typeof gtag<"u"&&gtag("config","GA_MEASUREMENT_ID",{page_title:e?`${e} - Cornwells Services`:"Cornwells Services",page_location:window.location.href,custom_map:{custom_parameter_1:"utm_source",custom_parameter_2:"utm_medium",custom_parameter_3:"utm_campaign"}})}trackBookingConversion(e,t){this.trackEvent("consultation_booking",{event_category:"conversion",event_label:e,value:1,service_name:this.services[e],booking_method:"online_form"})}generateDashboardData(){return{totalServices:Object.keys(this.services).length,totalBranches:Object.keys(this.branches).length,totalMaterials:Object.keys(this.materials).length,totalQRCodes:Object.keys(this.services).length*Object.keys(this.branches).length*Object.keys(this.materials).length*3,trackingURLFormat:"utm_source={material}&utm_medium={branch}&utm_campaign={service}&utm_term={version}&utm_content=qr"}}}const N=new oo;typeof window<"u"&&N.captureUTMParameters();var oe={},ao=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},nn={},M={};let Ht;const lo=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];M.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};M.getSymbolTotalCodewords=function(e){return lo[e]};M.getBCHDigit=function(n){let e=0;for(;n!==0;)e++,n>>>=1;return e};M.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');Ht=e};M.isKanjiModeEnabled=function(){return typeof Ht<"u"};M.toSJIS=function(e){return Ht(e)};var tt={};(function(n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2};function e(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+t)}}n.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},n.from=function(r,s){if(n.isValid(r))return r;try{return e(r)}catch{return s}}})(tt);function sn(){this.buffer=[],this.length=0}sn.prototype={get:function(n){const e=Math.floor(n/8);return(this.buffer[e]>>>7-n%8&1)===1},put:function(n,e){for(let t=0;t<e;t++)this.putBit((n>>>e-t-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),n&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var co=sn;function Me(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}Me.prototype.set=function(n,e,t,r){const s=n*this.size+e;this.data[s]=t,r&&(this.reservedBit[s]=!0)};Me.prototype.get=function(n,e){return this.data[n*this.size+e]};Me.prototype.xor=function(n,e,t){this.data[n*this.size+e]^=t};Me.prototype.isReserved=function(n,e){return this.reservedBit[n*this.size+e]};var uo=Me,on={};(function(n){const e=M.getSymbolSize;n.getRowColCoords=function(r){if(r===1)return[];const s=Math.floor(r/7)+2,i=e(r),o=i===145?26:Math.ceil((i-13)/(2*s-2))*2,l=[i-7];for(let a=1;a<s-1;a++)l[a]=l[a-1]-o;return l.push(6),l.reverse()},n.getPositions=function(r){const s=[],i=n.getRowColCoords(r),o=i.length;for(let l=0;l<o;l++)for(let a=0;a<o;a++)l===0&&a===0||l===0&&a===o-1||l===o-1&&a===0||s.push([i[l],i[a]]);return s}})(on);var an={};const ho=M.getSymbolSize,Sr=7;an.getPositions=function(e){const t=ho(e);return[[0,0],[t-Sr,0],[0,t-Sr]]};var ln={};(function(n){n.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};n.isValid=function(s){return s!=null&&s!==""&&!isNaN(s)&&s>=0&&s<=7},n.from=function(s){return n.isValid(s)?parseInt(s,10):void 0},n.getPenaltyN1=function(s){const i=s.size;let o=0,l=0,a=0,u=null,c=null;for(let h=0;h<i;h++){l=a=0,u=c=null;for(let d=0;d<i;d++){let f=s.get(h,d);f===u?l++:(l>=5&&(o+=e.N1+(l-5)),u=f,l=1),f=s.get(d,h),f===c?a++:(a>=5&&(o+=e.N1+(a-5)),c=f,a=1)}l>=5&&(o+=e.N1+(l-5)),a>=5&&(o+=e.N1+(a-5))}return o},n.getPenaltyN2=function(s){const i=s.size;let o=0;for(let l=0;l<i-1;l++)for(let a=0;a<i-1;a++){const u=s.get(l,a)+s.get(l,a+1)+s.get(l+1,a)+s.get(l+1,a+1);(u===4||u===0)&&o++}return o*e.N2},n.getPenaltyN3=function(s){const i=s.size;let o=0,l=0,a=0;for(let u=0;u<i;u++){l=a=0;for(let c=0;c<i;c++)l=l<<1&2047|s.get(u,c),c>=10&&(l===1488||l===93)&&o++,a=a<<1&2047|s.get(c,u),c>=10&&(a===1488||a===93)&&o++}return o*e.N3},n.getPenaltyN4=function(s){let i=0;const o=s.data.length;for(let a=0;a<o;a++)i+=s.data[a];return Math.abs(Math.ceil(i*100/o/5)-10)*e.N4};function t(r,s,i){switch(r){case n.Patterns.PATTERN000:return(s+i)%2===0;case n.Patterns.PATTERN001:return s%2===0;case n.Patterns.PATTERN010:return i%3===0;case n.Patterns.PATTERN011:return(s+i)%3===0;case n.Patterns.PATTERN100:return(Math.floor(s/2)+Math.floor(i/3))%2===0;case n.Patterns.PATTERN101:return s*i%2+s*i%3===0;case n.Patterns.PATTERN110:return(s*i%2+s*i%3)%2===0;case n.Patterns.PATTERN111:return(s*i%3+(s+i)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}n.applyMask=function(s,i){const o=i.size;for(let l=0;l<o;l++)for(let a=0;a<o;a++)i.isReserved(a,l)||i.xor(a,l,t(s,a,l))},n.getBestMask=function(s,i){const o=Object.keys(n.Patterns).length;let l=0,a=1/0;for(let u=0;u<o;u++){i(u),n.applyMask(u,s);const c=n.getPenaltyN1(s)+n.getPenaltyN2(s)+n.getPenaltyN3(s)+n.getPenaltyN4(s);n.applyMask(u,s),c<a&&(a=c,l=u)}return l}})(ln);var rt={};const ee=tt,qe=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],He=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];rt.getBlocksCount=function(e,t){switch(t){case ee.L:return qe[(e-1)*4+0];case ee.M:return qe[(e-1)*4+1];case ee.Q:return qe[(e-1)*4+2];case ee.H:return qe[(e-1)*4+3];default:return}};rt.getTotalCodewordsCount=function(e,t){switch(t){case ee.L:return He[(e-1)*4+0];case ee.M:return He[(e-1)*4+1];case ee.Q:return He[(e-1)*4+2];case ee.H:return He[(e-1)*4+3];default:return}};var cn={},nt={};const Re=new Uint8Array(512),Ve=new Uint8Array(256);(function(){let e=1;for(let t=0;t<255;t++)Re[t]=e,Ve[e]=t,e<<=1,e&256&&(e^=285);for(let t=255;t<512;t++)Re[t]=Re[t-255]})();nt.log=function(e){if(e<1)throw new Error("log("+e+")");return Ve[e]};nt.exp=function(e){return Re[e]};nt.mul=function(e,t){return e===0||t===0?0:Re[Ve[e]+Ve[t]]};(function(n){const e=nt;n.mul=function(r,s){const i=new Uint8Array(r.length+s.length-1);for(let o=0;o<r.length;o++)for(let l=0;l<s.length;l++)i[o+l]^=e.mul(r[o],s[l]);return i},n.mod=function(r,s){let i=new Uint8Array(r);for(;i.length-s.length>=0;){const o=i[0];for(let a=0;a<s.length;a++)i[a]^=e.mul(s[a],o);let l=0;for(;l<i.length&&i[l]===0;)l++;i=i.slice(l)}return i},n.generateECPolynomial=function(r){let s=new Uint8Array([1]);for(let i=0;i<r;i++)s=n.mul(s,new Uint8Array([1,e.exp(i)]));return s}})(cn);const un=cn;function zt(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}zt.prototype.initialize=function(e){this.degree=e,this.genPoly=un.generateECPolynomial(this.degree)};zt.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const r=un.mod(t,this.genPoly),s=this.degree-r.length;if(s>0){const i=new Uint8Array(this.degree);return i.set(r,s),i}return r};var fo=zt,hn={},re={},Vt={};Vt.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var J={};const dn="[0-9]+",go="[A-Z $%*+\\-./:]+";let $e="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";$e=$e.replace(/u/g,"\\u");const po="(?:(?![A-Z0-9 $%*+\\-./:]|"+$e+`)(?:.|[\r
]))+`;J.KANJI=new RegExp($e,"g");J.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");J.BYTE=new RegExp(po,"g");J.NUMERIC=new RegExp(dn,"g");J.ALPHANUMERIC=new RegExp(go,"g");const mo=new RegExp("^"+$e+"$"),vo=new RegExp("^"+dn+"$"),yo=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");J.testKanji=function(e){return mo.test(e)};J.testNumeric=function(e){return vo.test(e)};J.testAlphanumeric=function(e){return yo.test(e)};(function(n){const e=Vt,t=J;n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},n.getBestModeForData=function(i){return t.testNumeric(i)?n.NUMERIC:t.testAlphanumeric(i)?n.ALPHANUMERIC:t.testKanji(i)?n.KANJI:n.BYTE},n.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},n.isValid=function(i){return i&&i.bit&&i.ccBits};function r(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+s)}}n.from=function(i,o){if(n.isValid(i))return i;try{return r(i)}catch{return o}}})(re);(function(n){const e=M,t=rt,r=tt,s=re,i=Vt,o=7973,l=e.getBCHDigit(o);function a(d,f,g){for(let p=1;p<=40;p++)if(f<=n.getCapacity(p,g,d))return p}function u(d,f){return s.getCharCountIndicator(d,f)+4}function c(d,f){let g=0;return d.forEach(function(p){const b=u(p.mode,f);g+=b+p.getBitsLength()}),g}function h(d,f){for(let g=1;g<=40;g++)if(c(d,g)<=n.getCapacity(g,f,s.MIXED))return g}n.from=function(f,g){return i.isValid(f)?parseInt(f,10):g},n.getCapacity=function(f,g,p){if(!i.isValid(f))throw new Error("Invalid QR Code version");typeof p>"u"&&(p=s.BYTE);const b=e.getSymbolTotalCodewords(f),y=t.getTotalCodewordsCount(f,g),v=(b-y)*8;if(p===s.MIXED)return v;const m=v-u(p,f);switch(p){case s.NUMERIC:return Math.floor(m/10*3);case s.ALPHANUMERIC:return Math.floor(m/11*2);case s.KANJI:return Math.floor(m/13);case s.BYTE:default:return Math.floor(m/8)}},n.getBestVersionForData=function(f,g){let p;const b=r.from(g,r.M);if(Array.isArray(f)){if(f.length>1)return h(f,b);if(f.length===0)return 1;p=f[0]}else p=f;return a(p.mode,p.getLength(),b)},n.getEncodedBits=function(f){if(!i.isValid(f)||f<7)throw new Error("Invalid QR Code version");let g=f<<12;for(;e.getBCHDigit(g)-l>=0;)g^=o<<e.getBCHDigit(g)-l;return f<<12|g}})(hn);var fn={};const It=M,gn=1335,wo=21522,Er=It.getBCHDigit(gn);fn.getEncodedBits=function(e,t){const r=e.bit<<3|t;let s=r<<10;for(;It.getBCHDigit(s)-Er>=0;)s^=gn<<It.getBCHDigit(s)-Er;return(r<<10|s)^wo};var pn={};const bo=re;function pe(n){this.mode=bo.NUMERIC,this.data=n.toString()}pe.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};pe.prototype.getLength=function(){return this.data.length};pe.prototype.getBitsLength=function(){return pe.getBitsLength(this.data.length)};pe.prototype.write=function(e){let t,r,s;for(t=0;t+3<=this.data.length;t+=3)r=this.data.substr(t,3),s=parseInt(r,10),e.put(s,10);const i=this.data.length-t;i>0&&(r=this.data.substr(t),s=parseInt(r,10),e.put(s,i*3+1))};var _o=pe;const ko=re,vt=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function me(n){this.mode=ko.ALPHANUMERIC,this.data=n}me.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};me.prototype.getLength=function(){return this.data.length};me.prototype.getBitsLength=function(){return me.getBitsLength(this.data.length)};me.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let r=vt.indexOf(this.data[t])*45;r+=vt.indexOf(this.data[t+1]),e.put(r,11)}this.data.length%2&&e.put(vt.indexOf(this.data[t]),6)};var xo=me;const So=re;function ve(n){this.mode=So.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}ve.getBitsLength=function(e){return e*8};ve.prototype.getLength=function(){return this.data.length};ve.prototype.getBitsLength=function(){return ve.getBitsLength(this.data.length)};ve.prototype.write=function(n){for(let e=0,t=this.data.length;e<t;e++)n.put(this.data[e],8)};var Eo=ve;const To=re,Po=M;function ye(n){this.mode=To.KANJI,this.data=n}ye.getBitsLength=function(e){return e*13};ye.prototype.getLength=function(){return this.data.length};ye.prototype.getBitsLength=function(){return ye.getBitsLength(this.data.length)};ye.prototype.write=function(n){let e;for(e=0;e<this.data.length;e++){let t=Po.toSJIS(this.data[e]);if(t>=33088&&t<=40956)t-=33088;else if(t>=57408&&t<=60351)t-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);t=(t>>>8&255)*192+(t&255),n.put(t,13)}};var Co=ye,mn={exports:{}};(function(n){var e={single_source_shortest_paths:function(t,r,s){var i={},o={};o[r]=0;var l=e.PriorityQueue.make();l.push(r,0);for(var a,u,c,h,d,f,g,p,b;!l.empty();){a=l.pop(),u=a.value,h=a.cost,d=t[u]||{};for(c in d)d.hasOwnProperty(c)&&(f=d[c],g=h+f,p=o[c],b=typeof o[c]>"u",(b||p>g)&&(o[c]=g,l.push(c,g),i[c]=u))}if(typeof s<"u"&&typeof o[s]>"u"){var y=["Could not find a path from ",r," to ",s,"."].join("");throw new Error(y)}return i},extract_shortest_path_from_predecessor_list:function(t,r){for(var s=[],i=r;i;)s.push(i),t[i],i=t[i];return s.reverse(),s},find_path:function(t,r,s){var i=e.single_source_shortest_paths(t,r,s);return e.extract_shortest_path_from_predecessor_list(i,s)},PriorityQueue:{make:function(t){var r=e.PriorityQueue,s={},i;t=t||{};for(i in r)r.hasOwnProperty(i)&&(s[i]=r[i]);return s.queue=[],s.sorter=t.sorter||r.default_sorter,s},default_sorter:function(t,r){return t.cost-r.cost},push:function(t,r){var s={value:t,cost:r};this.queue.push(s),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};n.exports=e})(mn);var Ao=mn.exports;(function(n){const e=re,t=_o,r=xo,s=Eo,i=Co,o=J,l=M,a=Ao;function u(y){return unescape(encodeURIComponent(y)).length}function c(y,v,m){const w=[];let k;for(;(k=y.exec(m))!==null;)w.push({data:k[0],index:k.index,mode:v,length:k[0].length});return w}function h(y){const v=c(o.NUMERIC,e.NUMERIC,y),m=c(o.ALPHANUMERIC,e.ALPHANUMERIC,y);let w,k;return l.isKanjiModeEnabled()?(w=c(o.BYTE,e.BYTE,y),k=c(o.KANJI,e.KANJI,y)):(w=c(o.BYTE_KANJI,e.BYTE,y),k=[]),v.concat(m,w,k).sort(function(P,I){return P.index-I.index}).map(function(P){return{data:P.data,mode:P.mode,length:P.length}})}function d(y,v){switch(v){case e.NUMERIC:return t.getBitsLength(y);case e.ALPHANUMERIC:return r.getBitsLength(y);case e.KANJI:return i.getBitsLength(y);case e.BYTE:return s.getBitsLength(y)}}function f(y){return y.reduce(function(v,m){const w=v.length-1>=0?v[v.length-1]:null;return w&&w.mode===m.mode?(v[v.length-1].data+=m.data,v):(v.push(m),v)},[])}function g(y){const v=[];for(let m=0;m<y.length;m++){const w=y[m];switch(w.mode){case e.NUMERIC:v.push([w,{data:w.data,mode:e.ALPHANUMERIC,length:w.length},{data:w.data,mode:e.BYTE,length:w.length}]);break;case e.ALPHANUMERIC:v.push([w,{data:w.data,mode:e.BYTE,length:w.length}]);break;case e.KANJI:v.push([w,{data:w.data,mode:e.BYTE,length:u(w.data)}]);break;case e.BYTE:v.push([{data:w.data,mode:e.BYTE,length:u(w.data)}])}}return v}function p(y,v){const m={},w={start:{}};let k=["start"];for(let x=0;x<y.length;x++){const P=y[x],I=[];for(let j=0;j<P.length;j++){const T=P[j],D=""+x+j;I.push(D),m[D]={node:T,lastCount:0},w[D]={};for(let W=0;W<k.length;W++){const O=k[W];m[O]&&m[O].node.mode===T.mode?(w[O][D]=d(m[O].lastCount+T.length,T.mode)-d(m[O].lastCount,T.mode),m[O].lastCount+=T.length):(m[O]&&(m[O].lastCount=T.length),w[O][D]=d(T.length,T.mode)+4+e.getCharCountIndicator(T.mode,v))}}k=I}for(let x=0;x<k.length;x++)w[k[x]].end=0;return{map:w,table:m}}function b(y,v){let m;const w=e.getBestModeForData(y);if(m=e.from(v,w),m!==e.BYTE&&m.bit<w.bit)throw new Error('"'+y+'" cannot be encoded with mode '+e.toString(m)+`.
 Suggested mode is: `+e.toString(w));switch(m===e.KANJI&&!l.isKanjiModeEnabled()&&(m=e.BYTE),m){case e.NUMERIC:return new t(y);case e.ALPHANUMERIC:return new r(y);case e.KANJI:return new i(y);case e.BYTE:return new s(y)}}n.fromArray=function(v){return v.reduce(function(m,w){return typeof w=="string"?m.push(b(w,null)):w.data&&m.push(b(w.data,w.mode)),m},[])},n.fromString=function(v,m){const w=h(v,l.isKanjiModeEnabled()),k=g(w),x=p(k,m),P=a.find_path(x.map,"start","end"),I=[];for(let j=1;j<P.length-1;j++)I.push(x.table[P[j]].node);return n.fromArray(f(I))},n.rawSplit=function(v){return n.fromArray(h(v,l.isKanjiModeEnabled()))}})(pn);const st=M,yt=tt,Oo=co,Ro=uo,Io=on,jo=an,jt=ln,$t=rt,$o=fo,Je=hn,Lo=fn,Bo=re,wt=pn;function Mo(n,e){const t=n.size,r=jo.getPositions(e);for(let s=0;s<r.length;s++){const i=r[s][0],o=r[s][1];for(let l=-1;l<=7;l++)if(!(i+l<=-1||t<=i+l))for(let a=-1;a<=7;a++)o+a<=-1||t<=o+a||(l>=0&&l<=6&&(a===0||a===6)||a>=0&&a<=6&&(l===0||l===6)||l>=2&&l<=4&&a>=2&&a<=4?n.set(i+l,o+a,!0,!0):n.set(i+l,o+a,!1,!0))}}function Do(n){const e=n.size;for(let t=8;t<e-8;t++){const r=t%2===0;n.set(t,6,r,!0),n.set(6,t,r,!0)}}function Uo(n,e){const t=Io.getPositions(e);for(let r=0;r<t.length;r++){const s=t[r][0],i=t[r][1];for(let o=-2;o<=2;o++)for(let l=-2;l<=2;l++)o===-2||o===2||l===-2||l===2||o===0&&l===0?n.set(s+o,i+l,!0,!0):n.set(s+o,i+l,!1,!0)}}function No(n,e){const t=n.size,r=Je.getEncodedBits(e);let s,i,o;for(let l=0;l<18;l++)s=Math.floor(l/3),i=l%3+t-8-3,o=(r>>l&1)===1,n.set(s,i,o,!0),n.set(i,s,o,!0)}function bt(n,e,t){const r=n.size,s=Lo.getEncodedBits(e,t);let i,o;for(i=0;i<15;i++)o=(s>>i&1)===1,i<6?n.set(i,8,o,!0):i<8?n.set(i+1,8,o,!0):n.set(r-15+i,8,o,!0),i<8?n.set(8,r-i-1,o,!0):i<9?n.set(8,15-i-1+1,o,!0):n.set(8,15-i-1,o,!0);n.set(r-8,8,1,!0)}function Fo(n,e){const t=n.size;let r=-1,s=t-1,i=7,o=0;for(let l=t-1;l>0;l-=2)for(l===6&&l--;;){for(let a=0;a<2;a++)if(!n.isReserved(s,l-a)){let u=!1;o<e.length&&(u=(e[o]>>>i&1)===1),n.set(s,l-a,u),i--,i===-1&&(o++,i=7)}if(s+=r,s<0||t<=s){s-=r,r=-r;break}}}function qo(n,e,t){const r=new Oo;t.forEach(function(a){r.put(a.mode.bit,4),r.put(a.getLength(),Bo.getCharCountIndicator(a.mode,n)),a.write(r)});const s=st.getSymbolTotalCodewords(n),i=$t.getTotalCodewordsCount(n,e),o=(s-i)*8;for(r.getLengthInBits()+4<=o&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);const l=(o-r.getLengthInBits())/8;for(let a=0;a<l;a++)r.put(a%2?17:236,8);return Ho(r,n,e)}function Ho(n,e,t){const r=st.getSymbolTotalCodewords(e),s=$t.getTotalCodewordsCount(e,t),i=r-s,o=$t.getBlocksCount(e,t),l=r%o,a=o-l,u=Math.floor(r/o),c=Math.floor(i/o),h=c+1,d=u-c,f=new $o(d);let g=0;const p=new Array(o),b=new Array(o);let y=0;const v=new Uint8Array(n.buffer);for(let P=0;P<o;P++){const I=P<a?c:h;p[P]=v.slice(g,g+I),b[P]=f.encode(p[P]),g+=I,y=Math.max(y,I)}const m=new Uint8Array(r);let w=0,k,x;for(k=0;k<y;k++)for(x=0;x<o;x++)k<p[x].length&&(m[w++]=p[x][k]);for(k=0;k<d;k++)for(x=0;x<o;x++)m[w++]=b[x][k];return m}function zo(n,e,t,r){let s;if(Array.isArray(n))s=wt.fromArray(n);else if(typeof n=="string"){let u=e;if(!u){const c=wt.rawSplit(n);u=Je.getBestVersionForData(c,t)}s=wt.fromString(n,u||40)}else throw new Error("Invalid data");const i=Je.getBestVersionForData(s,t);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=i;else if(e<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=qo(e,t,s),l=st.getSymbolSize(e),a=new Ro(l);return Mo(a,e),Do(a),Uo(a,e),bt(a,t,0),e>=7&&No(a,e),Fo(a,o),isNaN(r)&&(r=jt.getBestMask(a,bt.bind(null,a,t))),jt.applyMask(r,a),bt(a,t,r),{modules:a,version:e,errorCorrectionLevel:t,maskPattern:r,segments:s}}nn.create=function(e,t){if(typeof e>"u"||e==="")throw new Error("No input text");let r=yt.M,s,i;return typeof t<"u"&&(r=yt.from(t.errorCorrectionLevel,yt.M),s=Je.from(t.version),i=jt.from(t.maskPattern),t.toSJISFunc&&st.setToSJISFunction(t.toSJISFunc)),zo(e,s,r,i)};var vn={},Jt={};(function(n){function e(t){if(typeof t=="number"&&(t=t.toString()),typeof t!="string")throw new Error("Color should be defined as hex string");let r=t.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+t);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(i){return[i,i]}))),r.length===6&&r.push("F","F");const s=parseInt(r.join(""),16);return{r:s>>24&255,g:s>>16&255,b:s>>8&255,a:s&255,hex:"#"+r.slice(0,6).join("")}}n.getOptions=function(r){r||(r={}),r.color||(r.color={});const s=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,i=r.width&&r.width>=21?r.width:void 0,o=r.scale||4;return{width:i,scale:i?4:o,margin:s,color:{dark:e(r.color.dark||"#000000ff"),light:e(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},n.getScale=function(r,s){return s.width&&s.width>=r+s.margin*2?s.width/(r+s.margin*2):s.scale},n.getImageWidth=function(r,s){const i=n.getScale(r,s);return Math.floor((r+s.margin*2)*i)},n.qrToImageData=function(r,s,i){const o=s.modules.size,l=s.modules.data,a=n.getScale(o,i),u=Math.floor((o+i.margin*2)*a),c=i.margin*a,h=[i.color.light,i.color.dark];for(let d=0;d<u;d++)for(let f=0;f<u;f++){let g=(d*u+f)*4,p=i.color.light;if(d>=c&&f>=c&&d<u-c&&f<u-c){const b=Math.floor((d-c)/a),y=Math.floor((f-c)/a);p=h[l[b*o+y]?1:0]}r[g++]=p.r,r[g++]=p.g,r[g++]=p.b,r[g]=p.a}}})(Jt);(function(n){const e=Jt;function t(s,i,o){s.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}n.render=function(i,o,l){let a=l,u=o;typeof a>"u"&&(!o||!o.getContext)&&(a=o,o=void 0),o||(u=r()),a=e.getOptions(a);const c=e.getImageWidth(i.modules.size,a),h=u.getContext("2d"),d=h.createImageData(c,c);return e.qrToImageData(d.data,i,a),t(h,u,c),h.putImageData(d,0,0),u},n.renderToDataURL=function(i,o,l){let a=l;typeof a>"u"&&(!o||!o.getContext)&&(a=o,o=void 0),a||(a={});const u=n.render(i,o,a),c=a.type||"image/png",h=a.rendererOpts||{};return u.toDataURL(c,h.quality)}})(vn);var yn={};const Vo=Jt;function Tr(n,e){const t=n.a/255,r=e+'="'+n.hex+'"';return t<1?r+" "+e+'-opacity="'+t.toFixed(2).slice(1)+'"':r}function _t(n,e,t){let r=n+e;return typeof t<"u"&&(r+=" "+t),r}function Jo(n,e,t){let r="",s=0,i=!1,o=0;for(let l=0;l<n.length;l++){const a=Math.floor(l%e),u=Math.floor(l/e);!a&&!i&&(i=!0),n[l]?(o++,l>0&&a>0&&n[l-1]||(r+=i?_t("M",a+t,.5+u+t):_t("m",s,0),s=0,i=!1),a+1<e&&n[l+1]||(r+=_t("h",o),o=0)):s++}return r}yn.render=function(e,t,r){const s=Vo.getOptions(t),i=e.modules.size,o=e.modules.data,l=i+s.margin*2,a=s.color.light.a?"<path "+Tr(s.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",u="<path "+Tr(s.color.dark,"stroke")+' d="'+Jo(o,i,s.margin)+'"/>',c='viewBox="0 0 '+l+" "+l+'"',d='<svg xmlns="http://www.w3.org/2000/svg" '+(s.width?'width="'+s.width+'" height="'+s.width+'" ':"")+c+' shape-rendering="crispEdges">'+a+u+`</svg>
`;return typeof r=="function"&&r(null,d),d};const Go=ao,Lt=nn,wn=vn,Ko=yn;function Gt(n,e,t,r,s){const i=[].slice.call(arguments,1),o=i.length,l=typeof i[o-1]=="function";if(!l&&!Go())throw new Error("Callback required as last argument");if(l){if(o<2)throw new Error("Too few arguments provided");o===2?(s=t,t=e,e=r=void 0):o===3&&(e.getContext&&typeof s>"u"?(s=r,r=void 0):(s=r,r=t,t=e,e=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(t=e,e=r=void 0):o===2&&!e.getContext&&(r=t,t=e,e=void 0),new Promise(function(a,u){try{const c=Lt.create(t,r);a(n(c,e,r))}catch(c){u(c)}})}try{const a=Lt.create(t,r);s(null,n(a,e,r))}catch(a){s(a)}}var Wo=oe.create=Lt.create,Qo=oe.toCanvas=Gt.bind(null,wn.render),Yo=oe.toDataURL=Gt.bind(null,wn.renderToDataURL),Zo=oe.toString=Gt.bind(null,function(n,e,t){return Ko.render(n,t)});const Xo=Un({__proto__:null,create:Wo,default:oe,toCanvas:Qo,toDataURL:Yo,toString:Zo},[oe]);var bn={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},Kt={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},ea=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],Ge={CSS:{},springs:{}};function z(n,e,t){return Math.min(Math.max(n,e),t)}function Ie(n,e){return n.indexOf(e)>-1}function kt(n,e){return n.apply(null,e)}var _={arr:function(n){return Array.isArray(n)},obj:function(n){return Ie(Object.prototype.toString.call(n),"Object")},pth:function(n){return _.obj(n)&&n.hasOwnProperty("totalLength")},svg:function(n){return n instanceof SVGElement},inp:function(n){return n instanceof HTMLInputElement},dom:function(n){return n.nodeType||_.svg(n)},str:function(n){return typeof n=="string"},fnc:function(n){return typeof n=="function"},und:function(n){return typeof n>"u"},nil:function(n){return _.und(n)||n===null},hex:function(n){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(n)},rgb:function(n){return/^rgb/.test(n)},hsl:function(n){return/^hsl/.test(n)},col:function(n){return _.hex(n)||_.rgb(n)||_.hsl(n)},key:function(n){return!bn.hasOwnProperty(n)&&!Kt.hasOwnProperty(n)&&n!=="targets"&&n!=="keyframes"}};function _n(n){var e=/\(([^)]+)\)/.exec(n);return e?e[1].split(",").map(function(t){return parseFloat(t)}):[]}function kn(n,e){var t=_n(n),r=z(_.und(t[0])?1:t[0],.1,100),s=z(_.und(t[1])?100:t[1],.1,100),i=z(_.und(t[2])?10:t[2],.1,100),o=z(_.und(t[3])?0:t[3],.1,100),l=Math.sqrt(s/r),a=i/(2*Math.sqrt(s*r)),u=a<1?l*Math.sqrt(1-a*a):0,c=1,h=a<1?(a*l+-o)/u:-o+l;function d(g){var p=e?e*g/1e3:g;return a<1?p=Math.exp(-p*a*l)*(c*Math.cos(u*p)+h*Math.sin(u*p)):p=(c+h*p)*Math.exp(-p*l),g===0||g===1?g:1-p}function f(){var g=Ge.springs[n];if(g)return g;for(var p=1/6,b=0,y=0;;)if(b+=p,d(b)===1){if(y++,y>=16)break}else y=0;var v=b*p*1e3;return Ge.springs[n]=v,v}return e?d:f}function ta(n){return n===void 0&&(n=10),function(e){return Math.ceil(z(e,1e-6,1)*n)*(1/n)}}var ra=function(){var n=11,e=1/(n-1);function t(c,h){return 1-3*h+3*c}function r(c,h){return 3*h-6*c}function s(c){return 3*c}function i(c,h,d){return((t(h,d)*c+r(h,d))*c+s(h))*c}function o(c,h,d){return 3*t(h,d)*c*c+2*r(h,d)*c+s(h)}function l(c,h,d,f,g){var p,b,y=0;do b=h+(d-h)/2,p=i(b,f,g)-c,p>0?d=b:h=b;while(Math.abs(p)>1e-7&&++y<10);return b}function a(c,h,d,f){for(var g=0;g<4;++g){var p=o(h,d,f);if(p===0)return h;var b=i(h,d,f)-c;h-=b/p}return h}function u(c,h,d,f){if(!(0<=c&&c<=1&&0<=d&&d<=1))return;var g=new Float32Array(n);if(c!==h||d!==f)for(var p=0;p<n;++p)g[p]=i(p*e,c,d);function b(y){for(var v=0,m=1,w=n-1;m!==w&&g[m]<=y;++m)v+=e;--m;var k=(y-g[m])/(g[m+1]-g[m]),x=v+k*e,P=o(x,c,d);return P>=.001?a(y,x,c,d):P===0?x:l(y,v,v+e,c,d)}return function(y){return c===h&&d===f||y===0||y===1?y:i(b(y),h,f)}}return u}(),xn=function(){var n={linear:function(){return function(r){return r}}},e={Sine:function(){return function(r){return 1-Math.cos(r*Math.PI/2)}},Expo:function(){return function(r){return r?Math.pow(2,10*r-10):0}},Circ:function(){return function(r){return 1-Math.sqrt(1-r*r)}},Back:function(){return function(r){return r*r*(3*r-2)}},Bounce:function(){return function(r){for(var s,i=4;r<((s=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((s*3-2)/22-r,2)}},Elastic:function(r,s){r===void 0&&(r=1),s===void 0&&(s=.5);var i=z(r,1,10),o=z(s,.1,2);return function(l){return l===0||l===1?l:-i*Math.pow(2,10*(l-1))*Math.sin((l-1-o/(Math.PI*2)*Math.asin(1/i))*(Math.PI*2)/o)}}},t=["Quad","Cubic","Quart","Quint"];return t.forEach(function(r,s){e[r]=function(){return function(i){return Math.pow(i,s+2)}}}),Object.keys(e).forEach(function(r){var s=e[r];n["easeIn"+r]=s,n["easeOut"+r]=function(i,o){return function(l){return 1-s(i,o)(1-l)}},n["easeInOut"+r]=function(i,o){return function(l){return l<.5?s(i,o)(l*2)/2:1-s(i,o)(l*-2+2)/2}},n["easeOutIn"+r]=function(i,o){return function(l){return l<.5?(1-s(i,o)(1-l*2))/2:(s(i,o)(l*2-1)+1)/2}}}),n}();function Wt(n,e){if(_.fnc(n))return n;var t=n.split("(")[0],r=xn[t],s=_n(n);switch(t){case"spring":return kn(n,e);case"cubicBezier":return kt(ra,s);case"steps":return kt(ta,s);default:return kt(r,s)}}function Sn(n){try{var e=document.querySelectorAll(n);return e}catch{return}}function it(n,e){for(var t=n.length,r=arguments.length>=2?arguments[1]:void 0,s=[],i=0;i<t;i++)if(i in n){var o=n[i];e.call(r,o,i,n)&&s.push(o)}return s}function ot(n){return n.reduce(function(e,t){return e.concat(_.arr(t)?ot(t):t)},[])}function Pr(n){return _.arr(n)?n:(_.str(n)&&(n=Sn(n)||n),n instanceof NodeList||n instanceof HTMLCollection?[].slice.call(n):[n])}function Qt(n,e){return n.some(function(t){return t===e})}function Yt(n){var e={};for(var t in n)e[t]=n[t];return e}function Bt(n,e){var t=Yt(n);for(var r in n)t[r]=e.hasOwnProperty(r)?e[r]:n[r];return t}function at(n,e){var t=Yt(n);for(var r in e)t[r]=_.und(n[r])?e[r]:n[r];return t}function na(n){var e=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(n);return e?"rgba("+e[1]+",1)":n}function sa(n){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,t=n.replace(e,function(l,a,u,c){return a+a+u+u+c+c}),r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),s=parseInt(r[1],16),i=parseInt(r[2],16),o=parseInt(r[3],16);return"rgba("+s+","+i+","+o+",1)"}function ia(n){var e=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(n)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(n),t=parseInt(e[1],10)/360,r=parseInt(e[2],10)/100,s=parseInt(e[3],10)/100,i=e[4]||1;function o(d,f,g){return g<0&&(g+=1),g>1&&(g-=1),g<1/6?d+(f-d)*6*g:g<1/2?f:g<2/3?d+(f-d)*(2/3-g)*6:d}var l,a,u;if(r==0)l=a=u=s;else{var c=s<.5?s*(1+r):s+r-s*r,h=2*s-c;l=o(h,c,t+1/3),a=o(h,c,t),u=o(h,c,t-1/3)}return"rgba("+l*255+","+a*255+","+u*255+","+i+")"}function oa(n){if(_.rgb(n))return na(n);if(_.hex(n))return sa(n);if(_.hsl(n))return ia(n)}function K(n){var e=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(n);if(e)return e[1]}function aa(n){if(Ie(n,"translate")||n==="perspective")return"px";if(Ie(n,"rotate")||Ie(n,"skew"))return"deg"}function Mt(n,e){return _.fnc(n)?n(e.target,e.id,e.total):n}function V(n,e){return n.getAttribute(e)}function Zt(n,e,t){var r=K(e);if(Qt([t,"deg","rad","turn"],r))return e;var s=Ge.CSS[e+t];if(!_.und(s))return s;var i=100,o=document.createElement(n.tagName),l=n.parentNode&&n.parentNode!==document?n.parentNode:document.body;l.appendChild(o),o.style.position="absolute",o.style.width=i+t;var a=i/o.offsetWidth;l.removeChild(o);var u=a*parseFloat(e);return Ge.CSS[e+t]=u,u}function En(n,e,t){if(e in n.style){var r=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),s=n.style[e]||getComputedStyle(n).getPropertyValue(r)||"0";return t?Zt(n,s,t):s}}function Xt(n,e){if(_.dom(n)&&!_.inp(n)&&(!_.nil(V(n,e))||_.svg(n)&&n[e]))return"attribute";if(_.dom(n)&&Qt(ea,e))return"transform";if(_.dom(n)&&e!=="transform"&&En(n,e))return"css";if(n[e]!=null)return"object"}function Tn(n){if(_.dom(n)){for(var e=n.style.transform||"",t=/(\w+)\(([^)]*)\)/g,r=new Map,s;s=t.exec(e);)r.set(s[1],s[2]);return r}}function la(n,e,t,r){var s=Ie(e,"scale")?1:0+aa(e),i=Tn(n).get(e)||s;return t&&(t.transforms.list.set(e,i),t.transforms.last=e),r?Zt(n,i,r):i}function er(n,e,t,r){switch(Xt(n,e)){case"transform":return la(n,e,r,t);case"css":return En(n,e,t);case"attribute":return V(n,e);default:return n[e]||0}}function tr(n,e){var t=/^(\*=|\+=|-=)/.exec(n);if(!t)return n;var r=K(n)||0,s=parseFloat(e),i=parseFloat(n.replace(t[0],""));switch(t[0][0]){case"+":return s+i+r;case"-":return s-i+r;case"*":return s*i+r}}function Pn(n,e){if(_.col(n))return oa(n);if(/\s/g.test(n))return n;var t=K(n),r=t?n.substr(0,n.length-t.length):n;return e?r+e:r}function rr(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function ca(n){return Math.PI*2*V(n,"r")}function ua(n){return V(n,"width")*2+V(n,"height")*2}function ha(n){return rr({x:V(n,"x1"),y:V(n,"y1")},{x:V(n,"x2"),y:V(n,"y2")})}function Cn(n){for(var e=n.points,t=0,r,s=0;s<e.numberOfItems;s++){var i=e.getItem(s);s>0&&(t+=rr(r,i)),r=i}return t}function da(n){var e=n.points;return Cn(n)+rr(e.getItem(e.numberOfItems-1),e.getItem(0))}function An(n){if(n.getTotalLength)return n.getTotalLength();switch(n.tagName.toLowerCase()){case"circle":return ca(n);case"rect":return ua(n);case"line":return ha(n);case"polyline":return Cn(n);case"polygon":return da(n)}}function fa(n){var e=An(n);return n.setAttribute("stroke-dasharray",e),e}function ga(n){for(var e=n.parentNode;_.svg(e)&&_.svg(e.parentNode);)e=e.parentNode;return e}function On(n,e){var t=e||{},r=t.el||ga(n),s=r.getBoundingClientRect(),i=V(r,"viewBox"),o=s.width,l=s.height,a=t.viewBox||(i?i.split(" "):[0,0,o,l]);return{el:r,viewBox:a,x:a[0]/1,y:a[1]/1,w:o,h:l,vW:a[2],vH:a[3]}}function pa(n,e){var t=_.str(n)?Sn(n)[0]:n,r=e||100;return function(s){return{property:s,el:t,svg:On(t),totalLength:An(t)*(r/100)}}}function ma(n,e,t){function r(c){c===void 0&&(c=0);var h=e+c>=1?e+c:0;return n.el.getPointAtLength(h)}var s=On(n.el,n.svg),i=r(),o=r(-1),l=r(1),a=t?1:s.w/s.vW,u=t?1:s.h/s.vH;switch(n.property){case"x":return(i.x-s.x)*a;case"y":return(i.y-s.y)*u;case"angle":return Math.atan2(l.y-o.y,l.x-o.x)*180/Math.PI}}function Cr(n,e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,r=Pn(_.pth(n)?n.totalLength:n,e)+"";return{original:r,numbers:r.match(t)?r.match(t).map(Number):[0],strings:_.str(n)||e?r.split(t):[]}}function nr(n){var e=n?ot(_.arr(n)?n.map(Pr):Pr(n)):[];return it(e,function(t,r,s){return s.indexOf(t)===r})}function Rn(n){var e=nr(n);return e.map(function(t,r){return{target:t,id:r,total:e.length,transforms:{list:Tn(t)}}})}function va(n,e){var t=Yt(e);if(/^spring/.test(t.easing)&&(t.duration=kn(t.easing)),_.arr(n)){var r=n.length,s=r===2&&!_.obj(n[0]);s?n={value:n}:_.fnc(e.duration)||(t.duration=e.duration/r)}var i=_.arr(n)?n:[n];return i.map(function(o,l){var a=_.obj(o)&&!_.pth(o)?o:{value:o};return _.und(a.delay)&&(a.delay=l?0:e.delay),_.und(a.endDelay)&&(a.endDelay=l===i.length-1?e.endDelay:0),a}).map(function(o){return at(o,t)})}function ya(n){for(var e=it(ot(n.map(function(i){return Object.keys(i)})),function(i){return _.key(i)}).reduce(function(i,o){return i.indexOf(o)<0&&i.push(o),i},[]),t={},r=function(i){var o=e[i];t[o]=n.map(function(l){var a={};for(var u in l)_.key(u)?u==o&&(a.value=l[u]):a[u]=l[u];return a})},s=0;s<e.length;s++)r(s);return t}function wa(n,e){var t=[],r=e.keyframes;r&&(e=at(ya(r),e));for(var s in e)_.key(s)&&t.push({name:s,tweens:va(e[s],n)});return t}function ba(n,e){var t={};for(var r in n){var s=Mt(n[r],e);_.arr(s)&&(s=s.map(function(i){return Mt(i,e)}),s.length===1&&(s=s[0])),t[r]=s}return t.duration=parseFloat(t.duration),t.delay=parseFloat(t.delay),t}function _a(n,e){var t;return n.tweens.map(function(r){var s=ba(r,e),i=s.value,o=_.arr(i)?i[1]:i,l=K(o),a=er(e.target,n.name,l,e),u=t?t.to.original:a,c=_.arr(i)?i[0]:u,h=K(c)||K(a),d=l||h;return _.und(o)&&(o=u),s.from=Cr(c,d),s.to=Cr(tr(o,c),d),s.start=t?t.end:0,s.end=s.start+s.delay+s.duration+s.endDelay,s.easing=Wt(s.easing,s.duration),s.isPath=_.pth(i),s.isPathTargetInsideSVG=s.isPath&&_.svg(e.target),s.isColor=_.col(s.from.original),s.isColor&&(s.round=1),t=s,s})}var In={css:function(n,e,t){return n.style[e]=t},attribute:function(n,e,t){return n.setAttribute(e,t)},object:function(n,e,t){return n[e]=t},transform:function(n,e,t,r,s){if(r.list.set(e,t),e===r.last||s){var i="";r.list.forEach(function(o,l){i+=l+"("+o+") "}),n.style.transform=i}}};function jn(n,e){var t=Rn(n);t.forEach(function(r){for(var s in e){var i=Mt(e[s],r),o=r.target,l=K(i),a=er(o,s,l,r),u=l||K(a),c=tr(Pn(i,u),a),h=Xt(o,s);In[h](o,s,c,r.transforms,!0)}})}function ka(n,e){var t=Xt(n.target,e.name);if(t){var r=_a(e,n),s=r[r.length-1];return{type:t,property:e.name,animatable:n,tweens:r,duration:s.end,delay:r[0].delay,endDelay:s.endDelay}}}function xa(n,e){return it(ot(n.map(function(t){return e.map(function(r){return ka(t,r)})})),function(t){return!_.und(t)})}function $n(n,e){var t=n.length,r=function(i){return i.timelineOffset?i.timelineOffset:0},s={};return s.duration=t?Math.max.apply(Math,n.map(function(i){return r(i)+i.duration})):e.duration,s.delay=t?Math.min.apply(Math,n.map(function(i){return r(i)+i.delay})):e.delay,s.endDelay=t?s.duration-Math.max.apply(Math,n.map(function(i){return r(i)+i.duration-i.endDelay})):e.endDelay,s}var Ar=0;function Sa(n){var e=Bt(bn,n),t=Bt(Kt,n),r=wa(t,n),s=Rn(n.targets),i=xa(s,r),o=$n(i,t),l=Ar;return Ar++,at(e,{id:l,children:[],animatables:s,animations:i,duration:o.duration,delay:o.delay,endDelay:o.endDelay})}var q=[],Ln=function(){var n;function e(){!n&&(!Or()||!A.suspendWhenDocumentHidden)&&q.length>0&&(n=requestAnimationFrame(t))}function t(s){for(var i=q.length,o=0;o<i;){var l=q[o];l.paused?(q.splice(o,1),i--):(l.tick(s),o++)}n=o>0?requestAnimationFrame(t):void 0}function r(){A.suspendWhenDocumentHidden&&(Or()?n=cancelAnimationFrame(n):(q.forEach(function(s){return s._onDocumentVisibility()}),Ln()))}return typeof document<"u"&&document.addEventListener("visibilitychange",r),e}();function Or(){return!!document&&document.hidden}function A(n){n===void 0&&(n={});var e=0,t=0,r=0,s,i=0,o=null;function l(v){var m=window.Promise&&new Promise(function(w){return o=w});return v.finished=m,m}var a=Sa(n);l(a);function u(){var v=a.direction;v!=="alternate"&&(a.direction=v!=="normal"?"normal":"reverse"),a.reversed=!a.reversed,s.forEach(function(m){return m.reversed=a.reversed})}function c(v){return a.reversed?a.duration-v:v}function h(){e=0,t=c(a.currentTime)*(1/A.speed)}function d(v,m){m&&m.seek(v-m.timelineOffset)}function f(v){if(a.reversePlayback)for(var w=i;w--;)d(v,s[w]);else for(var m=0;m<i;m++)d(v,s[m])}function g(v){for(var m=0,w=a.animations,k=w.length;m<k;){var x=w[m],P=x.animatable,I=x.tweens,j=I.length-1,T=I[j];j&&(T=it(I,function(Dn){return v<Dn.end})[0]||T);for(var D=z(v-T.start-T.delay,0,T.duration)/T.duration,W=isNaN(D)?1:T.easing(D),O=T.to.strings,lt=T.round,ct=[],Mn=T.to.numbers.length,le=void 0,ke=0;ke<Mn;ke++){var xe=void 0,sr=T.to.numbers[ke],ir=T.from.numbers[ke]||0;T.isPath?xe=ma(T.value,W*sr,T.isPathTargetInsideSVG):xe=ir+W*(sr-ir),lt&&(T.isColor&&ke>2||(xe=Math.round(xe*lt)/lt)),ct.push(xe)}var or=O.length;if(!or)le=ct[0];else{le=O[0];for(var Se=0;Se<or;Se++){O[Se];var ar=O[Se+1],ut=ct[Se];isNaN(ut)||(ar?le+=ut+ar:le+=ut+" ")}}In[x.type](P.target,x.property,le,P.transforms),x.currentValue=le,m++}}function p(v){a[v]&&!a.passThrough&&a[v](a)}function b(){a.remaining&&a.remaining!==!0&&a.remaining--}function y(v){var m=a.duration,w=a.delay,k=m-a.endDelay,x=c(v);a.progress=z(x/m*100,0,100),a.reversePlayback=x<a.currentTime,s&&f(x),!a.began&&a.currentTime>0&&(a.began=!0,p("begin")),!a.loopBegan&&a.currentTime>0&&(a.loopBegan=!0,p("loopBegin")),x<=w&&a.currentTime!==0&&g(0),(x>=k&&a.currentTime!==m||!m)&&g(m),x>w&&x<k?(a.changeBegan||(a.changeBegan=!0,a.changeCompleted=!1,p("changeBegin")),p("change"),g(x)):a.changeBegan&&(a.changeCompleted=!0,a.changeBegan=!1,p("changeComplete")),a.currentTime=z(x,0,m),a.began&&p("update"),v>=m&&(t=0,b(),a.remaining?(e=r,p("loopComplete"),a.loopBegan=!1,a.direction==="alternate"&&u()):(a.paused=!0,a.completed||(a.completed=!0,p("loopComplete"),p("complete"),!a.passThrough&&"Promise"in window&&(o(),l(a)))))}return a.reset=function(){var v=a.direction;a.passThrough=!1,a.currentTime=0,a.progress=0,a.paused=!0,a.began=!1,a.loopBegan=!1,a.changeBegan=!1,a.completed=!1,a.changeCompleted=!1,a.reversePlayback=!1,a.reversed=v==="reverse",a.remaining=a.loop,s=a.children,i=s.length;for(var m=i;m--;)a.children[m].reset();(a.reversed&&a.loop!==!0||v==="alternate"&&a.loop===1)&&a.remaining++,g(a.reversed?a.duration:0)},a._onDocumentVisibility=h,a.set=function(v,m){return jn(v,m),a},a.tick=function(v){r=v,e||(e=r),y((r+(t-e))*A.speed)},a.seek=function(v){y(c(v))},a.pause=function(){a.paused=!0,h()},a.play=function(){a.paused&&(a.completed&&a.reset(),a.paused=!1,q.push(a),h(),Ln())},a.reverse=function(){u(),a.completed=!a.reversed,h()},a.restart=function(){a.reset(),a.play()},a.remove=function(v){var m=nr(v);Bn(m,a)},a.reset(),a.autoplay&&a.play(),a}function Rr(n,e){for(var t=e.length;t--;)Qt(n,e[t].animatable.target)&&e.splice(t,1)}function Bn(n,e){var t=e.animations,r=e.children;Rr(n,t);for(var s=r.length;s--;){var i=r[s],o=i.animations;Rr(n,o),!o.length&&!i.children.length&&r.splice(s,1)}!t.length&&!r.length&&e.pause()}function Ea(n){for(var e=nr(n),t=q.length;t--;){var r=q[t];Bn(e,r)}}function Ta(n,e){e===void 0&&(e={});var t=e.direction||"normal",r=e.easing?Wt(e.easing):null,s=e.grid,i=e.axis,o=e.from||0,l=o==="first",a=o==="center",u=o==="last",c=_.arr(n),h=parseFloat(c?n[0]:n),d=c?parseFloat(n[1]):0,f=K(c?n[1]:n)||0,g=e.start||0+(c?h:0),p=[],b=0;return function(y,v,m){if(l&&(o=0),a&&(o=(m-1)/2),u&&(o=m-1),!p.length){for(var w=0;w<m;w++){if(!s)p.push(Math.abs(o-w));else{var k=a?(s[0]-1)/2:o%s[0],x=a?(s[1]-1)/2:Math.floor(o/s[0]),P=w%s[0],I=Math.floor(w/s[0]),j=k-P,T=x-I,D=Math.sqrt(j*j+T*T);i==="x"&&(D=-j),i==="y"&&(D=-T),p.push(D)}b=Math.max.apply(Math,p)}r&&(p=p.map(function(O){return r(O/b)*b})),t==="reverse"&&(p=p.map(function(O){return i?O<0?O*-1:-O:Math.abs(b-O)}))}var W=c?(d-h)/b:h;return g+W*(Math.round(p[v]*100)/100)+f}}function Pa(n){n===void 0&&(n={});var e=A(n);return e.duration=0,e.add=function(t,r){var s=q.indexOf(e),i=e.children;s>-1&&q.splice(s,1);function o(d){d.passThrough=!0}for(var l=0;l<i.length;l++)o(i[l]);var a=at(t,Bt(Kt,n));a.targets=a.targets||n.targets;var u=e.duration;a.autoplay=!1,a.direction=e.direction,a.timelineOffset=_.und(r)?u:tr(r,u),o(e),e.seek(a.timelineOffset);var c=A(a);o(c),i.push(c);var h=$n(i,n);return e.delay=h.delay,e.endDelay=h.endDelay,e.duration=h.duration,e.seek(0),e.reset(),e.autoplay&&e.play(),e},e}A.version="3.2.1";A.speed=1;A.suspendWhenDocumentHidden=!0;A.running=q;A.remove=Ea;A.get=er;A.set=jn;A.convertPx=Zt;A.path=pa;A.setDashoffset=fa;A.stagger=Ta;A.timeline=Pa;A.easing=Wt;A.penner=xn;A.random=function(n,e){return Math.floor(Math.random()*(e-n+1))+n};class Ca{constructor(){this.currentService=null,this.baseURL=window.location.hostname==="localhost"?"https://cornwells-services.netlify.app":window.location.origin,this.init()}init(){var r;this.setupEventListeners(),this.loadCurrentPage(),this.initializeAnimations(),N.captureUTMParameters();const e=this.extractServiceIdFromPath(window.location.pathname),t=e?(r=Ee(e))==null?void 0:r.title:null;N.trackPageView(t)}setupEventListeners(){document.addEventListener("click",e=>{e.target.matches("[data-book-consultation]")&&(e.preventDefault(),this.handleBookingClick(e.target)),e.target.matches("[data-call-pharmacy]")&&(e.preventDefault(),this.handleCallClick()),e.target.matches("[data-visit-cornwells]")&&(e.preventDefault(),this.handleCornwellsClick()),e.target.matches("[data-generate-qr]")&&(e.preventDefault(),this.generateQRCode(e.target))}),window.addEventListener("popstate",()=>{this.loadCurrentPage()})}loadCurrentPage(){const e=window.location.pathname,t=this.extractServiceIdFromPath(e);t&&Ee(t)?this.loadServiceLanding(t):this.loadServiceSelector()}extractServiceIdFromPath(e){return e.replace(/^\/+|\/+$/g,"")||null}async loadServiceLanding(e){const t=Ee(e);if(!t){this.loadServiceSelector();return}this.currentService=t,N.trackPageView(t.title);const r=this.generateServiceLandingHTML(t);document.getElementById("app").innerHTML=r,document.title=`${t.title} - Cornwells Pharmacy Services`,this.updateMetaDescription(t.description),this.initializeAnimations()}loadServiceSelector(){this.currentService=null;const e=this.generateServiceSelectorHTML();document.getElementById("app").innerHTML=e,document.title="Cornwells Pharmacy Services - Expert Healthcare in Your Community",this.updateMetaDescription("Discover our comprehensive range of pharmacy services including health screenings, vaccinations, travel health, and specialized consultations. Book your appointment today."),N.trackPageView(),this.initializeAnimations()}generateServiceLandingHTML(e){return`
      <div class="min-h-screen bg-gradient-to-br ${e.colorScheme.primary}">
        <!-- Navigation -->
        <nav class="bg-white/95 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-40">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
              <div class="flex items-center space-x-4">
                <button onclick="window.app.loadServiceSelector()" class="text-gray-600 hover:text-gray-900 font-medium">
                  ← All Services
                </button>
                <div class="h-6 w-px bg-gray-300"></div>
                <h1 class="text-xl font-bold text-gray-900">Cornwells Pharmacy</h1>
              </div>
              <div class="flex items-center space-x-4">
                <button data-call-pharmacy class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-xl font-semibold transition-colors">
                  📞 Call Pharmacy
                </button>
                <button data-generate-qr="${e.id}" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-xl font-semibold transition-colors">
                  📱 QR Code
                </button>
              </div>
            </div>
          </div>
        </nav>

        <!-- Hero Section -->
        <div class="relative overflow-hidden">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24">
            <div class="text-center">
              <div class="text-6xl mb-6 fade-in-up stagger-1">${e.icon}</div>
              <h1 class="text-5xl md:text-6xl font-bold text-white mb-6 fade-in-up stagger-2">
                ${e.title}
              </h1>
              <p class="text-xl md:text-2xl text-white/90 mb-8 max-w-3xl mx-auto fade-in-up stagger-3">
                ${e.description}
              </p>
              <div class="flex flex-col sm:flex-row gap-4 justify-center fade-in-up stagger-4">
                <button data-book-consultation="${e.id}" class="bg-white text-gray-900 px-8 py-4 rounded-2xl font-bold text-lg hover:bg-gray-100 transition-all transform hover:scale-105 shadow-xl">
                  📅 Book Consultation
                </button>
                <button data-call-pharmacy class="bg-white/20 backdrop-blur-sm text-white px-8 py-4 rounded-2xl font-bold text-lg hover:bg-white/30 transition-all border border-white/30">
                  📞 Call to Discuss
                </button>
              </div>
            </div>
          </div>
          
          <!-- Decorative background -->
          <div class="absolute inset-0 bg-gradient-to-br ${e.colorScheme.secondary} opacity-20"></div>
        </div>

        <!-- Service Details -->
        <div class="bg-white py-24">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid lg:grid-cols-2 gap-16 items-center">
              <div>
                <h2 class="text-4xl font-bold text-gray-900 mb-8">What We Offer</h2>
                <div class="space-y-6">
                  ${e.features.map(t=>`
                    <div class="flex items-start space-x-4 fade-in-up">
                      <div class="flex-shrink-0 w-8 h-8 bg-gradient-to-r ${e.colorScheme.primary} rounded-full flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                      </div>
                      <p class="text-lg text-gray-700">${t}</p>
                    </div>
                  `).join("")}
                </div>
              </div>
              
              <div class="bg-gradient-to-br ${e.colorScheme.primary} rounded-3xl p-8 text-white">
                <h3 class="text-2xl font-bold mb-6">Ready to Get Started?</h3>
                <p class="text-lg mb-8 text-white/90">
                  Book your consultation today and take the first step towards better health.
                </p>
                <button data-book-consultation="${e.id}" class="w-full bg-white text-gray-900 py-4 rounded-2xl font-bold text-lg hover:bg-gray-100 transition-colors">
                  📅 Book Your Consultation
                </button>
                <p class="text-sm text-white/70 mt-4 text-center">
                  Usually available within 24-48 hours
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Trust Indicators -->
        <div class="bg-gray-50 py-16">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h3 class="text-2xl font-bold text-gray-900 mb-12">Why Choose Cornwells?</h3>
            <div class="grid md:grid-cols-3 gap-8">
              <div class="fade-in-up">
                <div class="text-4xl mb-4">🏆</div>
                <h4 class="text-xl font-semibold text-gray-900 mb-2">Expert Pharmacists</h4>
                <p class="text-gray-600">Qualified healthcare professionals with years of experience</p>
              </div>
              <div class="fade-in-up">
                <div class="text-4xl mb-4">⚡</div>
                <h4 class="text-xl font-semibold text-gray-900 mb-2">Quick & Convenient</h4>
                <p class="text-gray-600">Fast appointments without the long GP waiting times</p>
              </div>
              <div class="fade-in-up">
                <div class="text-4xl mb-4">🔒</div>
                <h4 class="text-xl font-semibold text-gray-900 mb-2">Confidential Care</h4>
                <p class="text-gray-600">Private consultations in a comfortable, professional setting</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Footer -->
        <footer class="bg-gray-900 text-white py-12">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h3 class="text-2xl font-bold mb-4">Cornwells Pharmacy</h3>
            <p class="text-gray-400 mb-6">Your trusted healthcare partner since 1835</p>
            <div class="flex justify-center space-x-6">
              <button data-call-pharmacy class="text-gray-400 hover:text-white transition-colors">📞 Call Us</button>
              <button data-visit-cornwells class="text-gray-400 hover:text-white transition-colors">🌐 Visit Website</button>
            </div>
          </div>
        </footer>
      </div>
    `}generateServiceSelectorHTML(){return`
      <div class="min-h-screen bg-gradient-to-br from-blue-600 via-purple-600 to-indigo-800">
        <!-- Hero Section -->
        <div class="relative overflow-hidden">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24">
            <div class="text-center">
              <h1 class="text-5xl md:text-7xl font-bold text-white mb-6 fade-in-up stagger-1">
                🏥 Cornwells Pharmacy
              </h1>
              <p class="text-xl md:text-2xl text-white/90 mb-8 max-w-3xl mx-auto fade-in-up stagger-2">
                Expert healthcare services in your community. Professional consultations, health screenings, and specialized care.
              </p>
              <div class="flex flex-col sm:flex-row gap-4 justify-center fade-in-up stagger-3">
                <button data-call-pharmacy class="bg-white text-gray-900 px-8 py-4 rounded-2xl font-bold text-lg hover:bg-gray-100 transition-all transform hover:scale-105 shadow-xl">
                  📞 Call Pharmacy
                </button>
                <button data-visit-cornwells class="bg-white/20 backdrop-blur-sm text-white px-8 py-4 rounded-2xl font-bold text-lg hover:bg-white/30 transition-all border border-white/30">
                  🌐 Visit Our Website
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Services Grid -->
        <div class="bg-white py-24">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
              <h2 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">Our Services</h2>
              <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                Choose from our comprehensive range of healthcare services, all delivered by qualified pharmacists in a professional, caring environment.
              </p>
            </div>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
              ${Nn().map((t,r)=>`
                <div class="group cursor-pointer fade-in-up" style="animation-delay: ${r*100}ms" onclick="window.app.loadServiceLanding('${t.id}')">
                  <div class="bg-gradient-to-br ${t.colorScheme.primary} rounded-3xl p-8 text-white transform transition-all duration-300 group-hover:scale-105 group-hover:shadow-2xl">
                    <div class="text-5xl mb-6">${t.icon}</div>
                    <h3 class="text-2xl font-bold mb-4">${t.title}</h3>
                    <p class="text-white/90 mb-6">${t.description}</p>
                    <div class="flex items-center text-white/80 font-semibold">
                      <span>Learn More</span>
                      <svg class="w-5 h-5 ml-2 transform transition-transform group-hover:translate-x-1" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                      </svg>
                    </div>
                  </div>
                </div>
              `).join("")}
            </div>
          </div>
        </div>

        <!-- Trust Section -->
        <div class="bg-gray-50 py-24">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
              <h2 class="text-4xl font-bold text-gray-900 mb-6">Trusted Healthcare Since 1835</h2>
              <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                With nearly two centuries of experience, Cornwells Pharmacy has been serving communities with expert healthcare services and trusted advice.
              </p>
            </div>
            
            <div class="grid md:grid-cols-4 gap-8 text-center">
              <div class="fade-in-up">
                <div class="text-4xl mb-4">🏆</div>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">Expert Care</h3>
                <p class="text-gray-600">Qualified pharmacists and healthcare professionals</p>
              </div>
              <div class="fade-in-up">
                <div class="text-4xl mb-4">⚡</div>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">Quick Access</h3>
                <p class="text-gray-600">Fast appointments without long waiting times</p>
              </div>
              <div class="fade-in-up">
                <div class="text-4xl mb-4">🔒</div>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">Confidential</h3>
                <p class="text-gray-600">Private consultations in comfortable settings</p>
              </div>
              <div class="fade-in-up">
                <div class="text-4xl mb-4">📍</div>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">Local</h3>
                <p class="text-gray-600">Multiple convenient locations across Staffordshire</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Footer -->
        <footer class="bg-gray-900 text-white py-16">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
              <h3 class="text-3xl font-bold mb-6">Ready to Get Started?</h3>
              <p class="text-xl text-gray-400 mb-8 max-w-2xl mx-auto">
                Contact us today to book your consultation or learn more about our services.
              </p>
              <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button data-call-pharmacy class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-2xl font-bold text-lg transition-colors">
                  📞 Call Pharmacy
                </button>
                <button data-visit-cornwells class="bg-gray-700 hover:bg-gray-600 text-white px-8 py-4 rounded-2xl font-bold text-lg transition-colors">
                  🌐 Visit Website
                </button>
              </div>
              <div class="mt-12 pt-8 border-t border-gray-700 text-center text-gray-400">
                <p>&copy; 2024 Cornwells Pharmacy. Trusted healthcare since 1835.</p>
              </div>
            </div>
          </div>
        </footer>
      </div>
    `}handleBookingClick(e){const t=e.getAttribute("data-book-consultation");t&&(N.trackEvent("booking_intent",{service_id:t,service_name:N.services[t]||"Unknown Service"}),this.showBookingModal(t))}showBookingModal(e){const t=Ee(e);if(!t)return;const r=`
      <div id="booking-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
          <div class="p-8">
            <div class="flex justify-between items-center mb-6">
              <h2 class="text-3xl font-bold text-gray-900">Book ${t.title}</h2>
              <button onclick="document.getElementById('booking-modal').remove()" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
            </div>
            
            <form id="booking-form" class="space-y-6">
              <div class="grid md:grid-cols-2 gap-6">
                <div>
                  <label for="patient-name" class="block text-sm font-semibold text-gray-700 mb-2">Full Name *</label>
                  <input type="text" id="patient-name" required class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                  <label for="phone-number" class="block text-sm font-semibold text-gray-700 mb-2">Phone Number *</label>
                  <input type="tel" id="phone-number" required class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
              </div>
              
              <div>
                <label for="email" class="block text-sm font-semibold text-gray-700 mb-2">Email Address</label>
                <input type="email" id="email" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
              </div>
              
              <div>
                <label for="preferred-time" class="block text-sm font-semibold text-gray-700 mb-2">Preferred Time *</label>
                <select id="preferred-time" required class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                  <option value="">Select preferred time</option>
                  <option value="0">Morning (9:00 AM - 12:00 PM)</option>
                  <option value="1">Afternoon (12:00 PM - 5:00 PM)</option>
                  <option value="2">Evening (5:00 PM - 7:00 PM)</option>
                </select>
              </div>
              
              <div>
                <label for="notes" class="block text-sm font-semibold text-gray-700 mb-2">Additional Notes</label>
                <textarea id="notes" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Any specific concerns or questions?"></textarea>
              </div>
              
              <div class="flex items-start space-x-3">
                <input type="checkbox" id="consent" required class="mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                <label for="consent" class="text-sm text-gray-700">
                  I consent to Cornwells Pharmacy contacting me about this consultation and understand that my data will be processed in accordance with their privacy policy. *
                </label>
              </div>
              
              <button type="submit" id="submit-booking" class="w-full bg-gradient-to-r ${t.colorScheme.primary} text-white py-4 rounded-2xl font-bold text-lg hover:opacity-90 transition-opacity">
                📅 Submit Booking Request
              </button>
              
              <p class="text-sm text-gray-600 text-center">
                We'll call you within 2 hours to confirm your consultation time.
              </p>
            </form>
          </div>
        </div>
      </div>
    `;document.body.insertAdjacentHTML("beforeend",r),document.getElementById("booking-form").addEventListener("submit",s=>{s.preventDefault(),this.handleBookingSubmission(e)})}handleCallClick(){N.trackEvent("call_intent",{source:"website_button"}),this.showSuccessMessage("📞 Calling pharmacy... (In demo: would open phone dialer)")}handleCornwellsClick(){N.trackEvent("website_visit_intent",{source:"services_site"}),window.open("https://cornwells.co.uk","_blank")}async generateQRCode(e){var i;const t=e.getAttribute("data-generate-qr")||((i=this.currentService)==null?void 0:i.id);if(!t)return;const r=Ee(t),s=`${this.baseURL}/${t}`;try{const o=await oe.toDataURL(s,{width:256,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"}),l=`
        <div id="qr-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
          <div class="bg-white rounded-3xl p-8 max-w-sm w-full text-center">
            <h3 class="text-2xl font-bold text-gray-900 mb-6">${r.title}</h3>
            <div class="mb-6">
              <img src="${o}" alt="QR Code" class="mx-auto rounded-2xl shadow-lg">
            </div>
            <p class="text-gray-600 mb-6">Scan to access this service page</p>
            <button class="w-full py-3 bg-gray-900 text-white rounded-2xl font-semibold" onclick="this.closest('#qr-modal').remove()">
              Close
            </button>
          </div>
        </div>
      `;document.body.insertAdjacentHTML("beforeend",l)}catch(o){console.error("Error generating QR code:",o)}}initializeAnimations(){const e=new IntersectionObserver(t=>{t.forEach(r=>{r.isIntersecting&&(r.target.style.opacity="1",r.target.style.transform="translateY(0)")})},{threshold:.1});document.querySelectorAll(".fade-in-up").forEach(t=>{t.style.opacity="0",t.style.transform="translateY(30px)",t.style.transition="all 0.6s ease-out",e.observe(t)}),A({targets:".stagger-1, .stagger-2, .stagger-3, .stagger-4",opacity:[0,1],translateY:[30,0],delay:function(t,r){return r*200},duration:800,easing:"easeOutCubic"})}async handleBookingSubmission(e){const t=document.getElementById("submit-booking"),r=t.innerHTML;try{t.innerHTML="⏳ Submitting...",t.disabled=!0;const s={patient_name:document.getElementById("patient-name").value.trim(),phone_number:document.getElementById("phone-number").value.trim(),email:document.getElementById("email").value.trim()||null,preferred_time_slot:io[document.getElementById("preferred-time").value],notes:document.getElementById("notes").value.trim()||null,service_type:e,service_name:so[e],source_url:window.location.href,consent_given:document.getElementById("consent").checked,preferred_contact_method:"phone"},i=N.getStoredUTMData();Object.keys(i).length>0&&(s.utm_params=i),console.log("Submitting booking:",s);const{data:o,error:l}=await no.from("service_consultations").insert([s]).select();if(l)throw console.error("Supabase error:",l),new Error("Failed to submit booking. Please try again.");console.log("Booking submitted successfully:",o),N.trackBookingConversion(e,s),document.getElementById("booking-modal").remove(),this.showSuccessMessage("🎉 Booking request sent! We'll call you within 2 hours to confirm your consultation.")}catch(s){console.error("Booking submission error:",s),this.showErrorMessage("Sorry, there was an issue submitting your booking. Please try again or call us directly."),t.innerHTML=r,t.disabled=!1}}showSuccessMessage(e){const t=document.createElement("div");t.className="fixed bottom-6 left-6 right-6 bg-green-600 text-white p-4 rounded-2xl shadow-xl z-50 text-center font-semibold",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.parentElement&&t.remove()},4e3)}showErrorMessage(e){const t=document.createElement("div");t.className="fixed bottom-6 left-6 right-6 bg-red-600 text-white p-4 rounded-2xl shadow-xl z-50 text-center font-semibold",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.parentElement&&t.remove()},7e3)}updateMetaDescription(e){let t=document.querySelector('meta[name="description"]');t||(t=document.createElement("meta"),t.name="description",document.head.appendChild(t)),t.content=e}}document.addEventListener("DOMContentLoaded",()=>{window.app=new Ca});
//# sourceMappingURL=main-leTAy6UF.js.map
